"use strict";(self.webpackChunkpageflow_scrolled=self.webpackChunkpageflow_scrolled||[]).push([[388],{"./src/frontend/PlayerControls/WaveformPlayerControls/Wavesurfer.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{default:()=>__WEBPACK_DEFAULT_EXPORT__});var react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../../node_modules/react/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../../../node_modules/prop-types/index.js"),prop_types__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(prop_types__WEBPACK_IMPORTED_MODULE_5__),deep_assign__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../../node_modules/deep-assign/index.js"),deep_assign__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(deep_assign__WEBPACK_IMPORTED_MODULE_1__),react_measure__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-measure/dist/index.esm.js"),wavesurfer_js__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/wavesurfer.js/dist/wavesurfer.js"),wavesurfer_js__WEBPACK_IMPORTED_MODULE_3___default=__webpack_require__.n(wavesurfer_js__WEBPACK_IMPORTED_MODULE_3__),react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../../../node_modules/react/jsx-runtime.js");const EVENTS=["audioprocess","error","finish","loading","mouseup","pause","play","ready","scroll","seek","zoom"];function positiveIntegerProptype(props,propName,componentName){const n=props[propName];return void 0!==n&&("number"!=typeof n||n!==parseInt(n,10)||n<0)?new Error(`Invalid ${propName} supplied to ${componentName},\n      expected a positive integer`):null}class Wavesurfer extends react__WEBPACK_IMPORTED_MODULE_0__.Component{constructor(props){if(super(props),this.state={isReady:!1},void 0===typeof wavesurfer_js__WEBPACK_IMPORTED_MODULE_3___default())throw new Error("WaveSurfer is undefined!");this._loadMediaElt=this._loadMediaElt.bind(this),this._loadAudio=this._loadAudio.bind(this),this._seekTo=this._seekTo.bind(this),this._handleResize=()=>{this.state.isReady&&this._wavesurfer.zoom(!1)}}componentDidMount(){const options=deep_assign__WEBPACK_IMPORTED_MODULE_1___default()({},this.props.options,{container:this.wavesurferEl});this.props.mediaElt&&(options.backend="MediaElement"),this._wavesurfer=wavesurfer_js__WEBPACK_IMPORTED_MODULE_3___default().create(options),this._wavesurfer.on("ready",(()=>{this.setState({isReady:!0,pos:this.props.pos}),this.props.pos&&this._seekTo(this.props.pos),null!=this.props.volume&&this._wavesurfer.setVolume(this.props.volume),this.props.playing&&this._wavesurfer.play(),this.props.zoom&&this._wavesurfer.zoom(this.props.zoom)})),this._wavesurfer.on("audioprocess",(pos=>{this.setState({pos}),this.props.onPosChange({wavesurfer:this._wavesurfer,originalArgs:[pos]})})),this._wavesurfer.on("seek",(pos=>{const formattedPos=this._posToSec(pos);this.setState({formattedPos}),this.props.onPosChange({wavesurfer:this._wavesurfer,originalArgs:[formattedPos]})})),EVENTS.forEach((e=>{const propCallback=this.props[`on${function capitaliseFirstLetter(string){return string.split("-").map((part=>part.charAt(0).toUpperCase()+part.slice(1))).join("")}(e)}`],wavesurfer=this._wavesurfer;propCallback&&this._wavesurfer.on(e,((...originalArgs)=>{propCallback({wavesurfer,originalArgs})}))})),this.props.audioFile&&this._loadAudio(this.props.audioFile,this.props.audioPeaks),this.props.mediaElt&&this._loadMediaElt(this.props.mediaElt,this.props.audioPeaks)}componentDidUpdate(prevProps){this.props.audioFile!=this.props.audioFile&&this._loadAudio(this.props.audioFile,this.props.audioPeaks),prevProps.mediaElt!==this.props.mediaElt&&this._loadMediaElt(this.props.mediaElt,this.props.audioPeaks),prevProps.audioPeaks!==this.props.audioPeaks&&(this.props.mediaElt?this._loadMediaElt(prevProps.mediaElt,this.props.audioPeaks):this._loadAudio(this.props.audioFile,this.props.audioPeaks)),this.props.pos&&this.state.isReady&&prevProps.pos!==this.props.pos&&this.props.pos!==this.state.pos&&this._seekTo(this.props.pos),this.props.playing!==prevProps.playing&&(this.props.playing?this._wavesurfer.play():this._wavesurfer.pause()),this.props.volume!==prevProps.volume&&this._wavesurfer.setVolume(this.props.volume),this.props.zoom!==prevProps.zoom&&this._wavesurfer.zoom(this.props.zoom),this.props.options.audioRate!==prevProps.options.audioRate&&this._wavesurfer.setPlaybackRate(this.props.options.audioRate),prevProps.options.waveColor!==this.props.options.waveColor&&this._wavesurfer.setWaveColor(this.props.options.waveColor),prevProps.options.progressColor!==this.props.options.progressColor&&this._wavesurfer.setProgressColor(this.props.options.progressColor),prevProps.options.cursorColor!==this.props.options.cursorColor&&this._wavesurfer.setCursorColor(this.props.options.cursorColor),prevProps.options.height!==this.props.options.height&&this._wavesurfer.setHeight(this.props.options.height)}componentWillUnmount(){EVENTS.forEach((e=>{this._wavesurfer.un(e)})),this._wavesurfer.destroy()}_secToPos(sec){return 1/this._wavesurfer.getDuration()*sec}_posToSec(pos){return pos*this._wavesurfer.getDuration()}_seekTo(sec){const pos=this._secToPos(sec);this.props.options.autoCenter?this._wavesurfer.seekAndCenter(pos):this._wavesurfer.seekTo(pos)}_loadMediaElt(selectorOrElt,audioPeaks){selectorOrElt instanceof __webpack_require__.g.HTMLElement?this._loadAudio(selectorOrElt,audioPeaks):__webpack_require__.g.document.querySelector(selectorOrElt)&&this._loadAudio(__webpack_require__.g.document.querySelector(selectorOrElt),audioPeaks)}_loadAudio(audioFileOrElt,audioPeaks){if(audioFileOrElt instanceof __webpack_require__.g.HTMLElement)this._wavesurfer.loadMediaElement(audioFileOrElt,audioPeaks);else if("string"==typeof audioFileOrElt)this._wavesurfer.load(audioFileOrElt,audioPeaks);else{if(!(audioFileOrElt instanceof __webpack_require__.g.Blob||audioFileOrElt instanceof __webpack_require__.g.File))throw new Error("Wavesurfer._loadAudio expects prop audioFile\n        to be either HTMLElement, string or file/blob");this._wavesurfer.loadBlob(audioFileOrElt,audioPeaks)}}_measureIfResponsive(children){return this.props.responsive?(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)(react_measure__WEBPACK_IMPORTED_MODULE_2__.Z,{client:!0,onResize:this._handleResize,children:({measureRef})=>(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{ref:measureRef,children})}):children}render(){const childrenWithProps=!!this.props.children&&react__WEBPACK_IMPORTED_MODULE_0__.Children.map(this.props.children,(child=>react__WEBPACK_IMPORTED_MODULE_0__.cloneElement(child,{wavesurfer:this._wavesurfer,isReady:this.state.isReady})));return this._measureIfResponsive((0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsxs)("div",{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_4__.jsx)("div",{ref:c=>{this.wavesurferEl=c}}),childrenWithProps]}))}}Wavesurfer.displayName="Wavesurfer",Wavesurfer.propTypes={playing:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,pos:prop_types__WEBPACK_IMPORTED_MODULE_5___default().number,audioFile:(props,propName,componentName)=>{const prop=props[propName];return!prop||"string"==typeof prop||prop instanceof __webpack_require__.g.Blob||prop instanceof __webpack_require__.g.File?null:new Error(`Invalid ${propName} supplied to ${componentName}\n        expected either string or file/blob`)},mediaElt:prop_types__WEBPACK_IMPORTED_MODULE_5___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_5___default().string,prop_types__WEBPACK_IMPORTED_MODULE_5___default().instanceOf(__webpack_require__.g.HTMLElement)]),audioPeaks:prop_types__WEBPACK_IMPORTED_MODULE_5___default().array,volume:prop_types__WEBPACK_IMPORTED_MODULE_5___default().number,zoom:prop_types__WEBPACK_IMPORTED_MODULE_5___default().number,responsive:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,onPosChange:prop_types__WEBPACK_IMPORTED_MODULE_5___default().func,children:prop_types__WEBPACK_IMPORTED_MODULE_5___default().oneOfType([prop_types__WEBPACK_IMPORTED_MODULE_5___default().element,prop_types__WEBPACK_IMPORTED_MODULE_5___default().array]),options:prop_types__WEBPACK_IMPORTED_MODULE_5___default().shape({audioRate:prop_types__WEBPACK_IMPORTED_MODULE_5___default().number,backend:prop_types__WEBPACK_IMPORTED_MODULE_5___default().oneOf(["WebAudio","MediaElement"]),barWidth:(props,propName,componentName)=>{const prop=props[propName];return void 0!==prop&&"number"!=typeof prop?new Error(`Invalid ${propName} supplied to ${componentName}\n          expected either undefined or number`):null},cursorColor:prop_types__WEBPACK_IMPORTED_MODULE_5___default().string,cursorWidth:positiveIntegerProptype,dragSelection:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,fillParent:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,height:positiveIntegerProptype,hideScrollbar:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,interact:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,loopSelection:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,mediaControls:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,minPxPerSec:positiveIntegerProptype,normalize:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,pixelRatio:prop_types__WEBPACK_IMPORTED_MODULE_5___default().number,progressColor:prop_types__WEBPACK_IMPORTED_MODULE_5___default().string,scrollParent:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool,skipLength:prop_types__WEBPACK_IMPORTED_MODULE_5___default().number,waveColor:prop_types__WEBPACK_IMPORTED_MODULE_5___default().string,autoCenter:prop_types__WEBPACK_IMPORTED_MODULE_5___default().bool})},Wavesurfer.defaultProps={playing:!1,pos:0,options:wavesurfer_js__WEBPACK_IMPORTED_MODULE_3___default().defaultParams,responsive:!0,onPosChange:()=>{}};const __WEBPACK_DEFAULT_EXPORT__=Wavesurfer}}]);