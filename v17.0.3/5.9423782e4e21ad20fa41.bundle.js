/*! For license information please see 5.9423782e4e21ad20fa41.bundle.js.LICENSE.txt */
(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{1711:function(module,__webpack_exports__,__webpack_require__){"use strict";(function(setImmediate){var _finally__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1712),_allSettled__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(1713),setTimeoutFunc=setTimeout;function isArray(x){return Boolean(x&&void 0!==x.length)}function noop(){}function Promise(fn){if(!(this instanceof Promise))throw new TypeError("Promises must be constructed via new");if("function"!=typeof fn)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],doResolve(fn,this)}function handle(self,deferred){for(;3===self._state;)self=self._value;0!==self._state?(self._handled=!0,Promise._immediateFn((function(){var cb=1===self._state?deferred.onFulfilled:deferred.onRejected;if(null!==cb){var ret;try{ret=cb(self._value)}catch(e){return void reject(deferred.promise,e)}resolve(deferred.promise,ret)}else(1===self._state?resolve:reject)(deferred.promise,self._value)}))):self._deferreds.push(deferred)}function resolve(self,newValue){try{if(newValue===self)throw new TypeError("A promise cannot be resolved with itself.");if(newValue&&("object"==typeof newValue||"function"==typeof newValue)){var then=newValue.then;if(newValue instanceof Promise)return self._state=3,self._value=newValue,void finale(self);if("function"==typeof then)return void doResolve(function bind(fn,thisArg){return function(){fn.apply(thisArg,arguments)}}(then,newValue),self)}self._state=1,self._value=newValue,finale(self)}catch(e){reject(self,e)}}function reject(self,newValue){self._state=2,self._value=newValue,finale(self)}function finale(self){2===self._state&&0===self._deferreds.length&&Promise._immediateFn((function(){self._handled||Promise._unhandledRejectionFn(self._value)}));for(var i=0,len=self._deferreds.length;i<len;i++)handle(self,self._deferreds[i]);self._deferreds=null}function Handler(onFulfilled,onRejected,promise){this.onFulfilled="function"==typeof onFulfilled?onFulfilled:null,this.onRejected="function"==typeof onRejected?onRejected:null,this.promise=promise}function doResolve(fn,self){var done=!1;try{fn((function(value){done||(done=!0,resolve(self,value))}),(function(reason){done||(done=!0,reject(self,reason))}))}catch(ex){if(done)return;done=!0,reject(self,ex)}}Promise.prototype.catch=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){var prom=new this.constructor(noop);return handle(this,new Handler(onFulfilled,onRejected,prom)),prom},Promise.prototype.finally=_finally__WEBPACK_IMPORTED_MODULE_0__.a,Promise.all=function(arr){return new Promise((function(resolve,reject){if(!isArray(arr))return reject(new TypeError("Promise.all accepts an array"));var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){try{if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,(function(val){res(i,val)}),reject)}args[i]=val,0==--remaining&&resolve(args)}catch(ex){reject(ex)}}for(var i=0;i<args.length;i++)res(i,args[i])}))},Promise.allSettled=_allSettled__WEBPACK_IMPORTED_MODULE_1__.a,Promise.resolve=function(value){return value&&"object"==typeof value&&value.constructor===Promise?value:new Promise((function(resolve){resolve(value)}))},Promise.reject=function(value){return new Promise((function(resolve,reject){reject(value)}))},Promise.race=function(arr){return new Promise((function(resolve,reject){if(!isArray(arr))return reject(new TypeError("Promise.race accepts an array"));for(var i=0,len=arr.length;i<len;i++)Promise.resolve(arr[i]).then(resolve,reject)}))},Promise._immediateFn="function"==typeof setImmediate&&function(fn){setImmediate(fn)}||function(fn){setTimeoutFunc(fn,0)},Promise._unhandledRejectionFn=function _unhandledRejectionFn(err){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",err)},__webpack_exports__.a=Promise}).call(this,__webpack_require__(795).setImmediate)},1712:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function finallyConstructor(callback){var constructor=this.constructor;return this.then((function(value){return constructor.resolve(callback()).then((function(){return value}))}),(function(reason){return constructor.resolve(callback()).then((function(){return constructor.reject(reason)}))}))}},1713:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_exports__.a=function allSettled(arr){return new this((function(resolve,reject){if(!arr||void 0===arr.length)return reject(new TypeError(typeof arr+" "+arr+" is not iterable(cannot read property Symbol(Symbol.iterator))"));var args=Array.prototype.slice.call(arr);if(0===args.length)return resolve([]);var remaining=args.length;function res(i,val){if(val&&("object"==typeof val||"function"==typeof val)){var then=val.then;if("function"==typeof then)return void then.call(val,(function(val){res(i,val)}),(function(e){args[i]={status:"rejected",reason:e},0==--remaining&&resolve(args)}))}args[i]={status:"fulfilled",value:val},0==--remaining&&resolve(args)}for(var i=0;i<args.length;i++)res(i,args[i])}))}},1714:function(module,exports,__webpack_require__){!function(){"use strict";var document="undefined"!=typeof window&&void 0!==window.document?window.document:{},isCommonjs=module.exports,fn=function(){for(var val,fnMap=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],i=0,l=fnMap.length,ret={};i<l;i++)if((val=fnMap[i])&&val[1]in document){for(i=0;i<val.length;i++)ret[fnMap[0][i]]=val[i];return ret}return!1}(),eventNameMap={change:fn.fullscreenchange,error:fn.fullscreenerror},screenfull={request:function(element,options){return new Promise(function(resolve,reject){var onFullScreenEntered=function(){this.off("change",onFullScreenEntered),resolve()}.bind(this);this.on("change",onFullScreenEntered);var returnPromise=(element=element||document.documentElement)[fn.requestFullscreen](options);returnPromise instanceof Promise&&returnPromise.then(onFullScreenEntered).catch(reject)}.bind(this))},exit:function(){return new Promise(function(resolve,reject){if(this.isFullscreen){var onFullScreenExit=function(){this.off("change",onFullScreenExit),resolve()}.bind(this);this.on("change",onFullScreenExit);var returnPromise=document[fn.exitFullscreen]();returnPromise instanceof Promise&&returnPromise.then(onFullScreenExit).catch(reject)}else resolve()}.bind(this))},toggle:function(element,options){return this.isFullscreen?this.exit():this.request(element,options)},onchange:function(callback){this.on("change",callback)},onerror:function(callback){this.on("error",callback)},on:function(event,callback){var eventName=eventNameMap[event];eventName&&document.addEventListener(eventName,callback,!1)},off:function(event,callback){var eventName=eventNameMap[event];eventName&&document.removeEventListener(eventName,callback,!1)},raw:fn};fn?(Object.defineProperties(screenfull,{isFullscreen:{get:function(){return Boolean(document[fn.fullscreenElement])}},element:{enumerable:!0,get:function(){return document[fn.fullscreenElement]}},isEnabled:{enumerable:!0,get:function(){return Boolean(document[fn.fullscreenEnabled])}}}),isCommonjs?module.exports=screenfull:window.screenfull=screenfull):isCommonjs?module.exports={isEnabled:!1}:window.screenfull={isEnabled:!1}}()},1727:function(module,__webpack_exports__,__webpack_require__){"use strict";var common_namespaceObject={};__webpack_require__.r(common_namespaceObject),__webpack_require__.d(common_namespaceObject,"EPSILON",(function(){return EPSILON})),__webpack_require__.d(common_namespaceObject,"ARRAY_TYPE",(function(){return ARRAY_TYPE})),__webpack_require__.d(common_namespaceObject,"RANDOM",(function(){return RANDOM})),__webpack_require__.d(common_namespaceObject,"setMatrixArrayType",(function(){return setMatrixArrayType})),__webpack_require__.d(common_namespaceObject,"toRadian",(function(){return toRadian})),__webpack_require__.d(common_namespaceObject,"equals",(function(){return equals}));var mat3_namespaceObject={};__webpack_require__.r(mat3_namespaceObject),__webpack_require__.d(mat3_namespaceObject,"create",(function(){return create})),__webpack_require__.d(mat3_namespaceObject,"fromMat4",(function(){return fromMat4})),__webpack_require__.d(mat3_namespaceObject,"clone",(function(){return clone})),__webpack_require__.d(mat3_namespaceObject,"copy",(function(){return copy})),__webpack_require__.d(mat3_namespaceObject,"fromValues",(function(){return fromValues})),__webpack_require__.d(mat3_namespaceObject,"set",(function(){return set})),__webpack_require__.d(mat3_namespaceObject,"identity",(function(){return identity})),__webpack_require__.d(mat3_namespaceObject,"transpose",(function(){return transpose})),__webpack_require__.d(mat3_namespaceObject,"invert",(function(){return invert})),__webpack_require__.d(mat3_namespaceObject,"adjoint",(function(){return adjoint})),__webpack_require__.d(mat3_namespaceObject,"determinant",(function(){return determinant})),__webpack_require__.d(mat3_namespaceObject,"multiply",(function(){return multiply})),__webpack_require__.d(mat3_namespaceObject,"translate",(function(){return translate})),__webpack_require__.d(mat3_namespaceObject,"rotate",(function(){return rotate})),__webpack_require__.d(mat3_namespaceObject,"scale",(function(){return mat3_scale})),__webpack_require__.d(mat3_namespaceObject,"fromTranslation",(function(){return fromTranslation})),__webpack_require__.d(mat3_namespaceObject,"fromRotation",(function(){return fromRotation})),__webpack_require__.d(mat3_namespaceObject,"fromScaling",(function(){return fromScaling})),__webpack_require__.d(mat3_namespaceObject,"fromMat2d",(function(){return fromMat2d})),__webpack_require__.d(mat3_namespaceObject,"fromQuat",(function(){return fromQuat})),__webpack_require__.d(mat3_namespaceObject,"normalFromMat4",(function(){return normalFromMat4})),__webpack_require__.d(mat3_namespaceObject,"projection",(function(){return projection})),__webpack_require__.d(mat3_namespaceObject,"str",(function(){return str})),__webpack_require__.d(mat3_namespaceObject,"frob",(function(){return frob})),__webpack_require__.d(mat3_namespaceObject,"add",(function(){return add})),__webpack_require__.d(mat3_namespaceObject,"subtract",(function(){return subtract})),__webpack_require__.d(mat3_namespaceObject,"multiplyScalar",(function(){return multiplyScalar})),__webpack_require__.d(mat3_namespaceObject,"multiplyScalarAndAdd",(function(){return multiplyScalarAndAdd})),__webpack_require__.d(mat3_namespaceObject,"exactEquals",(function(){return exactEquals})),__webpack_require__.d(mat3_namespaceObject,"equals",(function(){return mat3_equals})),__webpack_require__.d(mat3_namespaceObject,"mul",(function(){return mul})),__webpack_require__.d(mat3_namespaceObject,"sub",(function(){return sub}));var mat4_namespaceObject={};__webpack_require__.r(mat4_namespaceObject),__webpack_require__.d(mat4_namespaceObject,"create",(function(){return mat4_create})),__webpack_require__.d(mat4_namespaceObject,"clone",(function(){return mat4_clone})),__webpack_require__.d(mat4_namespaceObject,"copy",(function(){return mat4_copy})),__webpack_require__.d(mat4_namespaceObject,"fromValues",(function(){return mat4_fromValues})),__webpack_require__.d(mat4_namespaceObject,"set",(function(){return mat4_set})),__webpack_require__.d(mat4_namespaceObject,"identity",(function(){return mat4_identity})),__webpack_require__.d(mat4_namespaceObject,"transpose",(function(){return mat4_transpose})),__webpack_require__.d(mat4_namespaceObject,"invert",(function(){return mat4_invert})),__webpack_require__.d(mat4_namespaceObject,"adjoint",(function(){return mat4_adjoint})),__webpack_require__.d(mat4_namespaceObject,"determinant",(function(){return mat4_determinant})),__webpack_require__.d(mat4_namespaceObject,"multiply",(function(){return mat4_multiply})),__webpack_require__.d(mat4_namespaceObject,"translate",(function(){return mat4_translate})),__webpack_require__.d(mat4_namespaceObject,"scale",(function(){return mat4_scale})),__webpack_require__.d(mat4_namespaceObject,"rotate",(function(){return mat4_rotate})),__webpack_require__.d(mat4_namespaceObject,"rotateX",(function(){return rotateX})),__webpack_require__.d(mat4_namespaceObject,"rotateY",(function(){return rotateY})),__webpack_require__.d(mat4_namespaceObject,"rotateZ",(function(){return rotateZ})),__webpack_require__.d(mat4_namespaceObject,"fromTranslation",(function(){return mat4_fromTranslation})),__webpack_require__.d(mat4_namespaceObject,"fromScaling",(function(){return mat4_fromScaling})),__webpack_require__.d(mat4_namespaceObject,"fromRotation",(function(){return mat4_fromRotation})),__webpack_require__.d(mat4_namespaceObject,"fromXRotation",(function(){return fromXRotation})),__webpack_require__.d(mat4_namespaceObject,"fromYRotation",(function(){return fromYRotation})),__webpack_require__.d(mat4_namespaceObject,"fromZRotation",(function(){return fromZRotation})),__webpack_require__.d(mat4_namespaceObject,"fromRotationTranslation",(function(){return fromRotationTranslation})),__webpack_require__.d(mat4_namespaceObject,"fromQuat2",(function(){return fromQuat2})),__webpack_require__.d(mat4_namespaceObject,"getTranslation",(function(){return getTranslation})),__webpack_require__.d(mat4_namespaceObject,"getScaling",(function(){return getScaling})),__webpack_require__.d(mat4_namespaceObject,"getRotation",(function(){return mat4_getRotation})),__webpack_require__.d(mat4_namespaceObject,"fromRotationTranslationScale",(function(){return fromRotationTranslationScale})),__webpack_require__.d(mat4_namespaceObject,"fromRotationTranslationScaleOrigin",(function(){return fromRotationTranslationScaleOrigin})),__webpack_require__.d(mat4_namespaceObject,"fromQuat",(function(){return mat4_fromQuat})),__webpack_require__.d(mat4_namespaceObject,"frustum",(function(){return frustum})),__webpack_require__.d(mat4_namespaceObject,"perspective",(function(){return perspective})),__webpack_require__.d(mat4_namespaceObject,"perspectiveFromFieldOfView",(function(){return perspectiveFromFieldOfView})),__webpack_require__.d(mat4_namespaceObject,"ortho",(function(){return ortho})),__webpack_require__.d(mat4_namespaceObject,"lookAt",(function(){return lookAt})),__webpack_require__.d(mat4_namespaceObject,"targetTo",(function(){return targetTo})),__webpack_require__.d(mat4_namespaceObject,"str",(function(){return mat4_str})),__webpack_require__.d(mat4_namespaceObject,"frob",(function(){return mat4_frob})),__webpack_require__.d(mat4_namespaceObject,"add",(function(){return mat4_add})),__webpack_require__.d(mat4_namespaceObject,"subtract",(function(){return mat4_subtract})),__webpack_require__.d(mat4_namespaceObject,"multiplyScalar",(function(){return mat4_multiplyScalar})),__webpack_require__.d(mat4_namespaceObject,"multiplyScalarAndAdd",(function(){return mat4_multiplyScalarAndAdd})),__webpack_require__.d(mat4_namespaceObject,"exactEquals",(function(){return mat4_exactEquals})),__webpack_require__.d(mat4_namespaceObject,"equals",(function(){return mat4_equals})),__webpack_require__.d(mat4_namespaceObject,"mul",(function(){return mat4_mul})),__webpack_require__.d(mat4_namespaceObject,"sub",(function(){return mat4_sub}));var vec3_namespaceObject={};__webpack_require__.r(vec3_namespaceObject),__webpack_require__.d(vec3_namespaceObject,"create",(function(){return vec3_create})),__webpack_require__.d(vec3_namespaceObject,"clone",(function(){return vec3_clone})),__webpack_require__.d(vec3_namespaceObject,"length",(function(){return vec3_length})),__webpack_require__.d(vec3_namespaceObject,"fromValues",(function(){return vec3_fromValues})),__webpack_require__.d(vec3_namespaceObject,"copy",(function(){return vec3_copy})),__webpack_require__.d(vec3_namespaceObject,"set",(function(){return vec3_set})),__webpack_require__.d(vec3_namespaceObject,"add",(function(){return vec3_add})),__webpack_require__.d(vec3_namespaceObject,"subtract",(function(){return vec3_subtract})),__webpack_require__.d(vec3_namespaceObject,"multiply",(function(){return vec3_multiply})),__webpack_require__.d(vec3_namespaceObject,"divide",(function(){return divide})),__webpack_require__.d(vec3_namespaceObject,"ceil",(function(){return ceil})),__webpack_require__.d(vec3_namespaceObject,"floor",(function(){return floor})),__webpack_require__.d(vec3_namespaceObject,"min",(function(){return min})),__webpack_require__.d(vec3_namespaceObject,"max",(function(){return max})),__webpack_require__.d(vec3_namespaceObject,"round",(function(){return vec3_round})),__webpack_require__.d(vec3_namespaceObject,"scale",(function(){return vec3_scale})),__webpack_require__.d(vec3_namespaceObject,"scaleAndAdd",(function(){return scaleAndAdd})),__webpack_require__.d(vec3_namespaceObject,"distance",(function(){return vec3_distance})),__webpack_require__.d(vec3_namespaceObject,"squaredDistance",(function(){return squaredDistance})),__webpack_require__.d(vec3_namespaceObject,"squaredLength",(function(){return squaredLength})),__webpack_require__.d(vec3_namespaceObject,"negate",(function(){return negate})),__webpack_require__.d(vec3_namespaceObject,"inverse",(function(){return inverse})),__webpack_require__.d(vec3_namespaceObject,"normalize",(function(){return normalize})),__webpack_require__.d(vec3_namespaceObject,"dot",(function(){return vec3_dot})),__webpack_require__.d(vec3_namespaceObject,"cross",(function(){return cross})),__webpack_require__.d(vec3_namespaceObject,"lerp",(function(){return lerp})),__webpack_require__.d(vec3_namespaceObject,"hermite",(function(){return hermite})),__webpack_require__.d(vec3_namespaceObject,"bezier",(function(){return bezier})),__webpack_require__.d(vec3_namespaceObject,"random",(function(){return random})),__webpack_require__.d(vec3_namespaceObject,"transformMat4",(function(){return transformMat4})),__webpack_require__.d(vec3_namespaceObject,"transformMat3",(function(){return transformMat3})),__webpack_require__.d(vec3_namespaceObject,"transformQuat",(function(){return transformQuat})),__webpack_require__.d(vec3_namespaceObject,"rotateX",(function(){return vec3_rotateX})),__webpack_require__.d(vec3_namespaceObject,"rotateY",(function(){return vec3_rotateY})),__webpack_require__.d(vec3_namespaceObject,"rotateZ",(function(){return vec3_rotateZ})),__webpack_require__.d(vec3_namespaceObject,"angle",(function(){return vec3_angle})),__webpack_require__.d(vec3_namespaceObject,"zero",(function(){return zero})),__webpack_require__.d(vec3_namespaceObject,"str",(function(){return vec3_str})),__webpack_require__.d(vec3_namespaceObject,"exactEquals",(function(){return vec3_exactEquals})),__webpack_require__.d(vec3_namespaceObject,"equals",(function(){return vec3_equals})),__webpack_require__.d(vec3_namespaceObject,"sub",(function(){return vec3_sub})),__webpack_require__.d(vec3_namespaceObject,"mul",(function(){return vec3_mul})),__webpack_require__.d(vec3_namespaceObject,"div",(function(){return div})),__webpack_require__.d(vec3_namespaceObject,"dist",(function(){return dist})),__webpack_require__.d(vec3_namespaceObject,"sqrDist",(function(){return sqrDist})),__webpack_require__.d(vec3_namespaceObject,"len",(function(){return vec3_len})),__webpack_require__.d(vec3_namespaceObject,"sqrLen",(function(){return sqrLen})),__webpack_require__.d(vec3_namespaceObject,"forEach",(function(){return forEach}));var quat_namespaceObject={};__webpack_require__.r(quat_namespaceObject),__webpack_require__.d(quat_namespaceObject,"create",(function(){return quat_create})),__webpack_require__.d(quat_namespaceObject,"identity",(function(){return quat_identity})),__webpack_require__.d(quat_namespaceObject,"setAxisAngle",(function(){return setAxisAngle})),__webpack_require__.d(quat_namespaceObject,"getAxisAngle",(function(){return getAxisAngle})),__webpack_require__.d(quat_namespaceObject,"getAngle",(function(){return quat_getAngle})),__webpack_require__.d(quat_namespaceObject,"multiply",(function(){return quat_multiply})),__webpack_require__.d(quat_namespaceObject,"rotateX",(function(){return quat_rotateX})),__webpack_require__.d(quat_namespaceObject,"rotateY",(function(){return quat_rotateY})),__webpack_require__.d(quat_namespaceObject,"rotateZ",(function(){return quat_rotateZ})),__webpack_require__.d(quat_namespaceObject,"calculateW",(function(){return calculateW})),__webpack_require__.d(quat_namespaceObject,"exp",(function(){return exp})),__webpack_require__.d(quat_namespaceObject,"ln",(function(){return ln})),__webpack_require__.d(quat_namespaceObject,"pow",(function(){return pow})),__webpack_require__.d(quat_namespaceObject,"slerp",(function(){return slerp})),__webpack_require__.d(quat_namespaceObject,"random",(function(){return quat_random})),__webpack_require__.d(quat_namespaceObject,"invert",(function(){return quat_invert})),__webpack_require__.d(quat_namespaceObject,"conjugate",(function(){return conjugate})),__webpack_require__.d(quat_namespaceObject,"fromMat3",(function(){return fromMat3})),__webpack_require__.d(quat_namespaceObject,"fromEuler",(function(){return fromEuler})),__webpack_require__.d(quat_namespaceObject,"str",(function(){return quat_str})),__webpack_require__.d(quat_namespaceObject,"clone",(function(){return quat_clone})),__webpack_require__.d(quat_namespaceObject,"fromValues",(function(){return quat_fromValues})),__webpack_require__.d(quat_namespaceObject,"copy",(function(){return quat_copy})),__webpack_require__.d(quat_namespaceObject,"set",(function(){return quat_set})),__webpack_require__.d(quat_namespaceObject,"add",(function(){return quat_add})),__webpack_require__.d(quat_namespaceObject,"mul",(function(){return quat_mul})),__webpack_require__.d(quat_namespaceObject,"scale",(function(){return quat_scale})),__webpack_require__.d(quat_namespaceObject,"dot",(function(){return quat_dot})),__webpack_require__.d(quat_namespaceObject,"lerp",(function(){return quat_lerp})),__webpack_require__.d(quat_namespaceObject,"length",(function(){return quat_length})),__webpack_require__.d(quat_namespaceObject,"len",(function(){return quat_len})),__webpack_require__.d(quat_namespaceObject,"squaredLength",(function(){return quat_squaredLength})),__webpack_require__.d(quat_namespaceObject,"sqrLen",(function(){return quat_sqrLen})),__webpack_require__.d(quat_namespaceObject,"normalize",(function(){return quat_normalize})),__webpack_require__.d(quat_namespaceObject,"exactEquals",(function(){return quat_exactEquals})),__webpack_require__.d(quat_namespaceObject,"equals",(function(){return quat_equals})),__webpack_require__.d(quat_namespaceObject,"rotationTo",(function(){return rotationTo})),__webpack_require__.d(quat_namespaceObject,"sqlerp",(function(){return sqlerp})),__webpack_require__.d(quat_namespaceObject,"setAxes",(function(){return setAxes}));var vec2_namespaceObject={};function isUndefined(value){return void 0===value}__webpack_require__.r(vec2_namespaceObject),__webpack_require__.d(vec2_namespaceObject,"create",(function(){return vec2_create})),__webpack_require__.d(vec2_namespaceObject,"clone",(function(){return vec2_clone})),__webpack_require__.d(vec2_namespaceObject,"fromValues",(function(){return vec2_fromValues})),__webpack_require__.d(vec2_namespaceObject,"copy",(function(){return vec2_copy})),__webpack_require__.d(vec2_namespaceObject,"set",(function(){return vec2_set})),__webpack_require__.d(vec2_namespaceObject,"add",(function(){return vec2_add})),__webpack_require__.d(vec2_namespaceObject,"subtract",(function(){return vec2_subtract})),__webpack_require__.d(vec2_namespaceObject,"multiply",(function(){return vec2_multiply})),__webpack_require__.d(vec2_namespaceObject,"divide",(function(){return vec2_divide})),__webpack_require__.d(vec2_namespaceObject,"ceil",(function(){return vec2_ceil})),__webpack_require__.d(vec2_namespaceObject,"floor",(function(){return vec2_floor})),__webpack_require__.d(vec2_namespaceObject,"min",(function(){return vec2_min})),__webpack_require__.d(vec2_namespaceObject,"max",(function(){return vec2_max})),__webpack_require__.d(vec2_namespaceObject,"round",(function(){return vec2_round})),__webpack_require__.d(vec2_namespaceObject,"scale",(function(){return vec2_scale})),__webpack_require__.d(vec2_namespaceObject,"scaleAndAdd",(function(){return vec2_scaleAndAdd})),__webpack_require__.d(vec2_namespaceObject,"distance",(function(){return vec2_distance})),__webpack_require__.d(vec2_namespaceObject,"squaredDistance",(function(){return vec2_squaredDistance})),__webpack_require__.d(vec2_namespaceObject,"length",(function(){return vec2_length})),__webpack_require__.d(vec2_namespaceObject,"squaredLength",(function(){return vec2_squaredLength})),__webpack_require__.d(vec2_namespaceObject,"negate",(function(){return vec2_negate})),__webpack_require__.d(vec2_namespaceObject,"inverse",(function(){return vec2_inverse})),__webpack_require__.d(vec2_namespaceObject,"normalize",(function(){return vec2_normalize})),__webpack_require__.d(vec2_namespaceObject,"dot",(function(){return vec2_dot})),__webpack_require__.d(vec2_namespaceObject,"cross",(function(){return vec2_cross})),__webpack_require__.d(vec2_namespaceObject,"lerp",(function(){return vec2_lerp})),__webpack_require__.d(vec2_namespaceObject,"random",(function(){return vec2_random})),__webpack_require__.d(vec2_namespaceObject,"transformMat2",(function(){return transformMat2})),__webpack_require__.d(vec2_namespaceObject,"transformMat2d",(function(){return transformMat2d})),__webpack_require__.d(vec2_namespaceObject,"transformMat3",(function(){return vec2_transformMat3})),__webpack_require__.d(vec2_namespaceObject,"transformMat4",(function(){return vec2_transformMat4})),__webpack_require__.d(vec2_namespaceObject,"rotate",(function(){return vec2_rotate})),__webpack_require__.d(vec2_namespaceObject,"angle",(function(){return vec2_angle})),__webpack_require__.d(vec2_namespaceObject,"zero",(function(){return vec2_zero})),__webpack_require__.d(vec2_namespaceObject,"str",(function(){return vec2_str})),__webpack_require__.d(vec2_namespaceObject,"exactEquals",(function(){return vec2_exactEquals})),__webpack_require__.d(vec2_namespaceObject,"equals",(function(){return vec2_equals})),__webpack_require__.d(vec2_namespaceObject,"len",(function(){return vec2_len})),__webpack_require__.d(vec2_namespaceObject,"sub",(function(){return vec2_sub})),__webpack_require__.d(vec2_namespaceObject,"mul",(function(){return vec2_mul})),__webpack_require__.d(vec2_namespaceObject,"div",(function(){return vec2_div})),__webpack_require__.d(vec2_namespaceObject,"dist",(function(){return vec2_dist})),__webpack_require__.d(vec2_namespaceObject,"sqrDist",(function(){return vec2_sqrDist})),__webpack_require__.d(vec2_namespaceObject,"sqrLen",(function(){return vec2_sqrLen})),__webpack_require__.d(vec2_namespaceObject,"forEach",(function(){return vec2_forEach}));var component_esm=function(){function Component(){this.options={},this._eventHandler={}}var __proto=Component.prototype;return __proto.trigger=function(eventName){for(var _this=this,params=[],_i=1;_i<arguments.length;_i++)params[_i-1]=arguments[_i];var handlerList=this._eventHandler[eventName]||[],hasHandlerList=handlerList.length>0;if(!hasHandlerList)return!0;var customEvent=params[0]||{},restParams=params.slice(1);handlerList=handlerList.concat();var isCanceled=!1;customEvent.eventType=eventName,customEvent.stop=function(){isCanceled=!0},customEvent.currentTarget=this;var arg=[customEvent];return restParams.length>=1&&(arg=arg.concat(restParams)),handlerList.forEach((function(handler){handler.apply(_this,arg)})),!isCanceled},__proto.once=function(eventName,handlerToAttach){var _this=this;if("object"==typeof eventName&&isUndefined(handlerToAttach)){var eventHash=eventName;for(var key in eventHash)this.once(key,eventHash[key]);return this}if("string"==typeof eventName&&"function"==typeof handlerToAttach){var listener_1=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];handlerToAttach.apply(_this,args),_this.off(eventName,listener_1)};this.on(eventName,listener_1)}return this},__proto.hasOn=function(eventName){return!!this._eventHandler[eventName]},__proto.on=function(eventName,handlerToAttach){if("object"==typeof eventName&&isUndefined(handlerToAttach)){var eventHash=eventName;for(var name in eventHash)this.on(name,eventHash[name]);return this}if("string"==typeof eventName&&"function"==typeof handlerToAttach){var handlerList=this._eventHandler[eventName];isUndefined(handlerList)&&(this._eventHandler[eventName]=[],handlerList=this._eventHandler[eventName]),handlerList.push(handlerToAttach)}return this},__proto.off=function(eventName,handlerToDetach){var e_1,_a;if(isUndefined(eventName))return this._eventHandler={},this;if(isUndefined(handlerToDetach)){if("string"==typeof eventName)return delete this._eventHandler[eventName],this;var eventHash=eventName;for(var name in eventHash)this.off(name,eventHash[name]);return this}var handlerList=this._eventHandler[eventName];if(handlerList){var idx=0;try{for(var handlerList_1=function __values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}(handlerList),handlerList_1_1=handlerList_1.next();!handlerList_1_1.done;handlerList_1_1=handlerList_1.next()){if(handlerList_1_1.value===handlerToDetach){handlerList.splice(idx,1);break}idx++}}catch(e_1_1){e_1={error:e_1_1}}finally{try{handlerList_1_1&&!handlerList_1_1.done&&(_a=handlerList_1.return)&&_a.call(handlerList_1)}finally{if(e_1)throw e_1.error}}}return this},Component.VERSION="2.2.2",Component}(),src=__webpack_require__(1711);function some(arr,callback){for(var length=arr.length,i=0;i<length;++i)if(callback(arr[i],i))return!0;return!1}function find(arr,callback){for(var length=arr.length,i=0;i<length;++i)if(callback(arr[i],i))return arr[i];return null}function execRegExp(pattern,text){try{return new RegExp(pattern,"g").exec(text)}catch(e){return null}}function hasUserAgentData(){if("undefined"==typeof navigator||!navigator||!navigator.userAgentData)return!1;var userAgentData=navigator.userAgentData,brands=userAgentData.brands||userAgentData.uaList;return!(!brands||!brands.length)}function convertVersion(text){return text.replace(/_/g,".")}function findPreset(presets,userAgent){var userPreset=null,version="-1";return some(presets,(function(preset){var result=execRegExp("("+preset.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",userAgent);return!(!result||preset.brand)&&(userPreset=preset,version=result[3]||"-1",preset.versionAlias?version=preset.versionAlias:preset.versionTest&&(version=function findVersion(versionTest,userAgent){var result=execRegExp("("+versionTest+")((?:\\/|\\s|:)([0-9|\\.|_]+))",userAgent);return result?result[3]:""}(preset.versionTest.toLowerCase(),userAgent)||version),version=convertVersion(version),!0)})),{preset:userPreset,version:version}}function findPresetBrand(presets,brands){var brandInfo={brand:"",version:"-1"};return some(presets,(function(preset){var result=findBrand(brands,preset);return!!result&&(brandInfo.brand=preset.id,brandInfo.version=preset.versionAlias||result.version,"-1"!==brandInfo.version)})),brandInfo}function findBrand(brands,preset){return find(brands,(function(_a){var brand=_a.brand;return execRegExp(""+preset.test,brand.toLowerCase())}))}var BROWSER_PRESETS=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],CHROMIUM_PRESETS=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],WEBKIT_PRESETS=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],WEBVIEW_PRESETS=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],OS_PRESETS=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"mac os x",id:"mac"},{test:"android",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function parseUserAgentData(osData){var userAgentData=navigator.userAgentData,brands=(userAgentData.uaList||userAgentData.brands).slice(),isMobile=userAgentData.mobile||!1,firstBrand=brands[0],browser={name:firstBrand.brand,version:firstBrand.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!findPresetBrand(WEBVIEW_PRESETS,brands).brand},os={name:"unknown",version:"-1",majorVersion:-1};browser.webkit=!browser.chromium&&some(WEBKIT_PRESETS,(function(preset){return findBrand(brands,preset)}));var chromiumBrand=findPresetBrand(CHROMIUM_PRESETS,brands);if(browser.chromium=!!chromiumBrand.brand,browser.chromiumVersion=chromiumBrand.version,!browser.chromium){var webkitBrand=findPresetBrand(WEBKIT_PRESETS,brands);browser.webkit=!!webkitBrand.brand,browser.webkitVersion=webkitBrand.version}if(osData){var platform_1=osData.platform.toLowerCase(),result=find(OS_PRESETS,(function(preset){return new RegExp(""+preset.test,"g").exec(platform_1)}));os.name=result?result.id:platform_1,os.version=osData.platformVersion}var browserBrand=findPresetBrand(BROWSER_PRESETS,brands);return browserBrand.brand&&(browser.name=browserBrand.brand,browser.version=osData?osData.uaFullVersion:browserBrand.version),"Linux armv8l"===navigator.platform?os.name="android":browser.webkit&&(os.name=isMobile?"ios":"mac"),"ios"===os.name&&browser.webview&&(browser.version="-1"),os.version=convertVersion(os.version),browser.version=convertVersion(browser.version),os.majorVersion=parseInt(os.version,10),browser.majorVersion=parseInt(browser.version,10),{browser:browser,os:os,isMobile:isMobile,isHints:!0}}function parseUserAgent(userAgent){var nextAgent=function getUserAgent(agent){var userAgent=agent;if(void 0===userAgent){if("undefined"==typeof navigator||!navigator)return"";userAgent=navigator.userAgent||""}return userAgent.toLowerCase()}(userAgent),isMobile=!!/mobi/g.exec(nextAgent),browser={name:"unknown",version:"-1",majorVersion:-1,webview:!!findPreset(WEBVIEW_PRESETS,nextAgent).preset,chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},os={name:"unknown",version:"-1",majorVersion:-1},_a=findPreset(BROWSER_PRESETS,nextAgent),browserPreset=_a.preset,browserVersion=_a.version,_b=findPreset(OS_PRESETS,nextAgent),osPreset=_b.preset,osVersion=_b.version,chromiumPreset=findPreset(CHROMIUM_PRESETS,nextAgent);if(browser.chromium=!!chromiumPreset.preset,browser.chromiumVersion=chromiumPreset.version,!browser.chromium){var webkitPreset=findPreset(WEBKIT_PRESETS,nextAgent);browser.webkit=!!webkitPreset.preset,browser.webkitVersion=webkitPreset.version}return osPreset&&(os.name=osPreset.id,os.version=osVersion,os.majorVersion=parseInt(osVersion,10)),browserPreset&&(browser.name=browserPreset.id,browser.version=browserVersion,browser.webview&&"ios"===os.name&&"safari"!==browser.name&&(browser.webview=!1)),browser.majorVersion=parseInt(browser.version,10),{browser:browser,os:os,isMobile:isMobile,isHints:!1}}function agent(userAgent){return void 0===userAgent&&hasUserAgentData()?parseUserAgentData():parseUserAgent(userAgent)}var agent_esm=agent;function _extends(){return(_extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source)Object.prototype.hasOwnProperty.call(source,key)&&(target[key]=source[key])}return target}).apply(this,arguments)}function _inheritsLoose(subClass,superClass){subClass.prototype=Object.create(superClass.prototype),subClass.prototype.constructor=subClass,subClass.__proto__=superClass}function _assertThisInitialized(self){if(void 0===self)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return self}var win,assign$1="function"!=typeof Object.assign?function assign(target){if(null==target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(null!=source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT="undefined"==typeof document?{style:{}}:document.createElement("div"),round=Math.round,abs=Math.abs,now=Date.now;function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if((prop=(prefix=VENDOR_PREFIXES[i])?prefix+camelProp:property)in obj)return prop;i++}}win="undefined"==typeof window?{}:window;var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=void 0!==PREFIXED_TOUCH_ACTION;var TOUCH_ACTION_MAP=function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=win.CSS&&win.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(val){return touchMap[val]=!cssSupports||win.CSS.supports("touch-action",val)})),touchMap}(),SUPPORT_TOUCH="ontouchstart"in win,SUPPORT_POINTER_EVENTS=void 0!==prefixed(win,"PointerEvent"),SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(void 0!==obj.length)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function boolOrFn(val,args){return"function"==typeof val?val.apply(args&&args[0]||void 0,args):val}function inStr(str,find){return str.indexOf(find)>-1}var TouchAction=function(){function TouchAction(manager,value){this.manager=manager,this.set(value)}var _proto=TouchAction.prototype;return _proto.set=function set(value){"compute"===value&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},_proto.update=function update(){this.set(this.manager.options.touchAction)},_proto.compute=function compute(){var actions=[];return each(this.manager.recognizers,(function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))})),function cleanTouchActions(actions){if(inStr(actions,"none"))return"none";var hasPanX=inStr(actions,"pan-x"),hasPanY=inStr(actions,"pan-y");return hasPanX&&hasPanY?"none":hasPanX||hasPanY?hasPanX?"pan-x":"pan-y":inStr(actions,"manipulation")?"manipulation":"auto"}(actions.join(" "))},_proto.preventDefaults=function preventDefaults(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)srcEvent.preventDefault();else{var actions=this.actions,hasNone=inStr(actions,"none")&&!TOUCH_ACTION_MAP.none,hasPanY=inStr(actions,"pan-y")&&!TOUCH_ACTION_MAP["pan-y"],hasPanX=inStr(actions,"pan-x")&&!TOUCH_ACTION_MAP["pan-x"];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}if(!hasPanX||!hasPanY)return hasNone||hasPanY&&6&direction||hasPanX&&24&direction?this.preventSrc(srcEvent):void 0}},_proto.preventSrc=function preventSrc(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()},TouchAction}();function hasParent(node,parent){for(;node;){if(node===parent)return!0;node=node.parentNode}return!1}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}function getDirection(x,y){return x===y?1:abs(x)>=abs(y)?x<0?2:4:y<0?8:16}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};1!==input.eventType&&4!==prevInput.eventType||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,function computeIntervalInputData(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(8!==input.eventType&&(deltaTime>25||void 0===last.velocity)){var deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}(session,input);var srcEventTarget,target=manager.element,srcEvent=input.srcEvent;hasParent(srcEventTarget=srcEvent.composedPath?srcEvent.composedPath()[0]:srcEvent.path?srcEvent.path[0]:srcEvent.target,target)&&(target=srcEventTarget),input.target=target}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=1&eventType&&pointersLen-changedPointersLen==0,isFinal=12&eventType&&pointersLen-changedPointersLen==0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function splitStr(str){return str.trim().split(/\s+/g)}function addEventListeners(target,types,handler){each(splitStr(types),(function(type){target.addEventListener(type,handler,!1)}))}function removeEventListeners(target,types,handler){each(splitStr(types),(function(type){target.removeEventListener(type,handler,!1)}))}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}var Input=function(){function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}var _proto=Input.prototype;return _proto.handler=function handler(){},_proto.init=function init(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},_proto.destroy=function destroy(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},Input}();function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}var POINTER_INPUT_MAP={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},IE10_POINTER_TYPE_ENUM={2:"touch",3:"pen",4:"mouse",5:"kinect"},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";win.MSPointerEvent&&!win.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel");var PointerEventInput=function(_Input){function PointerEventInput(){var _this,proto=PointerEventInput.prototype;return proto.evEl=POINTER_ELEMENT_EVENTS,proto.evWin=POINTER_WINDOW_EVENTS,(_this=_Input.apply(this,arguments)||this).store=_this.manager.session.pointerEvents=[],_this}return _inheritsLoose(PointerEventInput,_Input),PointerEventInput.prototype.handler=function handler(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch="touch"===pointerType,storeIndex=inArray(store,ev.pointerId,"pointerId");1&eventType&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):12&eventType&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))},PointerEventInput}(Input);function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort((function(a,b){return a[key]>b[key]})):results.sort()),results}var TOUCH_INPUT_MAP={touchstart:1,touchmove:2,touchend:4,touchcancel:8},TouchInput=function(_Input){function TouchInput(){var _this;return TouchInput.prototype.evTarget="touchstart touchmove touchend touchcancel",(_this=_Input.apply(this,arguments)||this).targetIds={},_this}return _inheritsLoose(TouchInput,_Input),TouchInput.prototype.handler=function handler(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})},TouchInput}(Input);function getTouches(ev,type){var i,targetTouches,allTouches=toArray(ev.touches),targetIds=this.targetIds;if(3&type&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter((function(touch){return hasParent(touch.target,target)})),1===type)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;for(i=0;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),12&type&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}var MOUSE_INPUT_MAP={mousedown:1,mousemove:2,mouseup:4},MouseInput=function(_Input){function MouseInput(){var _this,proto=MouseInput.prototype;return proto.evEl="mousedown",proto.evWin="mousemove mouseup",(_this=_Input.apply(this,arguments)||this).pressed=!1,_this}return _inheritsLoose(MouseInput,_Input),MouseInput.prototype.handler=function handler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];1&eventType&&0===ev.button&&(this.pressed=!0),2&eventType&&1!==ev.which&&(eventType=4),this.pressed&&(4&eventType&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:"mouse",srcEvent:ev}))},MouseInput}(Input);function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY},lts=this.lastTouches;this.lastTouches.push(lastTouch);setTimeout((function removeLastTouch(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1)}),2500)}}function recordTouches(eventType,eventData){1&eventType?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):12&eventType&&setLastTouch.call(this,eventData)}function isSyntheticEvent(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=25&&dy<=25)return!0}return!1}var TouchMouseInput=function(){return function(_Input){function TouchMouseInput(_manager,callback){var _this;return(_this=_Input.call(this,_manager,callback)||this).handler=function(manager,inputEvent,inputData){var isTouch="touch"===inputData.pointerType,isMouse="mouse"===inputData.pointerType;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)recordTouches.call(_assertThisInitialized(_assertThisInitialized(_this)),inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(_assertThisInitialized(_assertThisInitialized(_this)),inputData))return;_this.callback(manager,inputEvent,inputData)}},_this.touch=new TouchInput(_this.manager,_this.handler),_this.mouse=new MouseInput(_this.manager,_this.handler),_this.primaryTouch=null,_this.lastTouches=[],_this}return _inheritsLoose(TouchMouseInput,_Input),TouchMouseInput.prototype.destroy=function destroy(){this.touch.destroy(),this.mouse.destroy()},TouchMouseInput}(Input)}();function invokeArrayArg(arg,fn,context){return!!Array.isArray(arg)&&(each(arg,context[fn],context),!0)}var _uniqueId=1;function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function stateStr(state){return 16&state?"cancel":8&state?"end":4&state?"move":2&state?"start":""}var Recognizer=function(){function Recognizer(options){void 0===options&&(options={}),this.options=_extends({enable:!0},options),this.id=function uniqueId(){return _uniqueId++}(),this.manager=null,this.state=1,this.simultaneous={},this.requireFail=[]}var _proto=Recognizer.prototype;return _proto.set=function set(options){return assign$1(this.options,options),this.manager&&this.manager.touchAction.update(),this},_proto.recognizeWith=function recognizeWith(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return simultaneous[(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this)).id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},_proto.dropRecognizeWith=function dropRecognizeWith(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},_proto.requireFailure=function requireFailure(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return-1===inArray(requireFail,otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this))&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},_proto.dropRequireFailure=function dropRequireFailure(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},_proto.hasRequireFailures=function hasRequireFailures(){return this.requireFail.length>0},_proto.canRecognizeWith=function canRecognizeWith(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},_proto.emit=function emit(input){var self=this,state=this.state;function emit(event){self.manager.emit(event,input)}state<8&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=8&&emit(self.options.event+stateStr(state))},_proto.tryEmit=function tryEmit(input){if(this.canEmit())return this.emit(input);this.state=32},_proto.canEmit=function canEmit(){for(var i=0;i<this.requireFail.length;){if(!(33&this.requireFail[i].state))return!1;i++}return!0},_proto.recognize=function recognize(inputData){var inputDataClone=assign$1({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone]))return this.reset(),void(this.state=32);56&this.state&&(this.state=1),this.state=this.process(inputDataClone),30&this.state&&this.tryEmit(inputDataClone)},_proto.process=function process(inputData){},_proto.getTouchAction=function getTouchAction(){},_proto.reset=function reset(){},Recognizer}(),TapRecognizer=function(_Recognizer){function TapRecognizer(options){var _this;return void 0===options&&(options={}),(_this=_Recognizer.call(this,_extends({event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},options))||this).pTime=!1,_this.pCenter=!1,_this._timer=null,_this._input=null,_this.count=0,_this}_inheritsLoose(TapRecognizer,_Recognizer);var _proto=TapRecognizer.prototype;return _proto.getTouchAction=function getTouchAction(){return["manipulation"]},_proto.process=function process(input){var _this2=this,options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),1&input.eventType&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(4!==input.eventType)return this.failTimeout();var validInterval=!this.pTime||input.timeStamp-this.pTime<options.interval,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;if(this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input,0===this.count%options.taps)return this.hasRequireFailures()?(this._timer=setTimeout((function(){_this2.state=8,_this2.tryEmit()}),options.interval),2):8}return 32},_proto.failTimeout=function failTimeout(){var _this3=this;return this._timer=setTimeout((function(){_this3.state=32}),this.options.interval),32},_proto.reset=function reset(){clearTimeout(this._timer)},_proto.emit=function emit(){8===this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))},TapRecognizer}(Recognizer),AttrRecognizer=function(_Recognizer){function AttrRecognizer(options){return void 0===options&&(options={}),_Recognizer.call(this,_extends({pointers:1},options))||this}_inheritsLoose(AttrRecognizer,_Recognizer);var _proto=AttrRecognizer.prototype;return _proto.attrTest=function attrTest(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},_proto.process=function process(input){var state=this.state,eventType=input.eventType,isRecognized=6&state,isValid=this.attrTest(input);return isRecognized&&(8&eventType||!isValid)?16|state:isRecognized||isValid?4&eventType?8|state:2&state?4|state:2:32},AttrRecognizer}(Recognizer);function directionStr(direction){return 16===direction?"down":8===direction?"up":2===direction?"left":4===direction?"right":""}var PanRecognizer=function(_AttrRecognizer){function PanRecognizer(options){var _this;return void 0===options&&(options={}),(_this=_AttrRecognizer.call(this,_extends({event:"pan",threshold:10,pointers:1,direction:30},options))||this).pX=null,_this.pY=null,_this}_inheritsLoose(PanRecognizer,_AttrRecognizer);var _proto=PanRecognizer.prototype;return _proto.getTouchAction=function getTouchAction(){var direction=this.options.direction,actions=[];return 6&direction&&actions.push("pan-y"),24&direction&&actions.push("pan-x"),actions},_proto.directionTest=function directionTest(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(6&options.direction?(direction=0===x?1:x<0?2:4,hasMoved=x!==this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?1:y<0?8:16,hasMoved=y!==this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},_proto.attrTest=function attrTest(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(2&this.state||!(2&this.state)&&this.directionTest(input))},_proto.emit=function emit(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),_AttrRecognizer.prototype.emit.call(this,input)},PanRecognizer}(AttrRecognizer),SwipeRecognizer=function(_AttrRecognizer){function SwipeRecognizer(options){return void 0===options&&(options={}),_AttrRecognizer.call(this,_extends({event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},options))||this}_inheritsLoose(SwipeRecognizer,_AttrRecognizer);var _proto=SwipeRecognizer.prototype;return _proto.getTouchAction=function getTouchAction(){return PanRecognizer.prototype.getTouchAction.call(this)},_proto.attrTest=function attrTest(input){var velocity,direction=this.options.direction;return 30&direction?velocity=input.overallVelocity:6&direction?velocity=input.overallVelocityX:24&direction&&(velocity=input.overallVelocityY),_AttrRecognizer.prototype.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers===this.options.pointers&&abs(velocity)>this.options.velocity&&4&input.eventType},_proto.emit=function emit(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)},SwipeRecognizer}(AttrRecognizer),PinchRecognizer=function(_AttrRecognizer){function PinchRecognizer(options){return void 0===options&&(options={}),_AttrRecognizer.call(this,_extends({event:"pinch",threshold:0,pointers:2},options))||this}_inheritsLoose(PinchRecognizer,_AttrRecognizer);var _proto=PinchRecognizer.prototype;return _proto.getTouchAction=function getTouchAction(){return["none"]},_proto.attrTest=function attrTest(input){return _AttrRecognizer.prototype.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||2&this.state)},_proto.emit=function emit(input){if(1!==input.scale){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}_AttrRecognizer.prototype.emit.call(this,input)},PinchRecognizer}(AttrRecognizer),RotateRecognizer=function(_AttrRecognizer){function RotateRecognizer(options){return void 0===options&&(options={}),_AttrRecognizer.call(this,_extends({event:"rotate",threshold:0,pointers:2},options))||this}_inheritsLoose(RotateRecognizer,_AttrRecognizer);var _proto=RotateRecognizer.prototype;return _proto.getTouchAction=function getTouchAction(){return["none"]},_proto.attrTest=function attrTest(input){return _AttrRecognizer.prototype.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||2&this.state)},RotateRecognizer}(AttrRecognizer),PressRecognizer=function(_Recognizer){function PressRecognizer(options){var _this;return void 0===options&&(options={}),(_this=_Recognizer.call(this,_extends({event:"press",pointers:1,time:251,threshold:9},options))||this)._timer=null,_this._input=null,_this}_inheritsLoose(PressRecognizer,_Recognizer);var _proto=PressRecognizer.prototype;return _proto.getTouchAction=function getTouchAction(){return["auto"]},_proto.process=function process(input){var _this2=this,options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||12&input.eventType&&!validTime)this.reset();else if(1&input.eventType)this.reset(),this._timer=setTimeout((function(){_this2.state=8,_this2.tryEmit()}),options.time);else if(4&input.eventType)return 8;return 32},_proto.reset=function reset(){clearTimeout(this._timer)},_proto.emit=function emit(input){8===this.state&&(input&&4&input.eventType?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))},PressRecognizer}(Recognizer),defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},preset=[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:6}],[PanRecognizer,{direction:6},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]];function toggleCssProps(manager,add){var prop,element=manager.element;element.style&&(each(manager.options.cssProps,(function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""})),add||(manager.oldCssProps={}))}var Manager=function(){function Manager(element,options){var _this=this;this.options=assign$1({},defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=function createInputInstance(manager){var inputClass=manager.options.inputClass;return new(inputClass||(SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput))(manager,inputHandler)}(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,(function(item){var recognizer=_this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])}),this)}var _proto=Manager.prototype;return _proto.set=function set(options){return assign$1(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},_proto.stop=function stop(force){this.session.stopped=force?2:1},_proto.recognize=function recognize(inputData){var session=this.session;if(!session.stopped){var recognizer;this.touchAction.preventDefaults(inputData);var recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&8&curRecognizer.state)&&(session.curRecognizer=null,curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],2===session.stopped||curRecognizer&&recognizer!==curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&14&recognizer.state&&(session.curRecognizer=recognizer,curRecognizer=recognizer),i++}},_proto.get=function get(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event===recognizer)return recognizers[i];return null},_proto.add=function add(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},_proto.remove=function remove(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;var targetRecognizer=this.get(recognizer);if(recognizer){var recognizers=this.recognizers,index=inArray(recognizers,targetRecognizer);-1!==index&&(recognizers.splice(index,1),this.touchAction.update())}return this},_proto.on=function on(events,handler){if(void 0===events||void 0===handler)return this;var handlers=this.handlers;return each(splitStr(events),(function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)})),this},_proto.off=function off(events,handler){if(void 0===events)return this;var handlers=this.handlers;return each(splitStr(events),(function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]})),this},_proto.emit=function emit(event,data){this.options.domEvents&&function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},_proto.destroy=function destroy(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null},Manager}(),SINGLE_TOUCH_INPUT_MAP={touchstart:1,touchmove:2,touchend:4,touchcancel:8},SingleTouchInput=function(_Input){function SingleTouchInput(){var _this,proto=SingleTouchInput.prototype;return proto.evTarget="touchstart",proto.evWin="touchstart touchmove touchend touchcancel",(_this=_Input.apply(this,arguments)||this).started=!1,_this}return _inheritsLoose(SingleTouchInput,_Input),SingleTouchInput.prototype.handler=function handler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(1===type&&(this.started=!0),this.started){var touches=normalizeSingleTouches.call(this,ev,type);12&type&&touches[0].length-touches[1].length==0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:"touch",srcEvent:ev})}},SingleTouchInput}(Input);function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return 12&type&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}var extend=deprecate((function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&void 0===dest[keys[i]])&&(dest[keys[i]]=src[keys[i]]),i++;return dest}),"extend","Use `assign`."),merge=deprecate((function(dest,src){return extend(dest,src,!0)}),"merge","Use `assign`.");function inherit(child,base,properties){var childP,baseP=base.prototype;(childP=child.prototype=Object.create(baseP)).constructor=child,childP._super=baseP,properties&&assign$1(childP,properties)}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments)}}var Hammer=function(){var Hammer=function Hammer(element,options){return void 0===options&&(options={}),new Manager(element,_extends({recognizers:preset.concat()},options))};return Hammer.VERSION="2.0.17-rc",Hammer.DIRECTION_ALL=30,Hammer.DIRECTION_DOWN=16,Hammer.DIRECTION_LEFT=2,Hammer.DIRECTION_RIGHT=4,Hammer.DIRECTION_UP=8,Hammer.DIRECTION_HORIZONTAL=6,Hammer.DIRECTION_VERTICAL=24,Hammer.DIRECTION_NONE=1,Hammer.DIRECTION_DOWN=16,Hammer.INPUT_START=1,Hammer.INPUT_MOVE=2,Hammer.INPUT_END=4,Hammer.INPUT_CANCEL=8,Hammer.STATE_POSSIBLE=1,Hammer.STATE_BEGAN=2,Hammer.STATE_CHANGED=4,Hammer.STATE_ENDED=8,Hammer.STATE_RECOGNIZED=8,Hammer.STATE_CANCELLED=16,Hammer.STATE_FAILED=32,Hammer.Manager=Manager,Hammer.Input=Input,Hammer.TouchAction=TouchAction,Hammer.TouchInput=TouchInput,Hammer.MouseInput=MouseInput,Hammer.PointerEventInput=PointerEventInput,Hammer.TouchMouseInput=TouchMouseInput,Hammer.SingleTouchInput=SingleTouchInput,Hammer.Recognizer=Recognizer,Hammer.AttrRecognizer=AttrRecognizer,Hammer.Tap=TapRecognizer,Hammer.Pan=PanRecognizer,Hammer.Swipe=SwipeRecognizer,Hammer.Pinch=PinchRecognizer,Hammer.Rotate=RotateRecognizer,Hammer.Press=PressRecognizer,Hammer.on=addEventListeners,Hammer.off=removeEventListeners,Hammer.each=each,Hammer.merge=merge,Hammer.extend=extend,Hammer.bindFn=bindFn,Hammer.assign=assign$1,Hammer.inherit=inherit,Hammer.bindFn=bindFn,Hammer.prefixed=prefixed,Hammer.toArray=toArray,Hammer.inArray=inArray,Hammer.uniqueArray=uniqueArray,Hammer.splitStr=splitStr,Hammer.boolOrFn=boolOrFn,Hammer.hasParent=hasParent,Hammer.addEventListeners=addEventListeners,Hammer.removeEventListeners=removeEventListeners,Hammer.defaults=assign$1({},defaults,{preset:preset}),Hammer}(),extendStatics=(Hammer.defaults,function(d,b){return(extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)});function __extends(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var axes_esm_win,__assign=function(){return(__assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function getInsidePosition(destPos,range,circular,bounce){var toDestPos=destPos,targetRange=[circular[0]?range[0]:bounce?range[0]-bounce[0]:range[0],circular[1]?range[1]:bounce?range[1]+bounce[1]:range[1]];return toDestPos=Math.max(targetRange[0],toDestPos),toDestPos=Math.min(targetRange[1],toDestPos)}function isOutside(pos,range){return pos<range[0]||pos>range[1]}function isCircularable(destPos,range,circular){return circular[1]&&destPos>range[1]||circular[0]&&destPos<range[0]}function getCirculatedPos(pos,range,circular){var toPos=pos,min=range[0],max=range[1],length=max-min;return circular[1]&&pos>max&&(toPos=(toPos-max)%length+min),circular[0]&&pos<min&&(toPos=(toPos-min)%length+max),toPos}function axes_esm_toArray(nodes){for(var el=[],i=0,len=nodes.length;i<len;i++)el.push(nodes[i]);return el}function $(param,multi){var el;if(void 0===multi&&(multi=!1),"string"==typeof param){if(param.match(/^<([a-z]+)\s*([^>]*)>/)){var dummy=document.createElement("div");dummy.innerHTML=param,el=axes_esm_toArray(dummy.childNodes)}else el=axes_esm_toArray(document.querySelectorAll(param));multi||(el=el.length>=1?el[0]:void 0)}else param===axes_esm_win?el=param:!param.nodeName||1!==param.nodeType&&9!==param.nodeType?"jQuery"in axes_esm_win&&param instanceof jQuery||param.constructor.prototype.jquery?el=multi?param.toArray():param.get(0):Array.isArray(param)&&(el=param.map((function(v){return $(v)})),multi||(el=el.length>=1?el[0]:void 0)):el=param;return el}var raf=(axes_esm_win="undefined"==typeof window?{navigator:{userAgent:""}}:window).requestAnimationFrame||axes_esm_win.webkitRequestAnimationFrame,caf=axes_esm_win.cancelAnimationFrame||axes_esm_win.webkitCancelAnimationFrame;if(raf&&!caf){var keyInfo_1={},oldraf_1=raf;raf=function(callback){var key=oldraf_1((function wrapCallback(timestamp){keyInfo_1[key]&&callback(timestamp)}));return keyInfo_1[key]=!0,key},caf=function(key){delete keyInfo_1[key]}}else raf&&caf||(raf=function(callback){return axes_esm_win.setTimeout((function(){callback(axes_esm_win.performance&&axes_esm_win.performance.now&&axes_esm_win.performance.now()||(new Date).getTime())}),16)},caf=axes_esm_win.clearTimeout);function map(obj,callback){var tranformed={};for(var k in obj)k&&(tranformed[k]=callback(obj[k],k));return tranformed}function filter(obj,callback){var filtered={};for(var k in obj)k&&callback(obj[k],k)&&(filtered[k]=obj[k]);return filtered}function every(obj,callback){for(var k in obj)if(k&&!callback(obj[k],k))return!1;return!0}function equal(target,base){return every(target,(function(v,k){return v===base[k]}))}var roundNumFunc={};function roundNumber(num,roundUnit){return roundNumFunc[roundUnit]||(roundNumFunc[roundUnit]=function getRoundFunc(v){var p=v<1?Math.pow(10,getDecimalPlace(v)):1;return function(n){return 0===v?0:Math.round(Math.round(n/v)*v*p)/p}}(roundUnit)),roundNumFunc[roundUnit](num)}function roundNumbers(num,roundUnit){if(!num||!roundUnit)return num;var isNumber="number"==typeof roundUnit;return map(num,(function(value,key){return roundNumber(value,isNumber?roundUnit:roundUnit[key])}))}function getDecimalPlace(val){if(!isFinite(val))return 0;var v=val+"";if(v.indexOf("e")>=0){for(var p=0,e=1;Math.round(val*e)/e!==val;)e*=10,p++;return p}return v.indexOf(".")>=0?v.length-v.indexOf(".")-1:0}function minMax(value,min,max){return Math.max(Math.min(value,max),min)}var AnimationManager=function(){function AnimationManager(_a){var options=_a.options,itm=_a.itm,em=_a.em,axm=_a.axm;this.options=options,this.itm=itm,this.em=em,this.axm=axm,this.animationEnd=this.animationEnd.bind(this)}var __proto=AnimationManager.prototype;return __proto.getDuration=function(depaPos,destPos,wishDuration){var duration,_this=this;if(void 0!==wishDuration)duration=wishDuration;else{var durations_1=map(destPos,(function(v,k){return function getDuration(distance,deceleration){var duration=Math.sqrt(distance/deceleration*2);return duration<100?0:duration}(Math.abs(v-depaPos[k]),_this.options.deceleration)}));duration=Object.keys(durations_1).reduce((function(max,v){return Math.max(max,durations_1[v])}),-1/0)}return minMax(duration,this.options.minimumDuration,this.options.maximumDuration)},__proto.createAnimationParam=function(pos,duration,option){var depaPos=this.axm.get(),destPos=pos,inputEvent=option&&option.event||null;return{depaPos:depaPos,destPos:destPos,duration:minMax(duration,this.options.minimumDuration,this.options.maximumDuration),delta:this.axm.getDelta(depaPos,destPos),inputEvent:inputEvent,input:option&&option.input||null,isTrusted:!!inputEvent,done:this.animationEnd}},__proto.grab=function(axes,option){if(this._animateParam&&axes.length){var orgPos_1=this.axm.get(axes),pos=this.axm.map(orgPos_1,(function(v,opt){return getCirculatedPos(v,opt.range,opt.circular)}));every(pos,(function(v,k){return orgPos_1[k]===v}))||this.em.triggerChange(pos,!1,orgPos_1,option,!!option),this._animateParam=null,this._raf&&function cancelAnimationFrame(key){caf(key)}(this._raf),this._raf=null,this.em.triggerAnimationEnd(!(!option||!option.event))}},__proto.getEventInfo=function(){return this._animateParam&&this._animateParam.input&&this._animateParam.inputEvent?{input:this._animateParam.input,event:this._animateParam.inputEvent}:null},__proto.restore=function(option){var pos=this.axm.get(),destPos=this.axm.map(pos,(function(v,opt){return Math.min(opt.range[1],Math.max(opt.range[0],v))}));this.animateTo(destPos,this.getDuration(pos,destPos),option)},__proto.animationEnd=function(){var beforeParam=this.getEventInfo();this._animateParam=null;var circularTargets=this.axm.filter(this.axm.get(),(function(v,opt){return isCircularable(v,opt.range,opt.circular)}));Object.keys(circularTargets).length>0&&this.setTo(this.axm.map(circularTargets,(function(v,opt){return getCirculatedPos(v,opt.range,opt.circular)}))),this.itm.setInterrupt(!1),this.em.triggerAnimationEnd(!!beforeParam),this.axm.isOutside()?this.restore(beforeParam):this.finish(!!beforeParam)},__proto.finish=function(isTrusted){this._animateParam=null,this.itm.setInterrupt(!1),this.em.triggerFinish(isTrusted)},__proto.animateLoop=function(param,complete){if(param.duration){this._animateParam=__assign({},param);var info_1=this._animateParam,self_1=this,destPos_1=info_1.destPos,prevPos_1=info_1.depaPos,prevEasingPer_1=0,directions_1=map(prevPos_1,(function(value,key){return value<=destPos_1[key]?1:-1})),originalIntendedPos_1=map(destPos_1,(function(v){return v})),prevTime_1=(new Date).getTime();info_1.startTime=prevTime_1,function loop(){self_1._raf=null;var currentTime=(new Date).getTime(),ratio=(currentTime-info_1.startTime)/param.duration,easingPer=self_1.easing(ratio),toPos=self_1.axm.map(prevPos_1,(function(pos,options,key){var nextPos=ratio>=1?destPos_1[key]:pos+info_1.delta[key]*(easingPer-prevEasingPer_1),circulatedPos=getCirculatedPos(nextPos,options.range,options.circular);if(nextPos!==circulatedPos){var rangeOffset=directions_1[key]*(options.range[1]-options.range[0]);destPos_1[key]-=rangeOffset,prevPos_1[key]-=rangeOffset}return circulatedPos})),isCanceled=!self_1.em.triggerChange(toPos,!1,prevPos_1);if(prevPos_1=toPos,prevTime_1=currentTime,prevEasingPer_1=easingPer,easingPer>=1)return equal(destPos_1=self_1.getFinalPos(destPos_1,originalIntendedPos_1),self_1.axm.get(Object.keys(destPos_1)))||self_1.em.triggerChange(destPos_1,!0,prevPos_1),void complete();isCanceled?self_1.finish(!1):self_1._raf=function requestAnimationFrame(fp){return raf(fp)}(loop)}()}else this.em.triggerChange(param.destPos,!0),complete()},__proto.getFinalPos=function(destPos,originalIntendedPos){var _this=this;return map(destPos,(function(value,key){return value>=originalIntendedPos[key]-1e-6&&value<=originalIntendedPos[key]+1e-6?originalIntendedPos[key]:roundNumber(value,_this.getRoundUnit(value,key))}))},__proto.getRoundUnit=function(val,key){var roundUnit=this.options.round,minRoundUnit=null;if(!roundUnit){var options=this.axm.getAxisOptions(key);minRoundUnit=function inversePow(n){return 1/Math.pow(10,n)}(Math.max(getDecimalPlace(options.range[0]),getDecimalPlace(options.range[1]),getDecimalPlace(val)))}return minRoundUnit||roundUnit},__proto.getUserControll=function(param){var userWish=param.setTo();return userWish.destPos=this.axm.get(userWish.destPos),userWish.duration=minMax(userWish.duration,this.options.minimumDuration,this.options.maximumDuration),userWish},__proto.animateTo=function(destPos,duration,option){var _this=this,param=this.createAnimationParam(destPos,duration,option),depaPos=__assign({},param.depaPos),retTrigger=this.em.triggerAnimationStart(param),userWish=this.getUserControll(param);if(!retTrigger&&this.axm.every(userWish.destPos,(function(v,opt){return isCircularable(v,opt.range,opt.circular)}))&&console.warn("You can't stop the 'animation' event when 'circular' is true."),retTrigger&&!equal(userWish.destPos,depaPos)){var inputEvent=option&&option.event||null;this.animateLoop({depaPos:depaPos,destPos:userWish.destPos,duration:userWish.duration,delta:this.axm.getDelta(depaPos,userWish.destPos),isTrusted:!!inputEvent,inputEvent:inputEvent,input:option&&option.input||null},(function(){return _this.animationEnd()}))}},__proto.easing=function(p){return p>1?1:this.options.easing(p)},__proto.setTo=function(pos,duration){void 0===duration&&(duration=0);var axes=Object.keys(pos);this.grab(axes);var orgPos=this.axm.get(axes);if(equal(pos,orgPos))return this;this.itm.setInterrupt(!0);var movedPos=filter(pos,(function(v,k){return orgPos[k]!==v}));return Object.keys(movedPos).length?equal(movedPos=this.axm.map(movedPos,(function(v,opt){var range=opt.range,circular=opt.circular;return circular&&(circular[0]||circular[1])?v:getInsidePosition(v,range,circular)})),orgPos)?this:(duration>0?this.animateTo(movedPos,duration):(this.em.triggerChange(movedPos),this.finish(!1)),this):this},__proto.setBy=function(pos,duration){return void 0===duration&&(duration=0),this.setTo(map(this.axm.get(Object.keys(pos)),(function(v,k){return v+pos[k]})),duration)},AnimationManager}(),EventManager=function(){function EventManager(axes){this.axes=axes}var __proto=EventManager.prototype;return __proto.triggerHold=function(pos,option){var roundPos=this.getRoundPos(pos).roundPos;this.axes.trigger("hold",{pos:roundPos,input:option.input||null,inputEvent:option.event||null,isTrusted:!0})},__proto.triggerRelease=function(param){var _a=this.getRoundPos(param.destPos,param.depaPos),roundPos=_a.roundPos,roundDepa=_a.roundDepa;param.destPos=roundPos,param.depaPos=roundDepa,param.setTo=this.createUserControll(param.destPos,param.duration),this.axes.trigger("release",param)},__proto.triggerChange=function(pos,isAccurate,depaPos,option,holding){void 0===holding&&(holding=!1);var am=this.am,axm=am.axm,eventInfo=am.getEventInfo(),_a=this.getRoundPos(pos,depaPos),roundPos=_a.roundPos,roundDepa=_a.roundDepa,moveTo=axm.moveTo(roundPos,roundDepa),inputEvent=option&&option.event||eventInfo&&eventInfo.event||null,param={pos:moveTo.pos,delta:moveTo.delta,holding:holding,inputEvent:inputEvent,isTrusted:!!inputEvent,input:option&&option.input||eventInfo&&eventInfo.input||null,set:inputEvent?this.createUserControll(moveTo.pos):function(){}},result=this.axes.trigger("change",param);return inputEvent&&axm.set(param.set().destPos),result},__proto.triggerAnimationStart=function(param){var _a=this.getRoundPos(param.destPos,param.depaPos),roundPos=_a.roundPos,roundDepa=_a.roundDepa;return param.destPos=roundPos,param.depaPos=roundDepa,param.setTo=this.createUserControll(param.destPos,param.duration),this.axes.trigger("animationStart",param)},__proto.triggerAnimationEnd=function(isTrusted){void 0===isTrusted&&(isTrusted=!1),this.axes.trigger("animationEnd",{isTrusted:isTrusted})},__proto.triggerFinish=function(isTrusted){void 0===isTrusted&&(isTrusted=!1),this.axes.trigger("finish",{isTrusted:isTrusted})},__proto.createUserControll=function(pos,duration){void 0===duration&&(duration=0);var userControl={destPos:__assign({},pos),duration:duration};return function(toPos,userDuration){return toPos&&(userControl.destPos=__assign({},toPos)),void 0!==userDuration&&(userControl.duration=userDuration),userControl}},__proto.setAnimationManager=function(am){this.am=am},__proto.destroy=function(){this.axes.off()},__proto.getRoundPos=function(pos,depaPos){var roundUnit=this.axes.options.round;return{roundPos:roundNumbers(pos,roundUnit),roundDepa:roundNumbers(depaPos,roundUnit)}},EventManager}(),InterruptManager=function(){function InterruptManager(options){this.options=options,this._prevented=!1}var __proto=InterruptManager.prototype;return __proto.isInterrupting=function(){return this.options.interruptable||this._prevented},__proto.isInterrupted=function(){return!this.options.interruptable&&this._prevented},__proto.setInterrupt=function(prevented){!this.options.interruptable&&(this._prevented=prevented)},InterruptManager}(),AxisManager=function(){function AxisManager(axis,options){var _this=this;this.axis=axis,this.options=options,this._complementOptions(),this._pos=Object.keys(this.axis).reduce((function(acc,v){return acc[v]=_this.axis[v].range[0],acc}),{})}var __proto=AxisManager.prototype;return __proto._complementOptions=function(){var _this=this;Object.keys(this.axis).forEach((function(axis){_this.axis[axis]=__assign({range:[0,100],bounce:[0,0],circular:[!1,!1]},_this.axis[axis]),["bounce","circular"].forEach((function(v){var axisOption=_this.axis,key=axisOption[axis][v];/string|number|boolean/.test(typeof key)&&(axisOption[axis][v]=[key,key])}))}))},__proto.getDelta=function(depaPos,destPos){var fullDepaPos=this.get(depaPos);return map(this.get(destPos),(function(v,k){return v-fullDepaPos[k]}))},__proto.get=function(axes){var _this=this;return axes&&Array.isArray(axes)?axes.reduce((function(acc,v){return v&&v in _this._pos&&(acc[v]=_this._pos[v]),acc}),{}):__assign(__assign({},this._pos),axes||{})},__proto.moveTo=function(pos,depaPos){void 0===depaPos&&(depaPos=this._pos);var delta=map(this._pos,(function(v,key){return key in pos&&key in depaPos?pos[key]-depaPos[key]:0}));return this.set(this.map(pos,(function(v,opt){return opt?getCirculatedPos(v,opt.range,opt.circular):0}))),{pos:__assign({},this._pos),delta:delta}},__proto.set=function(pos){for(var k in pos)k&&k in this._pos&&(this._pos[k]=pos[k])},__proto.every=function(pos,callback){var axisOptions=this.axis;return every(pos,(function(value,key){return callback(value,axisOptions[key],key)}))},__proto.filter=function(pos,callback){var axisOptions=this.axis;return filter(pos,(function(value,key){return callback(value,axisOptions[key],key)}))},__proto.map=function(pos,callback){var axisOptions=this.axis;return map(pos,(function(value,key){return callback(value,axisOptions[key],key)}))},__proto.isOutside=function(axes){return!this.every(axes?this.get(axes):this._pos,(function(v,opt){return!isOutside(v,opt.range)}))},__proto.getAxisOptions=function(key){return this.axis[key]},AxisManager}(),InputObserver=function(){function InputObserver(_a){var options=_a.options,itm=_a.itm,em=_a.em,axm=_a.axm,am=_a.am;this.isOutside=!1,this.moveDistance=null,this.isStopped=!1,this.options=options,this.itm=itm,this.em=em,this.axm=axm,this.am=am}var __proto=InputObserver.prototype;return __proto.atOutside=function(pos){var _this=this;if(this.isOutside)return this.axm.map(pos,(function(v,opt){var tn=opt.range[0]-opt.bounce[0],tx=opt.range[1]+opt.bounce[1];return v>tx?tx:v<tn?tn:v}));var initSlope_1=this.am.easing(1e-5)/1e-5;return this.axm.map(pos,(function(v,opt){var min=opt.range[0],max=opt.range[1],out=opt.bounce,circular=opt.circular;return circular&&(circular[0]||circular[1])?v:v<min?min-_this.am.easing((min-v)/(out[0]*initSlope_1))*out[0]:v>max?max+_this.am.easing((v-max)/(out[1]*initSlope_1))*out[1]:v}))},__proto.get=function(input){return this.axm.get(input.axes)},__proto.hold=function(input,event){if(!this.itm.isInterrupted()&&input.axes.length){var changeOption={input:input,event:event};this.isStopped=!1,this.itm.setInterrupt(!0),this.am.grab(input.axes,changeOption),!this.moveDistance&&this.em.triggerHold(this.axm.get(),changeOption),this.isOutside=this.axm.isOutside(input.axes),this.moveDistance=this.axm.get(input.axes)}},__proto.change=function(input,event,offset){if(!this.isStopped&&this.itm.isInterrupting()&&!this.axm.every(offset,(function(v){return 0===v}))){var destPos,depaPos=this.moveDistance||this.axm.get(input.axes);destPos=map(depaPos,(function(v,k){return v+(offset[k]||0)})),this.moveDistance&&(this.moveDistance=destPos),this.isOutside&&this.axm.every(depaPos,(function(v,opt){return!isOutside(v,opt.range)}))&&(this.isOutside=!1),depaPos=this.atOutside(depaPos),destPos=this.atOutside(destPos),!this.em.triggerChange(destPos,!1,depaPos,{input:input,event:event},!0)&&(this.isStopped=!0,this.moveDistance=null,this.am.finish(!1))}},__proto.release=function(input,event,offset,inputDuration){if(!this.isStopped&&this.itm.isInterrupting()&&this.moveDistance){var pos=this.axm.get(input.axes),depaPos=this.axm.get(),destPos=this.axm.get(this.axm.map(offset,(function(v,opt,k){return opt.circular&&(opt.circular[0]||opt.circular[1])?pos[k]+v:getInsidePosition(pos[k]+v,opt.range,opt.circular,opt.bounce)}))),duration=this.am.getDuration(destPos,pos,inputDuration);0===duration&&(destPos=__assign({},depaPos));var param={depaPos:depaPos,destPos:destPos,duration:duration,delta:this.axm.getDelta(depaPos,destPos),inputEvent:event,input:input,isTrusted:!0};this.em.triggerRelease(param),this.moveDistance=null;var userWish=this.am.getUserControll(param),isEqual=equal(userWish.destPos,depaPos),changeOption={input:input,event:event};isEqual||0===userWish.duration?(!isEqual&&this.em.triggerChange(userWish.destPos,!1,depaPos,changeOption,!0),this.itm.setInterrupt(!1),this.axm.isOutside()?this.am.restore(changeOption):this.em.triggerFinish(!0)):this.am.animateTo(userWish.destPos,userWish.duration,changeOption)}},InputObserver}(),IS_IOS_SAFARI="ontouchstart"in axes_esm_win&&"safari"===agent_esm().browser.name,TRANSFORM=function(){if("undefined"==typeof document)return"";for(var bodyStyle=(document.head||document.getElementsByTagName("head")[0]).style,target=["transform","webkitTransform","msTransform","mozTransform"],i=0,len=target.length;i<len;i++)if(target[i]in bodyStyle)return target[i];return""}(),axes_esm_Axes=function(_super){function Axes(axis,options,startPos){void 0===axis&&(axis={}),void 0===options&&(options={});var _this=_super.call(this)||this;return _this.axis=axis,_this._inputs=[],_this.options=__assign({easing:function easeOutCubic(x){return 1-Math.pow(1-x,3)},interruptable:!0,maximumDuration:1/0,minimumDuration:0,deceleration:6e-4,round:null},options),_this.itm=new InterruptManager(_this.options),_this.axm=new AxisManager(_this.axis,_this.options),_this.em=new EventManager(_this),_this.am=new AnimationManager(_this),_this.io=new InputObserver(_this),_this.em.setAnimationManager(_this.am),startPos&&_this.em.triggerChange(startPos),_this}__extends(Axes,_super);var __proto=Axes.prototype;return __proto.connect=function(axes,inputType){var mapped;if(mapped="string"==typeof axes?axes.split(" "):axes.concat(),~this._inputs.indexOf(inputType)&&this.disconnect(inputType),"hammer"in inputType){var targets=this._inputs.filter((function(v){return v.hammer&&v.element===inputType.element}));targets.length&&(inputType.hammer=targets[0].hammer)}return inputType.mapAxes(mapped),inputType.connect(this.io),this._inputs.push(inputType),this},__proto.disconnect=function(inputType){if(inputType){var index=this._inputs.indexOf(inputType);index>=0&&(this._inputs[index].disconnect(),this._inputs.splice(index,1))}else this._inputs.forEach((function(v){return v.disconnect()})),this._inputs=[];return this},__proto.get=function(axes){return this.axm.get(axes)},__proto.setTo=function(pos,duration){return void 0===duration&&(duration=0),this.am.setTo(pos,duration),this},__proto.setBy=function(pos,duration){return void 0===duration&&(duration=0),this.am.setBy(pos,duration),this},__proto.isBounceArea=function(axes){return this.axm.isOutside(axes)},__proto.destroy=function(){this.disconnect(),this.em.destroy()},Axes.VERSION="2.8.0",Axes.TRANSFORM=TRANSFORM,Axes.DIRECTION_NONE=1,Axes.DIRECTION_LEFT=2,Axes.DIRECTION_RIGHT=4,Axes.DIRECTION_UP=8,Axes.DIRECTION_DOWN=16,Axes.DIRECTION_HORIZONTAL=6,Axes.DIRECTION_VERTICAL=24,Axes.DIRECTION_ALL=30,Axes}(component_esm),axes_esm_SUPPORT_POINTER_EVENTS="PointerEvent"in axes_esm_win||"MSPointerEvent"in axes_esm_win,axes_esm_SUPPORT_TOUCH="ontouchstart"in axes_esm_win,UNIQUEKEY="_EGJS_AXES_INPUTTYPE_";function toAxis(source,offset){return offset.reduce((function(acc,v,i){return source[i]&&(acc[source[i]]=v),acc}),{})}function createHammer(element,options){try{return new Manager(element,__assign({},options))}catch(e){return null}}function convertInputType(inputType){void 0===inputType&&(inputType=[]);var hasTouch=!1,hasMouse=!1,hasPointer=!1;return inputType.forEach((function(v){switch(v){case"mouse":hasMouse=!0;break;case"touch":hasTouch=axes_esm_SUPPORT_TOUCH;break;case"pointer":hasPointer=axes_esm_SUPPORT_POINTER_EVENTS}})),hasPointer?PointerEventInput:hasTouch&&hasMouse?TouchMouseInput:hasTouch?TouchInput:hasMouse?MouseInput:null}function axes_esm_useDirection(checkType,direction,userDirection){return userDirection?!!(30===direction||direction&checkType&&userDirection&checkType):!!(direction&checkType)}var axes_esm_PanInput=function(){function PanInput(el,options){if(this.axes=[],this.hammer=null,this.element=null,this.panRecognizer=null,this.isRightEdge=!1,this.rightEdgeTimer=0,this.panFlag=!1,void 0===Manager)throw new Error("The Hammerjs must be loaded before eg.Axes.PanInput.\nhttp://hammerjs.github.io/");this.element=$(el),this.options=__assign({inputType:["touch","mouse","pointer"],scale:[1,1],thresholdAngle:45,threshold:0,iOSEdgeSwipeThreshold:30,releaseOnScroll:!1,hammerManagerOptions:{cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",userDrag:"none"}}},options),this.onHammerInput=this.onHammerInput.bind(this),this.onPanmove=this.onPanmove.bind(this),this.onPanend=this.onPanend.bind(this)}var __proto=PanInput.prototype;return __proto.mapAxes=function(axes){var useHorizontal=!!axes[0],useVertical=!!axes[1];this._direction=useHorizontal&&useVertical?30:useHorizontal?6:useVertical?24:1,this.axes=axes},__proto.connect=function(observer){var hammerOption={direction:this._direction,threshold:this.options.threshold};if(this.hammer)this.removeRecognizer(),this.dettachEvent();else{var keyValue=this.element[UNIQUEKEY];keyValue||(keyValue=String(Math.round(Math.random()*(new Date).getTime())));var inputClass=convertInputType(this.options.inputType);if(!inputClass)throw new Error("Wrong inputType parameter!");this.hammer=createHammer(this.element,__assign({inputClass:inputClass},this.options.hammerManagerOptions)),this.element[UNIQUEKEY]=keyValue}return this.panRecognizer=new PanRecognizer(hammerOption),this.hammer.add(this.panRecognizer),this.attachEvent(observer),this},__proto.disconnect=function(){return this.removeRecognizer(),this.hammer&&this.dettachEvent(),this._direction=1,this},__proto.destroy=function(){this.disconnect(),this.hammer&&0===this.hammer.recognizers.length&&this.hammer.destroy(),delete this.element[UNIQUEKEY],this.element=null,this.hammer=null},__proto.enable=function(){return this.hammer&&(this.hammer.get("pan").options.enable=!0),this},__proto.disable=function(){return this.hammer&&(this.hammer.get("pan").options.enable=!1),this},__proto.isEnable=function(){return!(!this.hammer||!this.hammer.get("pan").options.enable)},__proto.removeRecognizer=function(){this.hammer&&this.panRecognizer&&(this.hammer.remove(this.panRecognizer),this.panRecognizer=null)},__proto.onHammerInput=function(event){if(this.isEnable())if(event.isFirst){if(this.panFlag=!1,!1!==event.srcEvent.cancelable){var edgeThreshold=this.options.iOSEdgeSwipeThreshold;this.observer.hold(this,event),this.isRightEdge=IS_IOS_SAFARI&&event.center.x>window.innerWidth-edgeThreshold,this.panFlag=!0}}else event.isFinal&&this.onPanend(event)},__proto.onPanmove=function(event){var _this=this;if(this.panFlag){var _a=this.options,iOSEdgeSwipeThreshold=_a.iOSEdgeSwipeThreshold,releaseOnScroll=_a.releaseOnScroll,userDirection=function getDirectionByAngle(angle,thresholdAngle){if(thresholdAngle<0||thresholdAngle>90)return 1;var toAngle=Math.abs(angle);return toAngle>thresholdAngle&&toAngle<180-thresholdAngle?24:6}(event.angle,this.options.thresholdAngle),prevInput=this.hammer.session.prevInput;if(!releaseOnScroll||event.srcEvent.cancelable){if(prevInput&&IS_IOS_SAFARI){if(event.center.x<0)return void this.onPanend(__assign(__assign({},prevInput),{velocityX:0,velocityY:0,offsetX:0,offsetY:0}));this.isRightEdge&&(clearTimeout(this.rightEdgeTimer),event.deltaX<-iOSEdgeSwipeThreshold?this.isRightEdge=!1:this.rightEdgeTimer=window.setTimeout((function(){_this.onPanend(__assign(__assign({},prevInput),{velocityX:0,velocityY:0,offsetX:0,offsetY:0}))}),100))}prevInput?(event.offsetX=event.deltaX-prevInput.deltaX,event.offsetY=event.deltaY-prevInput.deltaY):(event.offsetX=0,event.offsetY=0);var offset=this.getOffset([event.offsetX,event.offsetY],[axes_esm_useDirection(6,this._direction,userDirection),axes_esm_useDirection(24,this._direction,userDirection)]),prevent=offset.some((function(v){return 0!==v}));if(prevent){var srcEvent=event.srcEvent;!1!==srcEvent.cancelable&&srcEvent.preventDefault(),srcEvent.stopPropagation()}event.preventSystemEvent=prevent,prevent&&this.observer.change(this,event,toAxis(this.axes,offset))}else this.onPanend(__assign(__assign({},event),{velocityX:0,velocityY:0,offsetX:0,offsetY:0}))}},__proto.onPanend=function(event){if(this.panFlag){clearTimeout(this.rightEdgeTimer),this.panFlag=!1;var offset=this.getOffset([Math.abs(event.velocityX)*(event.deltaX<0?-1:1),Math.abs(event.velocityY)*(event.deltaY<0?-1:1)],[axes_esm_useDirection(6,this._direction),axes_esm_useDirection(24,this._direction)]);offset=function getNextOffset(speeds,deceleration){var normalSpeed=Math.sqrt(speeds[0]*speeds[0]+speeds[1]*speeds[1]),duration=Math.abs(normalSpeed/-deceleration);return[speeds[0]/2*duration,speeds[1]/2*duration]}(offset,this.observer.options.deceleration),this.observer.release(this,event,toAxis(this.axes,offset))}},__proto.attachEvent=function(observer){this.observer=observer,this.hammer.on("hammer.input",this.onHammerInput).on("panstart panmove",this.onPanmove)},__proto.dettachEvent=function(){this.hammer.off("hammer.input",this.onHammerInput).off("panstart panmove",this.onPanmove),this.observer=null},__proto.getOffset=function(properties,direction){var offset=[0,0],scale=this.options.scale;return direction[0]&&(offset[0]=properties[0]*scale[0]),direction[1]&&(offset[1]=properties[1]*scale[1]),offset},PanInput}(),axes_esm_PinchInput=function(){function PinchInput(el,options){if(this.axes=[],this.hammer=null,this.element=null,this._base=null,this._prev=null,this.pinchRecognizer=null,void 0===Manager)throw new Error("The Hammerjs must be loaded before eg.Axes.PinchInput.\nhttp://hammerjs.github.io/");this.element=$(el),this.options=__assign({scale:1,threshold:0,inputType:["touch","pointer"],hammerManagerOptions:{cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",userDrag:"none"}}},options),this.onPinchStart=this.onPinchStart.bind(this),this.onPinchMove=this.onPinchMove.bind(this),this.onPinchEnd=this.onPinchEnd.bind(this)}var __proto=PinchInput.prototype;return __proto.mapAxes=function(axes){this.axes=axes},__proto.connect=function(observer){var hammerOption={threshold:this.options.threshold};if(this.hammer)this.removeRecognizer(),this.dettachEvent();else{var keyValue=this.element[UNIQUEKEY];keyValue||(keyValue=String(Math.round(Math.random()*(new Date).getTime())));var inputClass=convertInputType(this.options.inputType);if(!inputClass)throw new Error("Wrong inputType parameter!");this.hammer=createHammer(this.element,__assign({inputClass:inputClass},this.options.hammerManagerOptions)),this.element[UNIQUEKEY]=keyValue}return this.pinchRecognizer=new PinchRecognizer(hammerOption),this.hammer.add(this.pinchRecognizer),this.attachEvent(observer),this},__proto.disconnect=function(){return this.removeRecognizer(),this.hammer&&(this.hammer.remove(this.pinchRecognizer),this.pinchRecognizer=null,this.dettachEvent()),this},__proto.destroy=function(){this.disconnect(),this.hammer&&0===this.hammer.recognizers.length&&this.hammer.destroy(),delete this.element[UNIQUEKEY],this.element=null,this.hammer=null},__proto.removeRecognizer=function(){this.hammer&&this.pinchRecognizer&&(this.hammer.remove(this.pinchRecognizer),this.pinchRecognizer=null)},__proto.onPinchStart=function(event){this._base=this.observer.get(this)[this.axes[0]];var offset=this.getOffset(event.scale);this.observer.hold(this,event),this.observer.change(this,event,toAxis(this.axes,[offset])),this._prev=event.scale},__proto.onPinchMove=function(event){var offset=this.getOffset(event.scale,this._prev);this.observer.change(this,event,toAxis(this.axes,[offset])),this._prev=event.scale},__proto.onPinchEnd=function(event){var offset=this.getOffset(event.scale,this._prev);this.observer.change(this,event,toAxis(this.axes,[offset])),this.observer.release(this,event,toAxis(this.axes,[0]),0),this._base=null,this._prev=null},__proto.getOffset=function(pinchScale,prev){return void 0===prev&&(prev=1),this._base*(pinchScale-prev)*this.options.scale},__proto.attachEvent=function(observer){this.observer=observer,this.hammer.on("pinchstart",this.onPinchStart).on("pinchmove",this.onPinchMove).on("pinchend",this.onPinchEnd)},__proto.dettachEvent=function(){this.hammer.off("pinchstart",this.onPinchStart).off("pinchmove",this.onPinchMove).off("pinchend",this.onPinchEnd),this.observer=null,this._prev=null},__proto.enable=function(){return this.hammer&&(this.hammer.get("pinch").options.enable=!0),this},__proto.disable=function(){return this.hammer&&(this.hammer.get("pinch").options.enable=!1),this},__proto.isEnable=function(){return!(!this.hammer||!this.hammer.get("pinch").options.enable)},PinchInput}(),WheelInput=function(){function WheelInput(el,options){this.axes=[],this.element=null,this._isEnabled=!1,this._isHolded=!1,this._timer=null,this.element=$(el),this.options=__assign({scale:1,useNormalized:!0},options),this.onWheel=this.onWheel.bind(this)}var __proto=WheelInput.prototype;return __proto.mapAxes=function(axes){this.axes=axes},__proto.connect=function(observer){return this.dettachEvent(),this.attachEvent(observer),this},__proto.disconnect=function(){return this.dettachEvent(),this},__proto.destroy=function(){this.disconnect(),this.element=null},__proto.onWheel=function(event){var _this=this;if(this._isEnabled&&(event.preventDefault(),0!==event.deltaY)){this._isHolded||(this.observer.hold(this,event),this._isHolded=!0);var offset=(event.deltaY>0?-1:1)*this.options.scale*(this.options.useNormalized?1:Math.abs(event.deltaY));this.observer.change(this,event,toAxis(this.axes,[offset])),clearTimeout(this._timer),this._timer=setTimeout((function(){_this._isHolded&&(_this._isHolded=!1,_this.observer.release(_this,event,toAxis(_this.axes,[0])))}),50)}},__proto.attachEvent=function(observer){this.observer=observer,this.element.addEventListener("wheel",this.onWheel),this._isEnabled=!0},__proto.dettachEvent=function(){this.element.removeEventListener("wheel",this.onWheel),this._isEnabled=!1,this.observer=null,this._timer&&(clearTimeout(this._timer),this._timer=null)},__proto.enable=function(){return this._isEnabled=!0,this},__proto.disable=function(){return this._isEnabled=!1,this},__proto.isEnable=function(){return this._isEnabled},WheelInput}(),MoveKeyInput=function(){function MoveKeyInput(el,options){this.axes=[],this.element=null,this._isEnabled=!1,this._isHolded=!1,this._timer=null,this.element=$(el),this.options=__assign({scale:[1,1]},options),this.onKeydown=this.onKeydown.bind(this),this.onKeyup=this.onKeyup.bind(this)}var __proto=MoveKeyInput.prototype;return __proto.mapAxes=function(axes){this.axes=axes},__proto.connect=function(observer){return this.dettachEvent(),"0"!==this.element.getAttribute("tabindex")&&this.element.setAttribute("tabindex","0"),this.attachEvent(observer),this},__proto.disconnect=function(){return this.dettachEvent(),this},__proto.destroy=function(){this.disconnect(),this.element=null},__proto.onKeydown=function(e){if(this._isEnabled){var isMoveKey=!0,direction=1,move=-1;switch(e.keyCode){case 37:case 65:direction=-1;break;case 39:case 68:break;case 40:case 83:direction=-1,move=1;break;case 38:case 87:move=1;break;default:isMoveKey=!1}if((-1===move&&!this.axes[0]||1===move&&!this.axes[1])&&(isMoveKey=!1),isMoveKey){var offsets=-1===move?[+this.options.scale[0]*direction,0]:[0,+this.options.scale[1]*direction];this._isHolded||(this.observer.hold(this,event),this._isHolded=!0),clearTimeout(this._timer),this.observer.change(this,event,toAxis(this.axes,offsets))}}},__proto.onKeyup=function(e){var _this=this;this._isHolded&&(clearTimeout(this._timer),this._timer=setTimeout((function(){_this.observer.release(_this,e,toAxis(_this.axes,[0,0])),_this._isHolded=!1}),80))},__proto.attachEvent=function(observer){this.observer=observer,this.element.addEventListener("keydown",this.onKeydown,!1),this.element.addEventListener("keypress",this.onKeydown,!1),this.element.addEventListener("keyup",this.onKeyup,!1),this._isEnabled=!0},__proto.dettachEvent=function(){this.element.removeEventListener("keydown",this.onKeydown,!1),this.element.removeEventListener("keypress",this.onKeydown,!1),this.element.removeEventListener("keyup",this.onKeyup,!1),this._isEnabled=!1,this.observer=null},__proto.enable=function(){return this._isEnabled=!0,this},__proto.disable=function(){return this._isEnabled=!1,this},__proto.isEnable=function(){return this._isEnabled},MoveKeyInput}(),axes_esm=axes_esm_Axes,EPSILON=1e-6,ARRAY_TYPE="undefined"!=typeof Float32Array?Float32Array:Array,RANDOM=Math.random;function setMatrixArrayType(type){ARRAY_TYPE=type}var degree=Math.PI/180;function toRadian(a){return a*degree}function equals(a,b){return Math.abs(a-b)<=EPSILON*Math.max(1,Math.abs(a),Math.abs(b))}function create(){var out=new ARRAY_TYPE(9);return ARRAY_TYPE!=Float32Array&&(out[1]=0,out[2]=0,out[3]=0,out[5]=0,out[6]=0,out[7]=0),out[0]=1,out[4]=1,out[8]=1,out}function fromMat4(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[4],out[4]=a[5],out[5]=a[6],out[6]=a[8],out[7]=a[9],out[8]=a[10],out}function clone(a){var out=new ARRAY_TYPE(9);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out}function copy(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out}function fromValues(m00,m01,m02,m10,m11,m12,m20,m21,m22){var out=new ARRAY_TYPE(9);return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m10,out[4]=m11,out[5]=m12,out[6]=m20,out[7]=m21,out[8]=m22,out}function set(out,m00,m01,m02,m10,m11,m12,m20,m21,m22){return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m10,out[4]=m11,out[5]=m12,out[6]=m20,out[7]=m21,out[8]=m22,out}function identity(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=1,out[5]=0,out[6]=0,out[7]=0,out[8]=1,out}function transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a12=a[5];out[1]=a[3],out[2]=a[6],out[3]=a01,out[5]=a[7],out[6]=a02,out[7]=a12}else out[0]=a[0],out[1]=a[3],out[2]=a[6],out[3]=a[1],out[4]=a[4],out[5]=a[7],out[6]=a[2],out[7]=a[5],out[8]=a[8];return out}function invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b01=a22*a11-a12*a21,b11=-a22*a10+a12*a20,b21=a21*a10-a11*a20,det=a00*b01+a01*b11+a02*b21;return det?(det=1/det,out[0]=b01*det,out[1]=(-a22*a01+a02*a21)*det,out[2]=(a12*a01-a02*a11)*det,out[3]=b11*det,out[4]=(a22*a00-a02*a20)*det,out[5]=(-a12*a00+a02*a10)*det,out[6]=b21*det,out[7]=(-a21*a00+a01*a20)*det,out[8]=(a11*a00-a01*a10)*det,out):null}function adjoint(out,a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];return out[0]=a11*a22-a12*a21,out[1]=a02*a21-a01*a22,out[2]=a01*a12-a02*a11,out[3]=a12*a20-a10*a22,out[4]=a00*a22-a02*a20,out[5]=a02*a10-a00*a12,out[6]=a10*a21-a11*a20,out[7]=a01*a20-a00*a21,out[8]=a00*a11-a01*a10,out}function determinant(a){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8];return a00*(a22*a11-a12*a21)+a01*(-a22*a10+a12*a20)+a02*(a21*a10-a11*a20)}function multiply(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],b00=b[0],b01=b[1],b02=b[2],b10=b[3],b11=b[4],b12=b[5],b20=b[6],b21=b[7],b22=b[8];return out[0]=b00*a00+b01*a10+b02*a20,out[1]=b00*a01+b01*a11+b02*a21,out[2]=b00*a02+b01*a12+b02*a22,out[3]=b10*a00+b11*a10+b12*a20,out[4]=b10*a01+b11*a11+b12*a21,out[5]=b10*a02+b11*a12+b12*a22,out[6]=b20*a00+b21*a10+b22*a20,out[7]=b20*a01+b21*a11+b22*a21,out[8]=b20*a02+b21*a12+b22*a22,out}function translate(out,a,v){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],x=v[0],y=v[1];return out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a10,out[4]=a11,out[5]=a12,out[6]=x*a00+y*a10+a20,out[7]=x*a01+y*a11+a21,out[8]=x*a02+y*a12+a22,out}function rotate(out,a,rad){var a00=a[0],a01=a[1],a02=a[2],a10=a[3],a11=a[4],a12=a[5],a20=a[6],a21=a[7],a22=a[8],s=Math.sin(rad),c=Math.cos(rad);return out[0]=c*a00+s*a10,out[1]=c*a01+s*a11,out[2]=c*a02+s*a12,out[3]=c*a10-s*a00,out[4]=c*a11-s*a01,out[5]=c*a12-s*a02,out[6]=a20,out[7]=a21,out[8]=a22,out}function mat3_scale(out,a,v){var x=v[0],y=v[1];return out[0]=x*a[0],out[1]=x*a[1],out[2]=x*a[2],out[3]=y*a[3],out[4]=y*a[4],out[5]=y*a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out}function fromTranslation(out,v){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=1,out[5]=0,out[6]=v[0],out[7]=v[1],out[8]=1,out}function fromRotation(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=s,out[2]=0,out[3]=-s,out[4]=c,out[5]=0,out[6]=0,out[7]=0,out[8]=1,out}function fromScaling(out,v){return out[0]=v[0],out[1]=0,out[2]=0,out[3]=0,out[4]=v[1],out[5]=0,out[6]=0,out[7]=0,out[8]=1,out}function fromMat2d(out,a){return out[0]=a[0],out[1]=a[1],out[2]=0,out[3]=a[2],out[4]=a[3],out[5]=0,out[6]=a[4],out[7]=a[5],out[8]=1,out}function fromQuat(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-yy-zz,out[3]=yx-wz,out[6]=zx+wy,out[1]=yx+wz,out[4]=1-xx-zz,out[7]=zy-wx,out[2]=zx-wy,out[5]=zy+wx,out[8]=1-xx-yy,out}function normalFromMat4(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a12*b08-a10*b11-a13*b07)*det,out[2]=(a10*b10-a11*b08+a13*b06)*det,out[3]=(a02*b10-a01*b11-a03*b09)*det,out[4]=(a00*b11-a02*b08+a03*b07)*det,out[5]=(a01*b08-a00*b10-a03*b06)*det,out[6]=(a31*b05-a32*b04+a33*b03)*det,out[7]=(a32*b02-a30*b05-a33*b01)*det,out[8]=(a30*b04-a31*b02+a33*b00)*det,out):null}function projection(out,width,height){return out[0]=2/width,out[1]=0,out[2]=0,out[3]=0,out[4]=-2/height,out[5]=0,out[6]=-1,out[7]=1,out[8]=1,out}function str(a){return"mat3("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+")"}function frob(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8])}function add(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out[4]=a[4]+b[4],out[5]=a[5]+b[5],out[6]=a[6]+b[6],out[7]=a[7]+b[7],out[8]=a[8]+b[8],out}function subtract(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out[4]=a[4]-b[4],out[5]=a[5]-b[5],out[6]=a[6]-b[6],out[7]=a[7]-b[7],out[8]=a[8]-b[8],out}function multiplyScalar(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out[4]=a[4]*b,out[5]=a[5]*b,out[6]=a[6]*b,out[7]=a[7]*b,out[8]=a[8]*b,out}function multiplyScalarAndAdd(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out[4]=a[4]+b[4]*scale,out[5]=a[5]+b[5]*scale,out[6]=a[6]+b[6]*scale,out[7]=a[7]+b[7]*scale,out[8]=a[8]+b[8]*scale,out}function exactEquals(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]}function mat3_equals(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],a6=a[6],a7=a[7],a8=a[8],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5],b6=b[6],b7=b[7],b8=b[8];return Math.abs(a0-b0)<=EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))&&Math.abs(a4-b4)<=EPSILON*Math.max(1,Math.abs(a4),Math.abs(b4))&&Math.abs(a5-b5)<=EPSILON*Math.max(1,Math.abs(a5),Math.abs(b5))&&Math.abs(a6-b6)<=EPSILON*Math.max(1,Math.abs(a6),Math.abs(b6))&&Math.abs(a7-b7)<=EPSILON*Math.max(1,Math.abs(a7),Math.abs(b7))&&Math.abs(a8-b8)<=EPSILON*Math.max(1,Math.abs(a8),Math.abs(b8))}Math.hypot||(Math.hypot=function(){for(var y=0,i=arguments.length;i--;)y+=arguments[i]*arguments[i];return Math.sqrt(y)});var mul=multiply,sub=subtract;function mat4_create(){var out=new ARRAY_TYPE(16);return ARRAY_TYPE!=Float32Array&&(out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[11]=0,out[12]=0,out[13]=0,out[14]=0),out[0]=1,out[5]=1,out[10]=1,out[15]=1,out}function mat4_clone(a){var out=new ARRAY_TYPE(16);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}function mat4_copy(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}function mat4_fromValues(m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33){var out=new ARRAY_TYPE(16);return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m03,out[4]=m10,out[5]=m11,out[6]=m12,out[7]=m13,out[8]=m20,out[9]=m21,out[10]=m22,out[11]=m23,out[12]=m30,out[13]=m31,out[14]=m32,out[15]=m33,out}function mat4_set(out,m00,m01,m02,m03,m10,m11,m12,m13,m20,m21,m22,m23,m30,m31,m32,m33){return out[0]=m00,out[1]=m01,out[2]=m02,out[3]=m03,out[4]=m10,out[5]=m11,out[6]=m12,out[7]=m13,out[8]=m20,out[9]=m21,out[10]=m22,out[11]=m23,out[12]=m30,out[13]=m31,out[14]=m32,out[15]=m33,out}function mat4_identity(out){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}function mat4_transpose(out,a){if(out===a){var a01=a[1],a02=a[2],a03=a[3],a12=a[6],a13=a[7],a23=a[11];out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a01,out[6]=a[9],out[7]=a[13],out[8]=a02,out[9]=a12,out[11]=a[14],out[12]=a03,out[13]=a13,out[14]=a23}else out[0]=a[0],out[1]=a[4],out[2]=a[8],out[3]=a[12],out[4]=a[1],out[5]=a[5],out[6]=a[9],out[7]=a[13],out[8]=a[2],out[9]=a[6],out[10]=a[10],out[11]=a[14],out[12]=a[3],out[13]=a[7],out[14]=a[11],out[15]=a[15];return out}function mat4_invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a02*b10-a01*b11-a03*b09)*det,out[2]=(a31*b05-a32*b04+a33*b03)*det,out[3]=(a22*b04-a21*b05-a23*b03)*det,out[4]=(a12*b08-a10*b11-a13*b07)*det,out[5]=(a00*b11-a02*b08+a03*b07)*det,out[6]=(a32*b02-a30*b05-a33*b01)*det,out[7]=(a20*b05-a22*b02+a23*b01)*det,out[8]=(a10*b10-a11*b08+a13*b06)*det,out[9]=(a01*b08-a00*b10-a03*b06)*det,out[10]=(a30*b04-a31*b02+a33*b00)*det,out[11]=(a21*b02-a20*b04-a23*b00)*det,out[12]=(a11*b07-a10*b09-a12*b06)*det,out[13]=(a00*b09-a01*b07+a02*b06)*det,out[14]=(a31*b01-a30*b03-a32*b00)*det,out[15]=(a20*b03-a21*b01+a22*b00)*det,out):null}function mat4_adjoint(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];return out[0]=a11*(a22*a33-a23*a32)-a21*(a12*a33-a13*a32)+a31*(a12*a23-a13*a22),out[1]=-(a01*(a22*a33-a23*a32)-a21*(a02*a33-a03*a32)+a31*(a02*a23-a03*a22)),out[2]=a01*(a12*a33-a13*a32)-a11*(a02*a33-a03*a32)+a31*(a02*a13-a03*a12),out[3]=-(a01*(a12*a23-a13*a22)-a11*(a02*a23-a03*a22)+a21*(a02*a13-a03*a12)),out[4]=-(a10*(a22*a33-a23*a32)-a20*(a12*a33-a13*a32)+a30*(a12*a23-a13*a22)),out[5]=a00*(a22*a33-a23*a32)-a20*(a02*a33-a03*a32)+a30*(a02*a23-a03*a22),out[6]=-(a00*(a12*a33-a13*a32)-a10*(a02*a33-a03*a32)+a30*(a02*a13-a03*a12)),out[7]=a00*(a12*a23-a13*a22)-a10*(a02*a23-a03*a22)+a20*(a02*a13-a03*a12),out[8]=a10*(a21*a33-a23*a31)-a20*(a11*a33-a13*a31)+a30*(a11*a23-a13*a21),out[9]=-(a00*(a21*a33-a23*a31)-a20*(a01*a33-a03*a31)+a30*(a01*a23-a03*a21)),out[10]=a00*(a11*a33-a13*a31)-a10*(a01*a33-a03*a31)+a30*(a01*a13-a03*a11),out[11]=-(a00*(a11*a23-a13*a21)-a10*(a01*a23-a03*a21)+a20*(a01*a13-a03*a11)),out[12]=-(a10*(a21*a32-a22*a31)-a20*(a11*a32-a12*a31)+a30*(a11*a22-a12*a21)),out[13]=a00*(a21*a32-a22*a31)-a20*(a01*a32-a02*a31)+a30*(a01*a22-a02*a21),out[14]=-(a00*(a11*a32-a12*a31)-a10*(a01*a32-a02*a31)+a30*(a01*a12-a02*a11)),out[15]=a00*(a11*a22-a12*a21)-a10*(a01*a22-a02*a21)+a20*(a01*a12-a02*a11),out}function mat4_determinant(a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15];return(a00*a11-a01*a10)*(a22*a33-a23*a32)-(a00*a12-a02*a10)*(a21*a33-a23*a31)+(a00*a13-a03*a10)*(a21*a32-a22*a31)+(a01*a12-a02*a11)*(a20*a33-a23*a30)-(a01*a13-a03*a11)*(a20*a32-a22*a30)+(a02*a13-a03*a12)*(a20*a31-a21*a30)}function mat4_multiply(out,a,b){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return out[0]=b0*a00+b1*a10+b2*a20+b3*a30,out[1]=b0*a01+b1*a11+b2*a21+b3*a31,out[2]=b0*a02+b1*a12+b2*a22+b3*a32,out[3]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[4],b1=b[5],b2=b[6],b3=b[7],out[4]=b0*a00+b1*a10+b2*a20+b3*a30,out[5]=b0*a01+b1*a11+b2*a21+b3*a31,out[6]=b0*a02+b1*a12+b2*a22+b3*a32,out[7]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[8],b1=b[9],b2=b[10],b3=b[11],out[8]=b0*a00+b1*a10+b2*a20+b3*a30,out[9]=b0*a01+b1*a11+b2*a21+b3*a31,out[10]=b0*a02+b1*a12+b2*a22+b3*a32,out[11]=b0*a03+b1*a13+b2*a23+b3*a33,b0=b[12],b1=b[13],b2=b[14],b3=b[15],out[12]=b0*a00+b1*a10+b2*a20+b3*a30,out[13]=b0*a01+b1*a11+b2*a21+b3*a31,out[14]=b0*a02+b1*a12+b2*a22+b3*a32,out[15]=b0*a03+b1*a13+b2*a23+b3*a33,out}function mat4_translate(out,a,v){var a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,x=v[0],y=v[1],z=v[2];return a===out?(out[12]=a[0]*x+a[4]*y+a[8]*z+a[12],out[13]=a[1]*x+a[5]*y+a[9]*z+a[13],out[14]=a[2]*x+a[6]*y+a[10]*z+a[14],out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]):(a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a03,out[4]=a10,out[5]=a11,out[6]=a12,out[7]=a13,out[8]=a20,out[9]=a21,out[10]=a22,out[11]=a23,out[12]=a00*x+a10*y+a20*z+a[12],out[13]=a01*x+a11*y+a21*z+a[13],out[14]=a02*x+a12*y+a22*z+a[14],out[15]=a03*x+a13*y+a23*z+a[15]),out}function mat4_scale(out,a,v){var x=v[0],y=v[1],z=v[2];return out[0]=a[0]*x,out[1]=a[1]*x,out[2]=a[2]*x,out[3]=a[3]*x,out[4]=a[4]*y,out[5]=a[5]*y,out[6]=a[6]*y,out[7]=a[7]*y,out[8]=a[8]*z,out[9]=a[9]*z,out[10]=a[10]*z,out[11]=a[11]*z,out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15],out}function mat4_rotate(out,a,rad,axis){var s,c,t,a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,b00,b01,b02,b10,b11,b12,b20,b21,b22,x=axis[0],y=axis[1],z=axis[2],len=Math.hypot(x,y,z);return len<EPSILON?null:(x*=len=1/len,y*=len,z*=len,s=Math.sin(rad),t=1-(c=Math.cos(rad)),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],b00=x*x*t+c,b01=y*x*t+z*s,b02=z*x*t-y*s,b10=x*y*t-z*s,b11=y*y*t+c,b12=z*y*t+x*s,b20=x*z*t+y*s,b21=y*z*t-x*s,b22=z*z*t+c,out[0]=a00*b00+a10*b01+a20*b02,out[1]=a01*b00+a11*b01+a21*b02,out[2]=a02*b00+a12*b01+a22*b02,out[3]=a03*b00+a13*b01+a23*b02,out[4]=a00*b10+a10*b11+a20*b12,out[5]=a01*b10+a11*b11+a21*b12,out[6]=a02*b10+a12*b11+a22*b12,out[7]=a03*b10+a13*b11+a23*b12,out[8]=a00*b20+a10*b21+a20*b22,out[9]=a01*b20+a11*b21+a21*b22,out[10]=a02*b20+a12*b21+a22*b22,out[11]=a03*b20+a13*b21+a23*b22,a!==out&&(out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out)}function rotateX(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a!==out&&(out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[4]=a10*c+a20*s,out[5]=a11*c+a21*s,out[6]=a12*c+a22*s,out[7]=a13*c+a23*s,out[8]=a20*c-a10*s,out[9]=a21*c-a11*s,out[10]=a22*c-a12*s,out[11]=a23*c-a13*s,out}function rotateY(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a20=a[8],a21=a[9],a22=a[10],a23=a[11];return a!==out&&(out[4]=a[4],out[5]=a[5],out[6]=a[6],out[7]=a[7],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[0]=a00*c-a20*s,out[1]=a01*c-a21*s,out[2]=a02*c-a22*s,out[3]=a03*c-a23*s,out[8]=a00*s+a20*c,out[9]=a01*s+a21*c,out[10]=a02*s+a22*c,out[11]=a03*s+a23*c,out}function rotateZ(out,a,rad){var s=Math.sin(rad),c=Math.cos(rad),a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7];return a!==out&&(out[8]=a[8],out[9]=a[9],out[10]=a[10],out[11]=a[11],out[12]=a[12],out[13]=a[13],out[14]=a[14],out[15]=a[15]),out[0]=a00*c+a10*s,out[1]=a01*c+a11*s,out[2]=a02*c+a12*s,out[3]=a03*c+a13*s,out[4]=a10*c-a00*s,out[5]=a11*c-a01*s,out[6]=a12*c-a02*s,out[7]=a13*c-a03*s,out}function mat4_fromTranslation(out,v){return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out}function mat4_fromScaling(out,v){return out[0]=v[0],out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=v[1],out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=v[2],out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}function mat4_fromRotation(out,rad,axis){var s,c,t,x=axis[0],y=axis[1],z=axis[2],len=Math.hypot(x,y,z);return len<EPSILON?null:(x*=len=1/len,y*=len,z*=len,s=Math.sin(rad),t=1-(c=Math.cos(rad)),out[0]=x*x*t+c,out[1]=y*x*t+z*s,out[2]=z*x*t-y*s,out[3]=0,out[4]=x*y*t-z*s,out[5]=y*y*t+c,out[6]=z*y*t+x*s,out[7]=0,out[8]=x*z*t+y*s,out[9]=y*z*t-x*s,out[10]=z*z*t+c,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out)}function fromXRotation(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=1,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=c,out[6]=s,out[7]=0,out[8]=0,out[9]=-s,out[10]=c,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}function fromYRotation(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=0,out[2]=-s,out[3]=0,out[4]=0,out[5]=1,out[6]=0,out[7]=0,out[8]=s,out[9]=0,out[10]=c,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}function fromZRotation(out,rad){var s=Math.sin(rad),c=Math.cos(rad);return out[0]=c,out[1]=s,out[2]=0,out[3]=0,out[4]=-s,out[5]=c,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=1,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}function fromRotationTranslation(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-(yy+zz),out[1]=xy+wz,out[2]=xz-wy,out[3]=0,out[4]=xy-wz,out[5]=1-(xx+zz),out[6]=yz+wx,out[7]=0,out[8]=xz+wy,out[9]=yz-wx,out[10]=1-(xx+yy),out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out}function fromQuat2(out,a){var translation=new ARRAY_TYPE(3),bx=-a[0],by=-a[1],bz=-a[2],bw=a[3],ax=a[4],ay=a[5],az=a[6],aw=a[7],magnitude=bx*bx+by*by+bz*bz+bw*bw;return magnitude>0?(translation[0]=2*(ax*bw+aw*bx+ay*bz-az*by)/magnitude,translation[1]=2*(ay*bw+aw*by+az*bx-ax*bz)/magnitude,translation[2]=2*(az*bw+aw*bz+ax*by-ay*bx)/magnitude):(translation[0]=2*(ax*bw+aw*bx+ay*bz-az*by),translation[1]=2*(ay*bw+aw*by+az*bx-ax*bz),translation[2]=2*(az*bw+aw*bz+ax*by-ay*bx)),fromRotationTranslation(out,a,translation),out}function getTranslation(out,mat){return out[0]=mat[12],out[1]=mat[13],out[2]=mat[14],out}function getScaling(out,mat){var m11=mat[0],m12=mat[1],m13=mat[2],m21=mat[4],m22=mat[5],m23=mat[6],m31=mat[8],m32=mat[9],m33=mat[10];return out[0]=Math.hypot(m11,m12,m13),out[1]=Math.hypot(m21,m22,m23),out[2]=Math.hypot(m31,m32,m33),out}function mat4_getRotation(out,mat){var scaling=new ARRAY_TYPE(3);getScaling(scaling,mat);var is1=1/scaling[0],is2=1/scaling[1],is3=1/scaling[2],sm11=mat[0]*is1,sm12=mat[1]*is2,sm13=mat[2]*is3,sm21=mat[4]*is1,sm22=mat[5]*is2,sm23=mat[6]*is3,sm31=mat[8]*is1,sm32=mat[9]*is2,sm33=mat[10]*is3,trace=sm11+sm22+sm33,S=0;return trace>0?(S=2*Math.sqrt(trace+1),out[3]=.25*S,out[0]=(sm23-sm32)/S,out[1]=(sm31-sm13)/S,out[2]=(sm12-sm21)/S):sm11>sm22&&sm11>sm33?(S=2*Math.sqrt(1+sm11-sm22-sm33),out[3]=(sm23-sm32)/S,out[0]=.25*S,out[1]=(sm12+sm21)/S,out[2]=(sm31+sm13)/S):sm22>sm33?(S=2*Math.sqrt(1+sm22-sm11-sm33),out[3]=(sm31-sm13)/S,out[0]=(sm12+sm21)/S,out[1]=.25*S,out[2]=(sm23+sm32)/S):(S=2*Math.sqrt(1+sm33-sm11-sm22),out[3]=(sm12-sm21)/S,out[0]=(sm31+sm13)/S,out[1]=(sm23+sm32)/S,out[2]=.25*S),out}function fromRotationTranslationScale(out,q,v,s){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2,sx=s[0],sy=s[1],sz=s[2];return out[0]=(1-(yy+zz))*sx,out[1]=(xy+wz)*sx,out[2]=(xz-wy)*sx,out[3]=0,out[4]=(xy-wz)*sy,out[5]=(1-(xx+zz))*sy,out[6]=(yz+wx)*sy,out[7]=0,out[8]=(xz+wy)*sz,out[9]=(yz-wx)*sz,out[10]=(1-(xx+yy))*sz,out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out}function fromRotationTranslationScaleOrigin(out,q,v,s,o){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2,sx=s[0],sy=s[1],sz=s[2],ox=o[0],oy=o[1],oz=o[2],out0=(1-(yy+zz))*sx,out1=(xy+wz)*sx,out2=(xz-wy)*sx,out4=(xy-wz)*sy,out5=(1-(xx+zz))*sy,out6=(yz+wx)*sy,out8=(xz+wy)*sz,out9=(yz-wx)*sz,out10=(1-(xx+yy))*sz;return out[0]=out0,out[1]=out1,out[2]=out2,out[3]=0,out[4]=out4,out[5]=out5,out[6]=out6,out[7]=0,out[8]=out8,out[9]=out9,out[10]=out10,out[11]=0,out[12]=v[0]+ox-(out0*ox+out4*oy+out8*oz),out[13]=v[1]+oy-(out1*ox+out5*oy+out9*oz),out[14]=v[2]+oz-(out2*ox+out6*oy+out10*oz),out[15]=1,out}function mat4_fromQuat(out,q){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,yx=y*x2,yy=y*y2,zx=z*x2,zy=z*y2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-yy-zz,out[1]=yx+wz,out[2]=zx-wy,out[3]=0,out[4]=yx-wz,out[5]=1-xx-zz,out[6]=zy+wx,out[7]=0,out[8]=zx+wy,out[9]=zy-wx,out[10]=1-xx-yy,out[11]=0,out[12]=0,out[13]=0,out[14]=0,out[15]=1,out}function frustum(out,left,right,bottom,top,near,far){var rl=1/(right-left),tb=1/(top-bottom),nf=1/(near-far);return out[0]=2*near*rl,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=2*near*tb,out[6]=0,out[7]=0,out[8]=(right+left)*rl,out[9]=(top+bottom)*tb,out[10]=(far+near)*nf,out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near*2*nf,out[15]=0,out}function perspective(out,fovy,aspect,near,far){var nf,f=1/Math.tan(fovy/2);return out[0]=f/aspect,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=f,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[11]=-1,out[12]=0,out[13]=0,out[15]=0,null!=far&&far!==1/0?(nf=1/(near-far),out[10]=(far+near)*nf,out[14]=2*far*near*nf):(out[10]=-1,out[14]=-2*near),out}function perspectiveFromFieldOfView(out,fov,near,far){var upTan=Math.tan(fov.upDegrees*Math.PI/180),downTan=Math.tan(fov.downDegrees*Math.PI/180),leftTan=Math.tan(fov.leftDegrees*Math.PI/180),rightTan=Math.tan(fov.rightDegrees*Math.PI/180),xScale=2/(leftTan+rightTan),yScale=2/(upTan+downTan);return out[0]=xScale,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=yScale,out[6]=0,out[7]=0,out[8]=-(leftTan-rightTan)*xScale*.5,out[9]=(upTan-downTan)*yScale*.5,out[10]=far/(near-far),out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near/(near-far),out[15]=0,out}function ortho(out,left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);return out[0]=-2*lr,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=-2*bt,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=2*nf,out[11]=0,out[12]=(left+right)*lr,out[13]=(top+bottom)*bt,out[14]=(far+near)*nf,out[15]=1,out}function lookAt(out,eye,center,up){var x0,x1,x2,y0,y1,y2,z0,z1,z2,len,eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],centerx=center[0],centery=center[1],centerz=center[2];return Math.abs(eyex-centerx)<EPSILON&&Math.abs(eyey-centery)<EPSILON&&Math.abs(eyez-centerz)<EPSILON?mat4_identity(out):(z0=eyex-centerx,z1=eyey-centery,z2=eyez-centerz,x0=upy*(z2*=len=1/Math.hypot(z0,z1,z2))-upz*(z1*=len),x1=upz*(z0*=len)-upx*z2,x2=upx*z1-upy*z0,(len=Math.hypot(x0,x1,x2))?(x0*=len=1/len,x1*=len,x2*=len):(x0=0,x1=0,x2=0),y0=z1*x2-z2*x1,y1=z2*x0-z0*x2,y2=z0*x1-z1*x0,(len=Math.hypot(y0,y1,y2))?(y0*=len=1/len,y1*=len,y2*=len):(y0=0,y1=0,y2=0),out[0]=x0,out[1]=y0,out[2]=z0,out[3]=0,out[4]=x1,out[5]=y1,out[6]=z1,out[7]=0,out[8]=x2,out[9]=y2,out[10]=z2,out[11]=0,out[12]=-(x0*eyex+x1*eyey+x2*eyez),out[13]=-(y0*eyex+y1*eyey+y2*eyez),out[14]=-(z0*eyex+z1*eyey+z2*eyez),out[15]=1,out)}function targetTo(out,eye,target,up){var eyex=eye[0],eyey=eye[1],eyez=eye[2],upx=up[0],upy=up[1],upz=up[2],z0=eyex-target[0],z1=eyey-target[1],z2=eyez-target[2],len=z0*z0+z1*z1+z2*z2;len>0&&(z0*=len=1/Math.sqrt(len),z1*=len,z2*=len);var x0=upy*z2-upz*z1,x1=upz*z0-upx*z2,x2=upx*z1-upy*z0;return(len=x0*x0+x1*x1+x2*x2)>0&&(x0*=len=1/Math.sqrt(len),x1*=len,x2*=len),out[0]=x0,out[1]=x1,out[2]=x2,out[3]=0,out[4]=z1*x2-z2*x1,out[5]=z2*x0-z0*x2,out[6]=z0*x1-z1*x0,out[7]=0,out[8]=z0,out[9]=z1,out[10]=z2,out[11]=0,out[12]=eyex,out[13]=eyey,out[14]=eyez,out[15]=1,out}function mat4_str(a){return"mat4("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+", "+a[6]+", "+a[7]+", "+a[8]+", "+a[9]+", "+a[10]+", "+a[11]+", "+a[12]+", "+a[13]+", "+a[14]+", "+a[15]+")"}function mat4_frob(a){return Math.hypot(a[0],a[1],a[2],a[3],a[4],a[5],a[6],a[7],a[8],a[9],a[10],a[11],a[12],a[13],a[14],a[15])}function mat4_add(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out[4]=a[4]+b[4],out[5]=a[5]+b[5],out[6]=a[6]+b[6],out[7]=a[7]+b[7],out[8]=a[8]+b[8],out[9]=a[9]+b[9],out[10]=a[10]+b[10],out[11]=a[11]+b[11],out[12]=a[12]+b[12],out[13]=a[13]+b[13],out[14]=a[14]+b[14],out[15]=a[15]+b[15],out}function mat4_subtract(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out[3]=a[3]-b[3],out[4]=a[4]-b[4],out[5]=a[5]-b[5],out[6]=a[6]-b[6],out[7]=a[7]-b[7],out[8]=a[8]-b[8],out[9]=a[9]-b[9],out[10]=a[10]-b[10],out[11]=a[11]-b[11],out[12]=a[12]-b[12],out[13]=a[13]-b[13],out[14]=a[14]-b[14],out[15]=a[15]-b[15],out}function mat4_multiplyScalar(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out[4]=a[4]*b,out[5]=a[5]*b,out[6]=a[6]*b,out[7]=a[7]*b,out[8]=a[8]*b,out[9]=a[9]*b,out[10]=a[10]*b,out[11]=a[11]*b,out[12]=a[12]*b,out[13]=a[13]*b,out[14]=a[14]*b,out[15]=a[15]*b,out}function mat4_multiplyScalarAndAdd(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out[3]=a[3]+b[3]*scale,out[4]=a[4]+b[4]*scale,out[5]=a[5]+b[5]*scale,out[6]=a[6]+b[6]*scale,out[7]=a[7]+b[7]*scale,out[8]=a[8]+b[8]*scale,out[9]=a[9]+b[9]*scale,out[10]=a[10]+b[10]*scale,out[11]=a[11]+b[11]*scale,out[12]=a[12]+b[12]*scale,out[13]=a[13]+b[13]*scale,out[14]=a[14]+b[14]*scale,out[15]=a[15]+b[15]*scale,out}function mat4_exactEquals(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===b[5]&&a[6]===b[6]&&a[7]===b[7]&&a[8]===b[8]&&a[9]===b[9]&&a[10]===b[10]&&a[11]===b[11]&&a[12]===b[12]&&a[13]===b[13]&&a[14]===b[14]&&a[15]===b[15]}function mat4_equals(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],a4=a[4],a5=a[5],a6=a[6],a7=a[7],a8=a[8],a9=a[9],a10=a[10],a11=a[11],a12=a[12],a13=a[13],a14=a[14],a15=a[15],b0=b[0],b1=b[1],b2=b[2],b3=b[3],b4=b[4],b5=b[5],b6=b[6],b7=b[7],b8=b[8],b9=b[9],b10=b[10],b11=b[11],b12=b[12],b13=b[13],b14=b[14],b15=b[15];return Math.abs(a0-b0)<=EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))&&Math.abs(a4-b4)<=EPSILON*Math.max(1,Math.abs(a4),Math.abs(b4))&&Math.abs(a5-b5)<=EPSILON*Math.max(1,Math.abs(a5),Math.abs(b5))&&Math.abs(a6-b6)<=EPSILON*Math.max(1,Math.abs(a6),Math.abs(b6))&&Math.abs(a7-b7)<=EPSILON*Math.max(1,Math.abs(a7),Math.abs(b7))&&Math.abs(a8-b8)<=EPSILON*Math.max(1,Math.abs(a8),Math.abs(b8))&&Math.abs(a9-b9)<=EPSILON*Math.max(1,Math.abs(a9),Math.abs(b9))&&Math.abs(a10-b10)<=EPSILON*Math.max(1,Math.abs(a10),Math.abs(b10))&&Math.abs(a11-b11)<=EPSILON*Math.max(1,Math.abs(a11),Math.abs(b11))&&Math.abs(a12-b12)<=EPSILON*Math.max(1,Math.abs(a12),Math.abs(b12))&&Math.abs(a13-b13)<=EPSILON*Math.max(1,Math.abs(a13),Math.abs(b13))&&Math.abs(a14-b14)<=EPSILON*Math.max(1,Math.abs(a14),Math.abs(b14))&&Math.abs(a15-b15)<=EPSILON*Math.max(1,Math.abs(a15),Math.abs(b15))}var mat4_mul=mat4_multiply,mat4_sub=mat4_subtract;function vec3_create(){var out=new ARRAY_TYPE(3);return ARRAY_TYPE!=Float32Array&&(out[0]=0,out[1]=0,out[2]=0),out}function vec3_clone(a){var out=new ARRAY_TYPE(3);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out}function vec3_length(a){var x=a[0],y=a[1],z=a[2];return Math.hypot(x,y,z)}function vec3_fromValues(x,y,z){var out=new ARRAY_TYPE(3);return out[0]=x,out[1]=y,out[2]=z,out}function vec3_copy(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out}function vec3_set(out,x,y,z){return out[0]=x,out[1]=y,out[2]=z,out}function vec3_add(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out}function vec3_subtract(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out[2]=a[2]-b[2],out}function vec3_multiply(out,a,b){return out[0]=a[0]*b[0],out[1]=a[1]*b[1],out[2]=a[2]*b[2],out}function divide(out,a,b){return out[0]=a[0]/b[0],out[1]=a[1]/b[1],out[2]=a[2]/b[2],out}function ceil(out,a){return out[0]=Math.ceil(a[0]),out[1]=Math.ceil(a[1]),out[2]=Math.ceil(a[2]),out}function floor(out,a){return out[0]=Math.floor(a[0]),out[1]=Math.floor(a[1]),out[2]=Math.floor(a[2]),out}function min(out,a,b){return out[0]=Math.min(a[0],b[0]),out[1]=Math.min(a[1],b[1]),out[2]=Math.min(a[2],b[2]),out}function max(out,a,b){return out[0]=Math.max(a[0],b[0]),out[1]=Math.max(a[1],b[1]),out[2]=Math.max(a[2],b[2]),out}function vec3_round(out,a){return out[0]=Math.round(a[0]),out[1]=Math.round(a[1]),out[2]=Math.round(a[2]),out}function vec3_scale(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out}function scaleAndAdd(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out[2]=a[2]+b[2]*scale,out}function vec3_distance(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2];return Math.hypot(x,y,z)}function squaredDistance(a,b){var x=b[0]-a[0],y=b[1]-a[1],z=b[2]-a[2];return x*x+y*y+z*z}function squaredLength(a){var x=a[0],y=a[1],z=a[2];return x*x+y*y+z*z}function negate(out,a){return out[0]=-a[0],out[1]=-a[1],out[2]=-a[2],out}function inverse(out,a){return out[0]=1/a[0],out[1]=1/a[1],out[2]=1/a[2],out}function normalize(out,a){var x=a[0],y=a[1],z=a[2],len=x*x+y*y+z*z;return len>0&&(len=1/Math.sqrt(len)),out[0]=a[0]*len,out[1]=a[1]*len,out[2]=a[2]*len,out}function vec3_dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]}function cross(out,a,b){var ax=a[0],ay=a[1],az=a[2],bx=b[0],by=b[1],bz=b[2];return out[0]=ay*bz-az*by,out[1]=az*bx-ax*bz,out[2]=ax*by-ay*bx,out}function lerp(out,a,b,t){var ax=a[0],ay=a[1],az=a[2];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out[2]=az+t*(b[2]-az),out}function hermite(out,a,b,c,d,t){var factorTimes2=t*t,factor1=factorTimes2*(2*t-3)+1,factor2=factorTimes2*(t-2)+t,factor3=factorTimes2*(t-1),factor4=factorTimes2*(3-2*t);return out[0]=a[0]*factor1+b[0]*factor2+c[0]*factor3+d[0]*factor4,out[1]=a[1]*factor1+b[1]*factor2+c[1]*factor3+d[1]*factor4,out[2]=a[2]*factor1+b[2]*factor2+c[2]*factor3+d[2]*factor4,out}function bezier(out,a,b,c,d,t){var inverseFactor=1-t,inverseFactorTimesTwo=inverseFactor*inverseFactor,factorTimes2=t*t,factor1=inverseFactorTimesTwo*inverseFactor,factor2=3*t*inverseFactorTimesTwo,factor3=3*factorTimes2*inverseFactor,factor4=factorTimes2*t;return out[0]=a[0]*factor1+b[0]*factor2+c[0]*factor3+d[0]*factor4,out[1]=a[1]*factor1+b[1]*factor2+c[1]*factor3+d[1]*factor4,out[2]=a[2]*factor1+b[2]*factor2+c[2]*factor3+d[2]*factor4,out}function random(out,scale){scale=scale||1;var r=2*RANDOM()*Math.PI,z=2*RANDOM()-1,zScale=Math.sqrt(1-z*z)*scale;return out[0]=Math.cos(r)*zScale,out[1]=Math.sin(r)*zScale,out[2]=z*scale,out}function transformMat4(out,a,m){var x=a[0],y=a[1],z=a[2],w=m[3]*x+m[7]*y+m[11]*z+m[15];return w=w||1,out[0]=(m[0]*x+m[4]*y+m[8]*z+m[12])/w,out[1]=(m[1]*x+m[5]*y+m[9]*z+m[13])/w,out[2]=(m[2]*x+m[6]*y+m[10]*z+m[14])/w,out}function transformMat3(out,a,m){var x=a[0],y=a[1],z=a[2];return out[0]=x*m[0]+y*m[3]+z*m[6],out[1]=x*m[1]+y*m[4]+z*m[7],out[2]=x*m[2]+y*m[5]+z*m[8],out}function transformQuat(out,a,q){var qx=q[0],qy=q[1],qz=q[2],qw=q[3],x=a[0],y=a[1],z=a[2],uvx=qy*z-qz*y,uvy=qz*x-qx*z,uvz=qx*y-qy*x,uuvx=qy*uvz-qz*uvy,uuvy=qz*uvx-qx*uvz,uuvz=qx*uvy-qy*uvx,w2=2*qw;return uvx*=w2,uvy*=w2,uvz*=w2,uuvx*=2,uuvy*=2,uuvz*=2,out[0]=x+uvx+uuvx,out[1]=y+uvy+uuvy,out[2]=z+uvz+uuvz,out}function vec3_rotateX(out,a,b,rad){var p=[],r=[];return p[0]=a[0]-b[0],p[1]=a[1]-b[1],p[2]=a[2]-b[2],r[0]=p[0],r[1]=p[1]*Math.cos(rad)-p[2]*Math.sin(rad),r[2]=p[1]*Math.sin(rad)+p[2]*Math.cos(rad),out[0]=r[0]+b[0],out[1]=r[1]+b[1],out[2]=r[2]+b[2],out}function vec3_rotateY(out,a,b,rad){var p=[],r=[];return p[0]=a[0]-b[0],p[1]=a[1]-b[1],p[2]=a[2]-b[2],r[0]=p[2]*Math.sin(rad)+p[0]*Math.cos(rad),r[1]=p[1],r[2]=p[2]*Math.cos(rad)-p[0]*Math.sin(rad),out[0]=r[0]+b[0],out[1]=r[1]+b[1],out[2]=r[2]+b[2],out}function vec3_rotateZ(out,a,b,rad){var p=[],r=[];return p[0]=a[0]-b[0],p[1]=a[1]-b[1],p[2]=a[2]-b[2],r[0]=p[0]*Math.cos(rad)-p[1]*Math.sin(rad),r[1]=p[0]*Math.sin(rad)+p[1]*Math.cos(rad),r[2]=p[2],out[0]=r[0]+b[0],out[1]=r[1]+b[1],out[2]=r[2]+b[2],out}function vec3_angle(a,b){var ax=a[0],ay=a[1],az=a[2],bx=b[0],by=b[1],bz=b[2],mag=Math.sqrt(ax*ax+ay*ay+az*az)*Math.sqrt(bx*bx+by*by+bz*bz),cosine=mag&&vec3_dot(a,b)/mag;return Math.acos(Math.min(Math.max(cosine,-1),1))}function zero(out){return out[0]=0,out[1]=0,out[2]=0,out}function vec3_str(a){return"vec3("+a[0]+", "+a[1]+", "+a[2]+")"}function vec3_exactEquals(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]}function vec3_equals(a,b){var a0=a[0],a1=a[1],a2=a[2],b0=b[0],b1=b[1],b2=b[2];return Math.abs(a0-b0)<=EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))}var vec,vec3_sub=vec3_subtract,vec3_mul=vec3_multiply,div=divide,dist=vec3_distance,sqrDist=squaredDistance,vec3_len=vec3_length,sqrLen=squaredLength,forEach=(vec=vec3_create(),function(a,stride,offset,count,fn,arg){var i,l;for(stride||(stride=3),offset||(offset=0),l=count?Math.min(count*stride+offset,a.length):a.length,i=offset;i<l;i+=stride)vec[0]=a[i],vec[1]=a[i+1],vec[2]=a[i+2],fn(vec,vec,arg),a[i]=vec[0],a[i+1]=vec[1],a[i+2]=vec[2];return a});function vec4_length(a){var x=a[0],y=a[1],z=a[2],w=a[3];return Math.hypot(x,y,z,w)}function vec4_squaredLength(a){var x=a[0],y=a[1],z=a[2],w=a[3];return x*x+y*y+z*z+w*w}!function(){var vec=function vec4_create(){var out=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(out[0]=0,out[1]=0,out[2]=0,out[3]=0),out}()}();function quat_create(){var out=new ARRAY_TYPE(4);return ARRAY_TYPE!=Float32Array&&(out[0]=0,out[1]=0,out[2]=0),out[3]=1,out}function quat_identity(out){return out[0]=0,out[1]=0,out[2]=0,out[3]=1,out}function setAxisAngle(out,axis,rad){rad*=.5;var s=Math.sin(rad);return out[0]=s*axis[0],out[1]=s*axis[1],out[2]=s*axis[2],out[3]=Math.cos(rad),out}function getAxisAngle(out_axis,q){var rad=2*Math.acos(q[3]),s=Math.sin(rad/2);return s>EPSILON?(out_axis[0]=q[0]/s,out_axis[1]=q[1]/s,out_axis[2]=q[2]/s):(out_axis[0]=1,out_axis[1]=0,out_axis[2]=0),rad}function quat_getAngle(a,b){var dotproduct=quat_dot(a,b);return Math.acos(2*dotproduct*dotproduct-1)}function quat_multiply(out,a,b){var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];return out[0]=ax*bw+aw*bx+ay*bz-az*by,out[1]=ay*bw+aw*by+az*bx-ax*bz,out[2]=az*bw+aw*bz+ax*by-ay*bx,out[3]=aw*bw-ax*bx-ay*by-az*bz,out}function quat_rotateX(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=Math.sin(rad),bw=Math.cos(rad);return out[0]=ax*bw+aw*bx,out[1]=ay*bw+az*bx,out[2]=az*bw-ay*bx,out[3]=aw*bw-ax*bx,out}function quat_rotateY(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],by=Math.sin(rad),bw=Math.cos(rad);return out[0]=ax*bw-az*by,out[1]=ay*bw+aw*by,out[2]=az*bw+ax*by,out[3]=aw*bw-ay*by,out}function quat_rotateZ(out,a,rad){rad*=.5;var ax=a[0],ay=a[1],az=a[2],aw=a[3],bz=Math.sin(rad),bw=Math.cos(rad);return out[0]=ax*bw+ay*bz,out[1]=ay*bw-ax*bz,out[2]=az*bw+aw*bz,out[3]=aw*bw-az*bz,out}function calculateW(out,a){var x=a[0],y=a[1],z=a[2];return out[0]=x,out[1]=y,out[2]=z,out[3]=Math.sqrt(Math.abs(1-x*x-y*y-z*z)),out}function exp(out,a){var x=a[0],y=a[1],z=a[2],w=a[3],r=Math.sqrt(x*x+y*y+z*z),et=Math.exp(w),s=r>0?et*Math.sin(r)/r:0;return out[0]=x*s,out[1]=y*s,out[2]=z*s,out[3]=et*Math.cos(r),out}function ln(out,a){var x=a[0],y=a[1],z=a[2],w=a[3],r=Math.sqrt(x*x+y*y+z*z),t=r>0?Math.atan2(r,w)/r:0;return out[0]=x*t,out[1]=y*t,out[2]=z*t,out[3]=.5*Math.log(x*x+y*y+z*z+w*w),out}function pow(out,a,b){return ln(out,a),quat_scale(out,out,b),exp(out,out),out}function slerp(out,a,b,t){var omega,cosom,sinom,scale0,scale1,ax=a[0],ay=a[1],az=a[2],aw=a[3],bx=b[0],by=b[1],bz=b[2],bw=b[3];return(cosom=ax*bx+ay*by+az*bz+aw*bw)<0&&(cosom=-cosom,bx=-bx,by=-by,bz=-bz,bw=-bw),1-cosom>EPSILON?(omega=Math.acos(cosom),sinom=Math.sin(omega),scale0=Math.sin((1-t)*omega)/sinom,scale1=Math.sin(t*omega)/sinom):(scale0=1-t,scale1=t),out[0]=scale0*ax+scale1*bx,out[1]=scale0*ay+scale1*by,out[2]=scale0*az+scale1*bz,out[3]=scale0*aw+scale1*bw,out}function quat_random(out){var u1=RANDOM(),u2=RANDOM(),u3=RANDOM(),sqrt1MinusU1=Math.sqrt(1-u1),sqrtU1=Math.sqrt(u1);return out[0]=sqrt1MinusU1*Math.sin(2*Math.PI*u2),out[1]=sqrt1MinusU1*Math.cos(2*Math.PI*u2),out[2]=sqrtU1*Math.sin(2*Math.PI*u3),out[3]=sqrtU1*Math.cos(2*Math.PI*u3),out}function quat_invert(out,a){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],dot=a0*a0+a1*a1+a2*a2+a3*a3,invDot=dot?1/dot:0;return out[0]=-a0*invDot,out[1]=-a1*invDot,out[2]=-a2*invDot,out[3]=a3*invDot,out}function conjugate(out,a){return out[0]=-a[0],out[1]=-a[1],out[2]=-a[2],out[3]=a[3],out}function fromMat3(out,m){var fRoot,fTrace=m[0]+m[4]+m[8];if(fTrace>0)fRoot=Math.sqrt(fTrace+1),out[3]=.5*fRoot,fRoot=.5/fRoot,out[0]=(m[5]-m[7])*fRoot,out[1]=(m[6]-m[2])*fRoot,out[2]=(m[1]-m[3])*fRoot;else{var i=0;m[4]>m[0]&&(i=1),m[8]>m[3*i+i]&&(i=2);var j=(i+1)%3,k=(i+2)%3;fRoot=Math.sqrt(m[3*i+i]-m[3*j+j]-m[3*k+k]+1),out[i]=.5*fRoot,fRoot=.5/fRoot,out[3]=(m[3*j+k]-m[3*k+j])*fRoot,out[j]=(m[3*j+i]+m[3*i+j])*fRoot,out[k]=(m[3*k+i]+m[3*i+k])*fRoot}return out}function fromEuler(out,x,y,z){var halfToRad=.5*Math.PI/180;x*=halfToRad,y*=halfToRad,z*=halfToRad;var sx=Math.sin(x),cx=Math.cos(x),sy=Math.sin(y),cy=Math.cos(y),sz=Math.sin(z),cz=Math.cos(z);return out[0]=sx*cy*cz-cx*sy*sz,out[1]=cx*sy*cz+sx*cy*sz,out[2]=cx*cy*sz-sx*sy*cz,out[3]=cx*cy*cz+sx*sy*sz,out}function quat_str(a){return"quat("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+")"}var tmpvec3,xUnitVec3,yUnitVec3,temp1,temp2,matr,quat_clone=function vec4_clone(a){var out=new ARRAY_TYPE(4);return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out},quat_fromValues=function vec4_fromValues(x,y,z,w){var out=new ARRAY_TYPE(4);return out[0]=x,out[1]=y,out[2]=z,out[3]=w,out},quat_copy=function vec4_copy(out,a){return out[0]=a[0],out[1]=a[1],out[2]=a[2],out[3]=a[3],out},quat_set=function vec4_set(out,x,y,z,w){return out[0]=x,out[1]=y,out[2]=z,out[3]=w,out},quat_add=function vec4_add(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out[2]=a[2]+b[2],out[3]=a[3]+b[3],out},quat_mul=quat_multiply,quat_scale=function vec4_scale(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out[2]=a[2]*b,out[3]=a[3]*b,out},quat_dot=function vec4_dot(a,b){return a[0]*b[0]+a[1]*b[1]+a[2]*b[2]+a[3]*b[3]},quat_lerp=function vec4_lerp(out,a,b,t){var ax=a[0],ay=a[1],az=a[2],aw=a[3];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out[2]=az+t*(b[2]-az),out[3]=aw+t*(b[3]-aw),out},quat_length=vec4_length,quat_len=quat_length,quat_squaredLength=vec4_squaredLength,quat_sqrLen=quat_squaredLength,quat_normalize=function vec4_normalize(out,a){var x=a[0],y=a[1],z=a[2],w=a[3],len=x*x+y*y+z*z+w*w;return len>0&&(len=1/Math.sqrt(len)),out[0]=x*len,out[1]=y*len,out[2]=z*len,out[3]=w*len,out},quat_exactEquals=function vec4_exactEquals(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]},quat_equals=function vec4_equals(a,b){var a0=a[0],a1=a[1],a2=a[2],a3=a[3],b0=b[0],b1=b[1],b2=b[2],b3=b[3];return Math.abs(a0-b0)<=EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))&&Math.abs(a2-b2)<=EPSILON*Math.max(1,Math.abs(a2),Math.abs(b2))&&Math.abs(a3-b3)<=EPSILON*Math.max(1,Math.abs(a3),Math.abs(b3))},rotationTo=(tmpvec3=vec3_create(),xUnitVec3=vec3_fromValues(1,0,0),yUnitVec3=vec3_fromValues(0,1,0),function(out,a,b){var dot=vec3_dot(a,b);return dot<-.999999?(cross(tmpvec3,xUnitVec3,a),vec3_len(tmpvec3)<1e-6&&cross(tmpvec3,yUnitVec3,a),normalize(tmpvec3,tmpvec3),setAxisAngle(out,tmpvec3,Math.PI),out):dot>.999999?(out[0]=0,out[1]=0,out[2]=0,out[3]=1,out):(cross(tmpvec3,a,b),out[0]=tmpvec3[0],out[1]=tmpvec3[1],out[2]=tmpvec3[2],out[3]=1+dot,quat_normalize(out,out))}),sqlerp=(temp1=quat_create(),temp2=quat_create(),function(out,a,b,c,d,t){return slerp(temp1,a,d,t),slerp(temp2,b,c,t),slerp(out,temp1,temp2,2*t*(1-t)),out}),setAxes=(matr=create(),function(out,view,right,up){return matr[0]=right[0],matr[3]=right[1],matr[6]=right[2],matr[1]=up[0],matr[4]=up[1],matr[7]=up[2],matr[2]=-view[0],matr[5]=-view[1],matr[8]=-view[2],quat_normalize(out,fromMat3(out,matr))});function vec2_create(){var out=new ARRAY_TYPE(2);return ARRAY_TYPE!=Float32Array&&(out[0]=0,out[1]=0),out}function vec2_clone(a){var out=new ARRAY_TYPE(2);return out[0]=a[0],out[1]=a[1],out}function vec2_fromValues(x,y){var out=new ARRAY_TYPE(2);return out[0]=x,out[1]=y,out}function vec2_copy(out,a){return out[0]=a[0],out[1]=a[1],out}function vec2_set(out,x,y){return out[0]=x,out[1]=y,out}function vec2_add(out,a,b){return out[0]=a[0]+b[0],out[1]=a[1]+b[1],out}function vec2_subtract(out,a,b){return out[0]=a[0]-b[0],out[1]=a[1]-b[1],out}function vec2_multiply(out,a,b){return out[0]=a[0]*b[0],out[1]=a[1]*b[1],out}function vec2_divide(out,a,b){return out[0]=a[0]/b[0],out[1]=a[1]/b[1],out}function vec2_ceil(out,a){return out[0]=Math.ceil(a[0]),out[1]=Math.ceil(a[1]),out}function vec2_floor(out,a){return out[0]=Math.floor(a[0]),out[1]=Math.floor(a[1]),out}function vec2_min(out,a,b){return out[0]=Math.min(a[0],b[0]),out[1]=Math.min(a[1],b[1]),out}function vec2_max(out,a,b){return out[0]=Math.max(a[0],b[0]),out[1]=Math.max(a[1],b[1]),out}function vec2_round(out,a){return out[0]=Math.round(a[0]),out[1]=Math.round(a[1]),out}function vec2_scale(out,a,b){return out[0]=a[0]*b,out[1]=a[1]*b,out}function vec2_scaleAndAdd(out,a,b,scale){return out[0]=a[0]+b[0]*scale,out[1]=a[1]+b[1]*scale,out}function vec2_distance(a,b){var x=b[0]-a[0],y=b[1]-a[1];return Math.hypot(x,y)}function vec2_squaredDistance(a,b){var x=b[0]-a[0],y=b[1]-a[1];return x*x+y*y}function vec2_length(a){var x=a[0],y=a[1];return Math.hypot(x,y)}function vec2_squaredLength(a){var x=a[0],y=a[1];return x*x+y*y}function vec2_negate(out,a){return out[0]=-a[0],out[1]=-a[1],out}function vec2_inverse(out,a){return out[0]=1/a[0],out[1]=1/a[1],out}function vec2_normalize(out,a){var x=a[0],y=a[1],len=x*x+y*y;return len>0&&(len=1/Math.sqrt(len)),out[0]=a[0]*len,out[1]=a[1]*len,out}function vec2_dot(a,b){return a[0]*b[0]+a[1]*b[1]}function vec2_cross(out,a,b){var z=a[0]*b[1]-a[1]*b[0];return out[0]=out[1]=0,out[2]=z,out}function vec2_lerp(out,a,b,t){var ax=a[0],ay=a[1];return out[0]=ax+t*(b[0]-ax),out[1]=ay+t*(b[1]-ay),out}function vec2_random(out,scale){scale=scale||1;var r=2*RANDOM()*Math.PI;return out[0]=Math.cos(r)*scale,out[1]=Math.sin(r)*scale,out}function transformMat2(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[2]*y,out[1]=m[1]*x+m[3]*y,out}function transformMat2d(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[2]*y+m[4],out[1]=m[1]*x+m[3]*y+m[5],out}function vec2_transformMat3(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[3]*y+m[6],out[1]=m[1]*x+m[4]*y+m[7],out}function vec2_transformMat4(out,a,m){var x=a[0],y=a[1];return out[0]=m[0]*x+m[4]*y+m[12],out[1]=m[1]*x+m[5]*y+m[13],out}function vec2_rotate(out,a,b,rad){var p0=a[0]-b[0],p1=a[1]-b[1],sinC=Math.sin(rad),cosC=Math.cos(rad);return out[0]=p0*cosC-p1*sinC+b[0],out[1]=p0*sinC+p1*cosC+b[1],out}function vec2_angle(a,b){var x1=a[0],y1=a[1],x2=b[0],y2=b[1],mag=Math.sqrt(x1*x1+y1*y1)*Math.sqrt(x2*x2+y2*y2),cosine=mag&&(x1*x2+y1*y2)/mag;return Math.acos(Math.min(Math.max(cosine,-1),1))}function vec2_zero(out){return out[0]=0,out[1]=0,out}function vec2_str(a){return"vec2("+a[0]+", "+a[1]+")"}function vec2_exactEquals(a,b){return a[0]===b[0]&&a[1]===b[1]}function vec2_equals(a,b){var a0=a[0],a1=a[1],b0=b[0],b1=b[1];return Math.abs(a0-b0)<=EPSILON*Math.max(1,Math.abs(a0),Math.abs(b0))&&Math.abs(a1-b1)<=EPSILON*Math.max(1,Math.abs(a1),Math.abs(b1))}var vec2_len=vec2_length,vec2_sub=vec2_subtract,vec2_mul=vec2_multiply,vec2_div=vec2_divide,vec2_dist=vec2_distance,vec2_sqrDist=vec2_squaredDistance,vec2_sqrLen=vec2_squaredLength,vec2_forEach=function(){var vec=vec2_create();return function(a,stride,offset,count,fn,arg){var i,l;for(stride||(stride=2),offset||(offset=0),l=count?Math.min(count*stride+offset,a.length):a.length,i=offset;i<l;i+=stride)vec[0]=a[i],vec[1]=a[i+1],fn(vec,vec,arg),a[i]=vec[0],a[i+1]=vec[1];return a}}(),imready_esm_extendStatics=function(d,b){return(imready_esm_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)Object.prototype.hasOwnProperty.call(b,p)&&(d[p]=b[p])})(d,b)};function imready_esm_extends(d,b){function __(){this.constructor=d}imready_esm_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var imready_esm_assign=function(){return(imready_esm_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};var isWindow="undefined"!=typeof window,ua=isWindow?window.navigator.userAgent:"",SUPPORT_COMPUTEDSTYLE=!!isWindow&&!!("getComputedStyle"in window),IS_IE=/MSIE|Trident|Windows Phone|Edge/.test(ua),SUPPORT_ADDEVENTLISTENER=!!isWindow&&!!("addEventListener"in document);function getAttribute(el,name){return el.getAttribute(name)||""}function imready_esm_toArray(arr){return[].slice.call(arr)}function hasLoadingAttribute(target){return"loading"in target&&"lazy"===target.getAttribute("loading")}function addEvent(element,type,handler){SUPPORT_ADDEVENTLISTENER?element.addEventListener(type,handler,!1):element.attachEvent?element.attachEvent("on"+type,handler):element["on"+type]=handler}function removeEvent(element,type,handler){element.removeEventListener?element.removeEventListener(type,handler,!1):element.detachEvent?element.detachEvent("on"+type,handler):element["on"+type]=null}function getSize(el,name){var size=el["client"+name]||el["offset"+name];return parseFloat(size||function getStyles(el){return(SUPPORT_COMPUTEDSTYLE?window.getComputedStyle(el):el.currentStyle)||{}}(el)[name.toLowerCase()])||0}function getContentElements(element,tags,prefix){var skipElements=imready_esm_toArray(element.querySelectorAll(function __spreadArrays(){for(var s=0,i=0,il=arguments.length;i<il;i++)s+=arguments[i].length;var r=Array(s),k=0;for(i=0;i<il;i++)for(var a=arguments[i],j=0,jl=a.length;j<jl;j++,k++)r[k]=a[j];return r}(["["+prefix+"skip] ["+prefix+"width]"],tags.map((function(tag){return["["+prefix+"skip] "+tag,tag+"["+prefix+"skip]","["+prefix+"width] "+tag].join(", ")}))).join(", ")));return imready_esm_toArray(element.querySelectorAll("["+prefix+"width], "+tags.join(", "))).filter((function(el){return-1===skipElements.indexOf(el)}))}var imready_esm_elements=[];function addAutoSizer(element,prefix){!imready_esm_elements.length&&addEvent(window,"resize",resizeAllAutoSizers),element.__PREFIX__=prefix,imready_esm_elements.push(element),resize(element)}function resize(element,prefix){void 0===prefix&&(prefix="data-");var elementPrefix=element.__PREFIX__||prefix,dataWidth=parseInt(getAttribute(element,elementPrefix+"width"),10)||0,dataHeight=parseInt(getAttribute(element,elementPrefix+"height"),10)||0;if("height"===getAttribute(element,elementPrefix+"fixed")){var size=function imready_esm_innerHeight(el){return getSize(el,"Height")}(element)||dataHeight;element.style.width=dataWidth/dataHeight*size+"px"}else{size=function imready_esm_innerWidth(el){return getSize(el,"Width")}(element)||dataWidth;element.style.height=dataHeight/dataWidth*size+"px"}}function resizeAllAutoSizers(){imready_esm_elements.forEach((function(element){resize(element)}))}var Loader=function(_super){function Loader(element,options){void 0===options&&(options={});var _this=_super.call(this)||this;return _this.isReady=!1,_this.isPreReady=!1,_this.hasDataSize=!1,_this.hasLoading=!1,_this.isSkip=!1,_this.onCheck=function(e){_this.clear(),e&&"error"===e.type&&_this.onError(_this.element);var withPreReady=!_this.hasDataSize&&!_this.hasLoading;_this.onReady(withPreReady)},_this.options=imready_esm_assign({prefix:"data-"},options),_this.element=element,_this.hasDataSize=function hasSizeAttribute(target,prefix){return void 0===prefix&&(prefix="data-"),!!target.getAttribute(prefix+"width")}(element,_this.options.prefix),_this.hasLoading=hasLoadingAttribute(element),_this.isSkip=function hasSkipAttribute(target,prefix){return void 0===prefix&&(prefix="data-"),!!target.getAttribute(prefix+"skip")}(_this.element),_this}imready_esm_extends(Loader,_super);var __proto=Loader.prototype;return __proto.check=function(){return this.isSkip||!this.checkElement()?(this.onAlreadyReady(!0),!1):(this.hasDataSize&&addAutoSizer(this.element,this.options.prefix),(this.hasDataSize||this.hasLoading)&&this.onAlreadyPreReady(),!0)},__proto.addEvents=function(){var _this=this,element=this.element;this.constructor.EVENTS.forEach((function(name){addEvent(element,name,_this.onCheck)}))},__proto.clear=function(){var _this=this,element=this.element;this.constructor.EVENTS.forEach((function(name){removeEvent(element,name,_this.onCheck)})),this.removeAutoSizer()},__proto.destroy=function(){this.clear(),this.off()},__proto.removeAutoSizer=function(){if(this.hasDataSize){var prefix=this.options.prefix;!function removeAutoSizer(element,prefix){var index=imready_esm_elements.indexOf(element);if(!(index<0)){var fixed=getAttribute(element,prefix+"fixed");delete element.__PREFIX__,element.style["height"===fixed?"width":"height"]="",imready_esm_elements.splice(index,1),!imready_esm_elements.length&&removeEvent(window,"resize",resizeAllAutoSizers)}}(this.element,prefix)}},__proto.onError=function(target){this.trigger("error",{element:this.element,target:target})},__proto.onPreReady=function(){this.isPreReady||(this.isPreReady=!0,this.trigger("preReady",{element:this.element,hasLoading:this.hasLoading,isSkip:this.isSkip}))},__proto.onReady=function(withPreReady){this.isReady||((withPreReady=!this.isPreReady&&withPreReady)&&(this.isPreReady=!0),this.removeAutoSizer(),this.isReady=!0,this.trigger("ready",{element:this.element,withPreReady:withPreReady,hasLoading:this.hasLoading,isSkip:this.isSkip}))},__proto.onAlreadyError=function(target){var _this=this;setTimeout((function(){_this.onError(target)}))},__proto.onAlreadyPreReady=function(){var _this=this;setTimeout((function(){_this.onPreReady()}))},__proto.onAlreadyReady=function(withPreReady){var _this=this;setTimeout((function(){_this.onReady(withPreReady)}))},Loader.EVENTS=[],Loader}(component_esm),ElementLoader=function(_super){function ElementLoader(){return null!==_super&&_super.apply(this,arguments)||this}imready_esm_extends(ElementLoader,_super);var __proto=ElementLoader.prototype;return __proto.setHasLoading=function(hasLoading){this.hasLoading=hasLoading},__proto.check=function(){return this.isSkip?(this.onAlreadyReady(!0),!1):(this.hasDataSize?(addAutoSizer(this.element,this.options.prefix),this.onAlreadyPreReady()):this.trigger("requestChildren"),!0)},__proto.checkElement=function(){return!0},__proto.destroy=function(){this.clear(),this.trigger("requestDestroy"),this.off()},__proto.onAlreadyPreReady=function(){_super.prototype.onAlreadyPreReady.call(this),this.trigger("reqeustReadyChildren")},ElementLoader.EVENTS=[],ElementLoader}(Loader),ImReadyManager=function(_super){function ImReadyManager(options){void 0===options&&(options={});var _this=_super.call(this)||this;return _this.readyCount=0,_this.preReadyCount=0,_this.totalCount=0,_this.totalErrorCount=0,_this.isPreReadyOver=!0,_this.elementInfos=[],_this.options=imready_esm_assign({loaders:{},prefix:"data-"},options),_this}imready_esm_extends(ImReadyManager,_super);var __proto=ImReadyManager.prototype;return __proto.check=function(elements){var _this=this,prefix=this.options.prefix;this.clear(),this.elementInfos=imready_esm_toArray(elements).map((function(element,index){var loader=_this.getLoader(element,{prefix:prefix});return loader.check(),loader.on("error",(function(e){_this.onError(index,e.target)})).on("preReady",(function(e){var info=_this.elementInfos[index];info.hasLoading=e.hasLoading,info.isSkip=e.isSkip;var isPreReady=_this.checkPreReady(index);_this.onPreReadyElement(index),isPreReady&&_this.onPreReady()})).on("ready",(function(_a){var withPreReady=_a.withPreReady,hasLoading=_a.hasLoading,isSkip=_a.isSkip,info=_this.elementInfos[index];info.hasLoading=hasLoading,info.isSkip=isSkip;var isPreReady=withPreReady&&_this.checkPreReady(index),isReady=_this.checkReady(index);withPreReady&&_this.onPreReadyElement(index),_this.onReadyElement(index),isPreReady&&_this.onPreReady(),isReady&&_this.onReady()})),{loader:loader,element:element,hasLoading:!1,hasError:!1,isPreReady:!1,isReady:!1,isSkip:!1}}));var length=this.elementInfos.length;return this.totalCount=length,length||setTimeout((function(){_this.onPreReady(),_this.onReady()})),this},__proto.getTotalCount=function(){return this.totalCount},__proto.isPreReady=function(){return this.elementInfos.every((function(info){return info.isPreReady}))},__proto.isReady=function(){return this.elementInfos.every((function(info){return info.isReady}))},__proto.hasError=function(){return this.totalErrorCount>0},__proto.clear=function(){this.isPreReadyOver=!1,this.totalCount=0,this.preReadyCount=0,this.readyCount=0,this.totalErrorCount=0,this.elementInfos.forEach((function(info){!info.isReady&&info.loader&&info.loader.destroy()})),this.elementInfos=[]},__proto.destroy=function(){this.clear(),this.off()},__proto.getLoader=function(element,options){var _this=this,tagName=element.tagName.toLowerCase(),loaders=this.options.loaders,tags=Object.keys(loaders);if(loaders[tagName])return new loaders[tagName](element,options);var loader=new ElementLoader(element,options),children=imready_esm_toArray(element.querySelectorAll(tags.join(", ")));loader.setHasLoading(children.some((function(el){return hasLoadingAttribute(el)})));var withPreReady=!1,childrenImReady=this.clone().on("error",(function(e){loader.onError(e.target)})).on("ready",(function(){loader.onReady(withPreReady)}));return loader.on("requestChildren",(function(){var contentElements=getContentElements(element,tags,_this.options.prefix);childrenImReady.check(contentElements).on("preReady",(function(e){(withPreReady=e.isReady)||loader.onPreReady()}))})).on("reqeustReadyChildren",(function(){childrenImReady.check(children)})).on("requestDestroy",(function(){childrenImReady.destroy()})),loader},__proto.clone=function(){return new ImReadyManager(imready_esm_assign({},this.options))},__proto.checkPreReady=function(index){return this.elementInfos[index].isPreReady=!0,++this.preReadyCount,!(this.preReadyCount<this.totalCount)},__proto.checkReady=function(index){return this.elementInfos[index].isReady=!0,++this.readyCount,!(this.readyCount<this.totalCount)},__proto.onError=function(index,target){var info=this.elementInfos[index];info.hasError=!0,this.trigger("error",{element:info.element,index:index,target:target,errorCount:this.getErrorCount(),totalErrorCount:++this.totalErrorCount})},__proto.onPreReadyElement=function(index){var info=this.elementInfos[index];this.trigger("preReadyElement",{element:info.element,index:index,preReadyCount:this.preReadyCount,readyCount:this.readyCount,totalCount:this.totalCount,isPreReady:this.isPreReady(),isReady:this.isReady(),hasLoading:info.hasLoading,isSkip:info.isSkip})},__proto.onPreReady=function(){this.isPreReadyOver=!0,this.trigger("preReady",{readyCount:this.readyCount,totalCount:this.totalCount,isReady:this.isReady(),hasLoading:this.hasLoading()})},__proto.onReadyElement=function(index){var info=this.elementInfos[index];this.trigger("readyElement",{index:index,element:info.element,hasError:info.hasError,errorCount:this.getErrorCount(),totalErrorCount:this.totalErrorCount,preReadyCount:this.preReadyCount,readyCount:this.readyCount,totalCount:this.totalCount,isPreReady:this.isPreReady(),isReady:this.isReady(),hasLoading:info.hasLoading,isPreReadyOver:this.isPreReadyOver,isSkip:info.isSkip})},__proto.onReady=function(){this.trigger("ready",{errorCount:this.getErrorCount(),totalErrorCount:this.totalErrorCount,totalCount:this.totalCount})},__proto.getErrorCount=function(){return this.elementInfos.filter((function(info){return info.hasError})).length},__proto.hasLoading=function(){return this.elementInfos.some((function(info){return info.hasLoading}))},ImReadyManager}(component_esm),ImageLoader=function(_super){function ImageLoader(){return null!==_super&&_super.apply(this,arguments)||this}return imready_esm_extends(ImageLoader,_super),ImageLoader.prototype.checkElement=function(){var element=this.element,src=element.getAttribute("src");if(element.complete){if(src)return element.naturalWidth||this.onAlreadyError(element),!1;this.onAlreadyPreReady()}return this.addEvents(),IS_IE&&element.setAttribute("src",src),!0},ImageLoader.EVENTS=["load","error"],ImageLoader}(Loader),VideoLoader=function(_super){function VideoLoader(){return null!==_super&&_super.apply(this,arguments)||this}return imready_esm_extends(VideoLoader,_super),VideoLoader.prototype.checkElement=function(){var element=this.element;return!(element.readyState>=1)&&(element.error?(this.onAlreadyError(element),!1):(this.addEvents(),!0))},VideoLoader.EVENTS=["loadedmetadata","error"],VideoLoader}(Loader),imready_esm=function(_super){function ImReady(options){return void 0===options&&(options={}),_super.call(this,imready_esm_assign({loaders:{img:ImageLoader,video:VideoLoader}},options))||this}return imready_esm_extends(ImReady,_super),ImReady}(ImReadyManager);__webpack_require__.d(__webpack_exports__,"a",(function(){return view360_esm_PanoViewer}));var view360_esm_extendStatics=function(d,b){return(view360_esm_extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])})(d,b)};function view360_esm_extends(d,b){function __(){this.constructor=d}view360_esm_extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}var view360_esm_assign=function(){return(view360_esm_assign=Object.assign||function __assign(t){for(var s,i=1,n=arguments.length;i<n;i++)for(var p in s=arguments[i])Object.prototype.hasOwnProperty.call(s,p)&&(t[p]=s[p]);return t}).apply(this,arguments)};function view360_esm_values(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw new TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar}function __spread(){for(var ar=[],i=0;i<arguments.length;i++)ar=ar.concat(__read(arguments[i]));return ar}var view360_esm_win="undefined"!=typeof window&&window.Math===Math?window:"undefined"!=typeof self&&self.Math===Math?self:Function("return this")(),doc=view360_esm_win.document,view360_esm_agent=agent_esm(),osName=view360_esm_agent.os.name,browserName=view360_esm_agent.browser.name,IS_IOS="ios"===osName,IS_SAFARI_ON_DESKTOP="mac"===osName&&"safari"===browserName;view360_esm_win.Float32Array=void 0!==view360_esm_win.Float32Array?view360_esm_win.Float32Array:view360_esm_win.Array;view360_esm_win.Float32Array,view360_esm_win.getComputedStyle;var userAgent=view360_esm_win.navigator.userAgent,view360_esm_SUPPORT_TOUCH="ontouchstart"in view360_esm_win,SUPPORT_DEVICEMOTION="ondevicemotion"in view360_esm_win,DeviceMotionEvent=view360_esm_win.DeviceMotionEvent,devicePixelRatio=view360_esm_win.devicePixelRatio,WEBXR_SUPPORTED=(function(){for(var docStyle=doc.documentElement.style,target=["transform","webkitTransform","msTransform","mozTransform"],i=0,len=target.length;i<len;i++)if(target[i]in docStyle)return target[i]}(),view360_esm_win.CSS&&view360_esm_win.CSS.supports&&view360_esm_win.CSS.supports("will-change","transform"),!1);function toDegree(a){return 180*a/Math.PI}var util={isPowerOfTwo:function(n){return n&&0==(n&n-1)}};util.extractPitchFromQuat=function(quaternion){var baseV=function quatToVec3(quaternion){var baseV=vec3_namespaceObject.fromValues(0,0,1);return vec3_namespaceObject.transformQuat(baseV,baseV,quaternion),baseV}(quaternion);return-1*Math.atan2(baseV[1],Math.sqrt(Math.pow(baseV[0],2)+Math.pow(baseV[2],2)))},util.hypot=Math.hypot||function(x,y){return Math.sqrt(x*x+y*y)};var ROTATE_CONSTANT={PITCH_DELTA:1,YAW_DELTA_BY_ROLL:2,YAW_DELTA_BY_YAW:3};function angleBetweenVec2(v1,v2){var det=v1[0]*v2[1]-v2[0]*v1[1];return-Math.atan2(det,vec2_namespaceObject.dot(v1,v2))}ROTATE_CONSTANT[ROTATE_CONSTANT.PITCH_DELTA]={targetAxis:[0,1,0],meshPoint:[0,0,1]},ROTATE_CONSTANT[ROTATE_CONSTANT.YAW_DELTA_BY_ROLL]={targetAxis:[0,1,0],meshPoint:[1,0,0]},ROTATE_CONSTANT[ROTATE_CONSTANT.YAW_DELTA_BY_YAW]={targetAxis:[1,0,0],meshPoint:[0,0,1]},util.yawOffsetBetween=function(viewDir,targetDir){var viewDirXZ=vec2_namespaceObject.fromValues(viewDir[0],viewDir[2]),targetDirXZ=vec2_namespaceObject.fromValues(targetDir[0],targetDir[2]);return vec2_namespaceObject.normalize(viewDirXZ,viewDirXZ),vec2_namespaceObject.normalize(targetDirXZ,targetDirXZ),-angleBetweenVec2(viewDirXZ,targetDirXZ)},util.toDegree=toDegree,util.getRotationDelta=function getRotationDelta(prevQ,curQ,rotateKind){var targetAxis=vec3_namespaceObject.fromValues(ROTATE_CONSTANT[rotateKind].targetAxis[0],ROTATE_CONSTANT[rotateKind].targetAxis[1],ROTATE_CONSTANT[rotateKind].targetAxis[2]),meshPoint=ROTATE_CONSTANT[rotateKind].meshPoint,prevQuaternion=quat_namespaceObject.clone(prevQ),curQuaternion=quat_namespaceObject.clone(curQ);quat_namespaceObject.normalize(prevQuaternion,prevQuaternion),quat_namespaceObject.normalize(curQuaternion,curQuaternion);var prevPoint=vec3_namespaceObject.fromValues(0,0,1),curPoint=vec3_namespaceObject.fromValues(0,0,1);vec3_namespaceObject.transformQuat(prevPoint,prevPoint,prevQuaternion),vec3_namespaceObject.transformQuat(curPoint,curPoint,curQuaternion),vec3_namespaceObject.transformQuat(targetAxis,targetAxis,curQuaternion);var meshPoint3,rotateDirection=vec3_namespaceObject.dot(targetAxis,vec3_namespaceObject.cross(vec3_namespaceObject.create(),prevPoint,curPoint))>0?1:-1,meshPoint2=vec3_namespaceObject.fromValues(meshPoint[0],meshPoint[1],meshPoint[2]);meshPoint3=rotateKind!==ROTATE_CONSTANT.YAW_DELTA_BY_YAW?vec3_namespaceObject.fromValues(0,rotateDirection,0):vec3_namespaceObject.fromValues(rotateDirection,0,0),vec3_namespaceObject.transformQuat(meshPoint2,meshPoint2,curQuaternion),vec3_namespaceObject.transformQuat(meshPoint3,meshPoint3,curQuaternion);var vecU=meshPoint2,vecV=meshPoint3,vecN=vec3_namespaceObject.create();vec3_namespaceObject.cross(vecN,vecU,vecV),vec3_namespaceObject.normalize(vecN,vecN);var coefficientA=vecN[0],coefficientB=vecN[1],coefficientC=vecN[2];curPoint=vec3_namespaceObject.fromValues(meshPoint[0],meshPoint[1],meshPoint[2]),vec3_namespaceObject.transformQuat(curPoint,curPoint,curQuaternion),prevPoint=vec3_namespaceObject.fromValues(meshPoint[0],meshPoint[1],meshPoint[2]),vec3_namespaceObject.transformQuat(prevPoint,prevPoint,prevQuaternion);var distance=Math.abs(prevPoint[0]*coefficientA+prevPoint[1]*coefficientB+prevPoint[2]*coefficientC),projectedPrevPoint=vec3_namespaceObject.create();vec3_namespaceObject.subtract(projectedPrevPoint,prevPoint,vec3_namespaceObject.scale(vec3_namespaceObject.create(),vecN,distance));var trigonometricRatio=(projectedPrevPoint[0]*curPoint[0]+projectedPrevPoint[1]*curPoint[1]+projectedPrevPoint[2]*curPoint[2])/(vec3_namespaceObject.length(projectedPrevPoint)*vec3_namespaceObject.length(curPoint));trigonometricRatio>1&&(trigonometricRatio=1);var theta=Math.acos(trigonometricRatio),crossVec=vec3_namespaceObject.cross(vec3_namespaceObject.create(),curPoint,projectedPrevPoint);return distance=coefficientA*crossVec[0]+coefficientB*crossVec[1]+coefficientC*crossVec[2],toDegree(theta*(rotateKind!==ROTATE_CONSTANT.YAW_DELTA_BY_YAW?distance>0?1:-1:distance<0?1:-1)*rotateDirection)},util.angleBetweenVec2=angleBetweenVec2;var v1,r,MathUtil=window.MathUtil||{};MathUtil.degToRad=Math.PI/180,MathUtil.radToDeg=180/Math.PI,MathUtil.Vector2=function(x,y){this.x=x||0,this.y=y||0},MathUtil.Vector2.prototype={constructor:MathUtil.Vector2,set:function(x,y){return this.x=x,this.y=y,this},copy:function(v){return this.x=v.x,this.y=v.y,this},subVectors:function(a,b){return this.x=a.x-b.x,this.y=a.y-b.y,this}},MathUtil.Vector3=function(x,y,z){this.x=x||0,this.y=y||0,this.z=z||0},MathUtil.Vector3.prototype={constructor:MathUtil.Vector3,set:function(x,y,z){return this.x=x,this.y=y,this.z=z,this},copy:function(v){return this.x=v.x,this.y=v.y,this.z=v.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var scalar=this.length();if(0!==scalar){var invScalar=1/scalar;this.multiplyScalar(invScalar)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(scalar){this.x*=scalar,this.y*=scalar,this.z*=scalar},applyQuaternion:function(q){var x=this.x,y=this.y,z=this.z,qx=q.x,qy=q.y,qz=q.z,qw=q.w,ix=qw*x+qy*z-qz*y,iy=qw*y+qz*x-qx*z,iz=qw*z+qx*y-qy*x,iw=-qx*x-qy*y-qz*z;return this.x=ix*qw+iw*-qx+iy*-qz-iz*-qy,this.y=iy*qw+iw*-qy+iz*-qx-ix*-qz,this.z=iz*qw+iw*-qz+ix*-qy-iy*-qx,this},dot:function(v){return this.x*v.x+this.y*v.y+this.z*v.z},crossVectors:function(a,b){var ax=a.x,ay=a.y,az=a.z,bx=b.x,by=b.y,bz=b.z;return this.x=ay*bz-az*by,this.y=az*bx-ax*bz,this.z=ax*by-ay*bx,this}},MathUtil.Quaternion=function(x,y,z,w){this.x=x||0,this.y=y||0,this.z=z||0,this.w=void 0!==w?w:1},MathUtil.Quaternion.prototype={constructor:MathUtil.Quaternion,set:function(x,y,z,w){return this.x=x,this.y=y,this.z=z,this.w=w,this},copy:function(quaternion){return this.x=quaternion.x,this.y=quaternion.y,this.z=quaternion.z,this.w=quaternion.w,this},setFromEulerXYZ:function(x,y,z){var c1=Math.cos(x/2),c2=Math.cos(y/2),c3=Math.cos(z/2),s1=Math.sin(x/2),s2=Math.sin(y/2),s3=Math.sin(z/2);return this.x=s1*c2*c3+c1*s2*s3,this.y=c1*s2*c3-s1*c2*s3,this.z=c1*c2*s3+s1*s2*c3,this.w=c1*c2*c3-s1*s2*s3,this},setFromEulerYXZ:function(x,y,z){var c1=Math.cos(x/2),c2=Math.cos(y/2),c3=Math.cos(z/2),s1=Math.sin(x/2),s2=Math.sin(y/2),s3=Math.sin(z/2);return this.x=s1*c2*c3+c1*s2*s3,this.y=c1*s2*c3-s1*c2*s3,this.z=c1*c2*s3-s1*s2*c3,this.w=c1*c2*c3+s1*s2*s3,this},setFromAxisAngle:function(axis,angle){var halfAngle=angle/2,s=Math.sin(halfAngle);return this.x=axis.x*s,this.y=axis.y*s,this.z=axis.z*s,this.w=Math.cos(halfAngle),this},multiply:function(q){return this.multiplyQuaternions(this,q)},multiplyQuaternions:function(a,b){var qax=a.x,qay=a.y,qaz=a.z,qaw=a.w,qbx=b.x,qby=b.y,qbz=b.z,qbw=b.w;return this.x=qax*qbw+qaw*qbx+qay*qbz-qaz*qby,this.y=qay*qbw+qaw*qby+qaz*qbx-qax*qbz,this.z=qaz*qbw+qaw*qbz+qax*qby-qay*qbx,this.w=qaw*qbw-qax*qbx-qay*qby-qaz*qbz,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var l=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return 0===l?(this.x=0,this.y=0,this.z=0,this.w=1):(l=1/l,this.x=this.x*l,this.y=this.y*l,this.z=this.z*l,this.w=this.w*l),this},slerp:function(qb,t){if(0===t)return this;if(1===t)return this.copy(qb);var x=this.x,y=this.y,z=this.z,w=this.w,cosHalfTheta=w*qb.w+x*qb.x+y*qb.y+z*qb.z;if(cosHalfTheta<0?(this.w=-qb.w,this.x=-qb.x,this.y=-qb.y,this.z=-qb.z,cosHalfTheta=-cosHalfTheta):this.copy(qb),cosHalfTheta>=1)return this.w=w,this.x=x,this.y=y,this.z=z,this;var halfTheta=Math.acos(cosHalfTheta),sinHalfTheta=Math.sqrt(1-cosHalfTheta*cosHalfTheta);if(Math.abs(sinHalfTheta)<.001)return this.w=.5*(w+this.w),this.x=.5*(x+this.x),this.y=.5*(y+this.y),this.z=.5*(z+this.z),this;var ratioA=Math.sin((1-t)*halfTheta)/sinHalfTheta,ratioB=Math.sin(t*halfTheta)/sinHalfTheta;return this.w=w*ratioA+this.w*ratioB,this.x=x*ratioA+this.x*ratioB,this.y=y*ratioA+this.y*ratioB,this.z=z*ratioA+this.z*ratioB,this},setFromUnitVectors:function(vFrom,vTo){return void 0===v1&&(v1=new MathUtil.Vector3),(r=vFrom.dot(vTo)+1)<1e-6?(r=0,Math.abs(vFrom.x)>Math.abs(vFrom.z)?v1.set(-vFrom.y,vFrom.x,0):v1.set(0,-vFrom.z,vFrom.y)):v1.crossVectors(vFrom,vTo),this.x=v1.x,this.y=v1.y,this.z=v1.z,this.w=r,this.normalize(),this}};var isIOS,isWebViewAndroid,isSafari,isFirefoxAndroid,isR7,mathUtil=MathUtil,Util=window.Util||{};Util.MIN_TIMESTEP=.001,Util.MAX_TIMESTEP=1,Util.base64=function(mimeType,base64){return"data:"+mimeType+";base64,"+base64},Util.clamp=function(value,min,max){return Math.min(Math.max(min,value),max)},Util.lerp=function(a,b,t){return a+(b-a)*t},Util.isIOS=(isIOS=/iPad|iPhone|iPod/.test(navigator.platform),function(){return isIOS}),Util.isWebViewAndroid=(isWebViewAndroid=-1!==navigator.userAgent.indexOf("Version")&&-1!==navigator.userAgent.indexOf("Android")&&-1!==navigator.userAgent.indexOf("Chrome"),function(){return isWebViewAndroid}),Util.isSafari=(isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),function(){return isSafari}),Util.isFirefoxAndroid=(isFirefoxAndroid=-1!==navigator.userAgent.indexOf("Firefox")&&-1!==navigator.userAgent.indexOf("Android"),function(){return isFirefoxAndroid}),Util.isR7=(isR7=-1!==navigator.userAgent.indexOf("R7 Build"),function(){return isR7}),Util.isLandscapeMode=function(){var rtn=90==window.orientation||-90==window.orientation;return Util.isR7()?!rtn:rtn},Util.isTimestampDeltaValid=function(timestampDeltaS){return!isNaN(timestampDeltaS)&&(!(timestampDeltaS<=Util.MIN_TIMESTEP)&&!(timestampDeltaS>Util.MAX_TIMESTEP))},Util.getScreenWidth=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Util.getScreenHeight=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},Util.requestFullscreen=function(element){if(Util.isWebViewAndroid())return!1;if(element.requestFullscreen)element.requestFullscreen();else if(element.webkitRequestFullscreen)element.webkitRequestFullscreen();else if(element.mozRequestFullScreen)element.mozRequestFullScreen();else{if(!element.msRequestFullscreen)return!1;element.msRequestFullscreen()}return!0},Util.exitFullscreen=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else{if(!document.msExitFullscreen)return!1;document.msExitFullscreen()}return!0},Util.getFullscreenElement=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},Util.linkProgram=function(gl,vertexSource,fragmentSource,attribLocationMap){var vertexShader=gl.createShader(gl.VERTEX_SHADER);gl.shaderSource(vertexShader,vertexSource),gl.compileShader(vertexShader);var fragmentShader=gl.createShader(gl.FRAGMENT_SHADER);gl.shaderSource(fragmentShader,fragmentSource),gl.compileShader(fragmentShader);var program=gl.createProgram();for(var attribName in gl.attachShader(program,vertexShader),gl.attachShader(program,fragmentShader),attribLocationMap)gl.bindAttribLocation(program,attribLocationMap[attribName],attribName);return gl.linkProgram(program),gl.deleteShader(vertexShader),gl.deleteShader(fragmentShader),program},Util.getProgramUniforms=function(gl,program){for(var uniforms={},uniformCount=gl.getProgramParameter(program,gl.ACTIVE_UNIFORMS),uniformName="",i=0;i<uniformCount;i++){uniforms[uniformName=gl.getActiveUniform(program,i).name.replace("[0]","")]=gl.getUniformLocation(program,uniformName)}return uniforms},Util.orthoMatrix=function(out,left,right,bottom,top,near,far){var lr=1/(left-right),bt=1/(bottom-top),nf=1/(near-far);return out[0]=-2*lr,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=-2*bt,out[6]=0,out[7]=0,out[8]=0,out[9]=0,out[10]=2*nf,out[11]=0,out[12]=(left+right)*lr,out[13]=(top+bottom)*bt,out[14]=(far+near)*nf,out[15]=1,out},Util.copyArray=function(source,dest){for(var i=0,n=source.length;i<n;i++)dest[i]=source[i]},Util.isMobile=function(){var a,check=!1;return a=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(a)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(a.substr(0,4)))&&(check=!0),check},Util.extend=function(dest,src){for(var key in src)src.hasOwnProperty(key)&&(dest[key]=src[key]);return dest},Util.safariCssSizeWorkaround=function(canvas){if(Util.isIOS()){var width=canvas.style.width,height=canvas.style.height;canvas.style.width=parseInt(width)+1+"px",canvas.style.height=parseInt(height)+"px",setTimeout((function(){canvas.style.width=width,canvas.style.height=height}),100)}window.Util=Util,window.canvas=canvas},Util.isDebug=function(){return Util.getQueryParameter("debug")},Util.getQueryParameter=function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var results=new RegExp("[\\?&]"+name+"=([^&#]*)").exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},Util.frameDataFromPose=function(){var piOver180=Math.PI/180,rad45=.25*Math.PI;var defaultOrientation=new Float32Array([0,0,0,1]),defaultPosition=new Float32Array([0,0,0]);function updateEyeMatrices(projection,view,pose,parameters,vrDisplay){!function mat4_perspectiveFromFieldOfView(out,fov,near,far){var upTan=Math.tan(fov?fov.upDegrees*piOver180:rad45),downTan=Math.tan(fov?fov.downDegrees*piOver180:rad45),leftTan=Math.tan(fov?fov.leftDegrees*piOver180:rad45),rightTan=Math.tan(fov?fov.rightDegrees*piOver180:rad45),xScale=2/(leftTan+rightTan),yScale=2/(upTan+downTan);return out[0]=xScale,out[1]=0,out[2]=0,out[3]=0,out[4]=0,out[5]=yScale,out[6]=0,out[7]=0,out[8]=-(leftTan-rightTan)*xScale*.5,out[9]=(upTan-downTan)*yScale*.5,out[10]=far/(near-far),out[11]=-1,out[12]=0,out[13]=0,out[14]=far*near/(near-far),out[15]=0,out}(projection,parameters?parameters.fieldOfView:null,vrDisplay.depthNear,vrDisplay.depthFar),function mat4_fromRotationTranslation(out,q,v){var x=q[0],y=q[1],z=q[2],w=q[3],x2=x+x,y2=y+y,z2=z+z,xx=x*x2,xy=x*y2,xz=x*z2,yy=y*y2,yz=y*z2,zz=z*z2,wx=w*x2,wy=w*y2,wz=w*z2;return out[0]=1-(yy+zz),out[1]=xy+wz,out[2]=xz-wy,out[3]=0,out[4]=xy-wz,out[5]=1-(xx+zz),out[6]=yz+wx,out[7]=0,out[8]=xz+wy,out[9]=yz-wx,out[10]=1-(xx+yy),out[11]=0,out[12]=v[0],out[13]=v[1],out[14]=v[2],out[15]=1,out}(view,pose.orientation||defaultOrientation,pose.position||defaultPosition),parameters&&function mat4_translate(out,a,v){var a00,a01,a02,a03,a10,a11,a12,a13,a20,a21,a22,a23,x=v[0],y=v[1],z=v[2];return a===out?(out[12]=a[0]*x+a[4]*y+a[8]*z+a[12],out[13]=a[1]*x+a[5]*y+a[9]*z+a[13],out[14]=a[2]*x+a[6]*y+a[10]*z+a[14],out[15]=a[3]*x+a[7]*y+a[11]*z+a[15]):(a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],out[0]=a00,out[1]=a01,out[2]=a02,out[3]=a03,out[4]=a10,out[5]=a11,out[6]=a12,out[7]=a13,out[8]=a20,out[9]=a21,out[10]=a22,out[11]=a23,out[12]=a00*x+a10*y+a20*z+a[12],out[13]=a01*x+a11*y+a21*z+a[13],out[14]=a02*x+a12*y+a22*z+a[14],out[15]=a03*x+a13*y+a23*z+a[15]),out}(view,view,parameters.offset),function mat4_invert(out,a){var a00=a[0],a01=a[1],a02=a[2],a03=a[3],a10=a[4],a11=a[5],a12=a[6],a13=a[7],a20=a[8],a21=a[9],a22=a[10],a23=a[11],a30=a[12],a31=a[13],a32=a[14],a33=a[15],b00=a00*a11-a01*a10,b01=a00*a12-a02*a10,b02=a00*a13-a03*a10,b03=a01*a12-a02*a11,b04=a01*a13-a03*a11,b05=a02*a13-a03*a12,b06=a20*a31-a21*a30,b07=a20*a32-a22*a30,b08=a20*a33-a23*a30,b09=a21*a32-a22*a31,b10=a21*a33-a23*a31,b11=a22*a33-a23*a32,det=b00*b11-b01*b10+b02*b09+b03*b08-b04*b07+b05*b06;return det?(det=1/det,out[0]=(a11*b11-a12*b10+a13*b09)*det,out[1]=(a02*b10-a01*b11-a03*b09)*det,out[2]=(a31*b05-a32*b04+a33*b03)*det,out[3]=(a22*b04-a21*b05-a23*b03)*det,out[4]=(a12*b08-a10*b11-a13*b07)*det,out[5]=(a00*b11-a02*b08+a03*b07)*det,out[6]=(a32*b02-a30*b05-a33*b01)*det,out[7]=(a20*b05-a22*b02+a23*b01)*det,out[8]=(a10*b10-a11*b08+a13*b06)*det,out[9]=(a01*b08-a00*b10-a03*b06)*det,out[10]=(a30*b04-a31*b02+a33*b00)*det,out[11]=(a21*b02-a20*b04-a23*b00)*det,out[12]=(a11*b07-a10*b09-a12*b06)*det,out[13]=(a00*b09-a01*b07+a02*b06)*det,out[14]=(a31*b01-a30*b03-a32*b00)*det,out[15]=(a20*b03-a21*b01+a22*b00)*det,out):null}(view,view)}return function(frameData,pose,vrDisplay){return!(!frameData||!pose)&&(frameData.pose=pose,frameData.timestamp=pose.timestamp,updateEyeMatrices(frameData.leftProjectionMatrix,frameData.leftViewMatrix,pose,vrDisplay.getEyeParameters("left"),vrDisplay),updateEyeMatrices(frameData.rightProjectionMatrix,frameData.rightViewMatrix,pose,vrDisplay.getEyeParameters("right"),vrDisplay),!0)}}(),Util.isInsideCrossDomainIFrame=function(){var isFramed=window.self!==window.top,refDomain=Util.getDomainFromUrl(document.referrer),thisDomain=Util.getDomainFromUrl(window.location.href);return isFramed&&refDomain!==thisDomain},Util.getDomainFromUrl=function(url){return(url.indexOf("://")>-1?url.split("/")[2]:url.split("/")[0]).split(":")[0]};var util$1=Util;function PosePredictor(predictionTimeS){this.predictionTimeS=predictionTimeS,this.previousQ=new mathUtil.Quaternion,this.previousTimestampS=null,this.deltaQ=new mathUtil.Quaternion,this.outQ=new mathUtil.Quaternion}PosePredictor.prototype.getPrediction=function(currentQ,gyro,timestampS){if(!this.previousTimestampS)return this.previousQ.copy(currentQ),this.previousTimestampS=timestampS,currentQ;var axis=new mathUtil.Vector3;axis.copy(gyro),axis.normalize();var angularSpeed=gyro.length();if(angularSpeed<20*mathUtil.degToRad)return util$1.isDebug()&&console.log("Moving slowly, at %s deg/s: no prediction",(mathUtil.radToDeg*angularSpeed).toFixed(1)),this.outQ.copy(currentQ),this.previousQ.copy(currentQ),this.outQ;this.previousTimestampS;var predictAngle=angularSpeed*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(axis,predictAngle),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(currentQ),this.previousTimestampS=timestampS,this.outQ};var posePredictor=PosePredictor,view360_esm_version=-1,branch=null,build=null,match=/Chrome\/([0-9]+)\.(?:[0-9]*)\.([0-9]*)\.([0-9]*)/i.exec(userAgent);match&&(view360_esm_version=parseInt(match[1],10),branch=match[2],build=match[3]);var CHROME_VERSION=view360_esm_version,IS_CHROME_WITHOUT_DEVICE_MOTION=65===view360_esm_version&&"3325"===branch&&parseInt(build,10)<148,IS_ANDROID=/Android/i.test(userAgent),MC_BIND_SCALE=[.2,.2],GYRO_MODE={NONE:"none",YAWPITCH:"yawPitch",VR:"VR"},view360_esm_DeviceMotion=function(_super){function DeviceMotion(){var _this=_super.call(this)||this;return _this._onDeviceMotion=_this._onDeviceMotion.bind(_this),_this._onDeviceOrientation=_this._onDeviceOrientation.bind(_this),_this._onChromeWithoutDeviceMotion=_this._onChromeWithoutDeviceMotion.bind(_this),_this.isWithoutDeviceMotion=IS_CHROME_WITHOUT_DEVICE_MOTION,_this.isAndroid=IS_ANDROID,_this.stillGyroVec=vec3_namespaceObject.create(),_this.rawGyroVec=vec3_namespaceObject.create(),_this.adjustedGyroVec=vec3_namespaceObject.create(),_this._timer=-1,_this.lastDevicemotionTimestamp=0,_this._isEnabled=!1,_this.enable(),_this}view360_esm_extends(DeviceMotion,_super);var __proto=DeviceMotion.prototype;return __proto.enable=function(){this.isAndroid&&view360_esm_win.addEventListener("deviceorientation",this._onDeviceOrientation),this.isWithoutDeviceMotion?view360_esm_win.addEventListener("deviceorientation",this._onChromeWithoutDeviceMotion):view360_esm_win.addEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!0},__proto.disable=function(){view360_esm_win.removeEventListener("deviceorientation",this._onDeviceOrientation),view360_esm_win.removeEventListener("deviceorientation",this._onChromeWithoutDeviceMotion),view360_esm_win.removeEventListener("devicemotion",this._onDeviceMotion),this._isEnabled=!1},__proto._onChromeWithoutDeviceMotion=function(e){var alpha=e.alpha,beta=e.beta,gamma=e.gamma;null!==alpha&&(alpha=(alpha||0)*Math.PI/180,beta=(beta||0)*Math.PI/180,gamma=(gamma||0)*Math.PI/180,this.trigger("devicemotion",{inputEvent:{deviceorientation:{alpha:alpha,beta:beta,gamma:-gamma}}}))},__proto._onDeviceOrientation=function(){var _this=this;this._timer&&clearTimeout(this._timer),this._timer=view360_esm_win.setTimeout((function(){(new Date).getTime()-_this.lastDevicemotionTimestamp<200&&vec3_namespaceObject.copy(_this.stillGyroVec,_this.rawGyroVec)}),200)},__proto._onDeviceMotion=function(e){var isGyroSensorAvailable=!(null==e.rotationRate.alpha),isGravitySensorAvailable=!(null==e.accelerationIncludingGravity.x);if(0!==e.interval&&isGyroSensorAvailable&&isGravitySensorAvailable){var devicemotionEvent=view360_esm_assign({},e);devicemotionEvent.interval=e.interval,devicemotionEvent.timeStamp=e.timeStamp,devicemotionEvent.type=e.type,devicemotionEvent.rotationRate={alpha:e.rotationRate.alpha,beta:e.rotationRate.beta,gamma:e.rotationRate.gamma},devicemotionEvent.accelerationIncludingGravity={x:e.accelerationIncludingGravity.x,y:e.accelerationIncludingGravity.y,z:e.accelerationIncludingGravity.z},devicemotionEvent.acceleration={x:e.acceleration.x,y:e.acceleration.y,z:e.acceleration.z},this.isAndroid&&(vec3_namespaceObject.set(this.rawGyroVec,e.rotationRate.alpha||0,e.rotationRate.beta||0,e.rotationRate.gamma||0),vec3_namespaceObject.subtract(this.adjustedGyroVec,this.rawGyroVec,this.stillGyroVec),this.lastDevicemotionTimestamp=(new Date).getTime(),devicemotionEvent.adjustedRotationRate={alpha:this.adjustedGyroVec[0],beta:this.adjustedGyroVec[1],gamma:this.adjustedGyroVec[2]}),this.trigger("devicemotion",{inputEvent:devicemotionEvent})}},DeviceMotion}(component_esm);function SensorSample(sample,timestampS){this.set(sample,timestampS)}var __proto$1=SensorSample.prototype;__proto$1.set=function(sample,timestampS){this.sample=sample,this.timestampS=timestampS},__proto$1.copy=function(sensorSample){this.set(sensorSample.sample,sensorSample.timestampS)};var sensorSample=SensorSample;function ComplementaryFilter(kFilter){this.kFilter=kFilter,this.currentAccelMeasurement=new sensorSample,this.currentGyroMeasurement=new sensorSample,this.previousGyroMeasurement=new sensorSample,util$1.isIOS()?this.filterQ=new mathUtil.Quaternion(-1,0,0,1):this.filterQ=new mathUtil.Quaternion(1,0,0,1),this.previousFilterQ=new mathUtil.Quaternion,this.previousFilterQ.copy(this.filterQ),this.accelQ=new mathUtil.Quaternion,this.isOrientationInitialized=!1,this.estimatedGravity=new mathUtil.Vector3,this.measuredGravity=new mathUtil.Vector3,this.gyroIntegralQ=new mathUtil.Quaternion}var __proto$2=ComplementaryFilter.prototype;__proto$2.addAccelMeasurement=function(vector,timestampS){this.currentAccelMeasurement.set(vector,timestampS)},__proto$2.addGyroMeasurement=function(vector,timestampS){this.currentGyroMeasurement.set(vector,timestampS);var deltaT=timestampS-this.previousGyroMeasurement.timestampS;util$1.isTimestampDeltaValid(deltaT)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},__proto$2.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var deltaT=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,gyroDeltaQ=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,deltaT);this.gyroIntegralQ.multiply(gyroDeltaQ),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(gyroDeltaQ);var invFilterQ=new mathUtil.Quaternion;invFilterQ.copy(this.filterQ),invFilterQ.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(invFilterQ),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var deltaQ=new mathUtil.Quaternion;deltaQ.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),deltaQ.inverse(),util$1.isDebug()&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",mathUtil.radToDeg*util$1.getQuaternionAngle(deltaQ),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var targetQ=new mathUtil.Quaternion;targetQ.copy(this.filterQ),targetQ.multiply(deltaQ),this.filterQ.slerp(targetQ,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},__proto$2.getOrientation=function(){return this.filterQ},__proto$2.accelToQuaternion_=function(accel){var normAccel=new mathUtil.Vector3;normAccel.copy(accel),normAccel.normalize();var quat=new mathUtil.Quaternion;return quat.setFromUnitVectors(new mathUtil.Vector3(0,0,-1),normAccel),quat.inverse(),quat},__proto$2.gyroToQuaternionDelta_=function(gyro,dt){var quat=new mathUtil.Quaternion,axis=new mathUtil.Vector3;return axis.copy(gyro),axis.normalize(),quat.setFromAxisAngle(axis,gyro.length()*dt),quat};var complementaryFilter=ComplementaryFilter;complementaryFilter.prototype.run_=function(){if(!this.isOrientationInitialized)return this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),void(this.isOrientationInitialized=!0);var deltaT=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,gyroDeltaQ=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,deltaT);this.gyroIntegralQ.multiply(gyroDeltaQ),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(gyroDeltaQ);var invFilterQ=new mathUtil.Quaternion;invFilterQ.copy(this.filterQ),invFilterQ.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(invFilterQ),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var deltaQ=new mathUtil.Quaternion;deltaQ.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),deltaQ.inverse();var targetQ=new mathUtil.Quaternion;targetQ.copy(this.filterQ),targetQ.multiply(deltaQ),this.filterQ.slerp(targetQ,1-this.kFilter),this.previousFilterQ.copy(this.filterQ),this.isFilterQuaternionInitialized||(this.isFilterQuaternionInitialized=!0)},complementaryFilter.prototype.getOrientation=function(){return this.isFilterQuaternionInitialized?this.filterQ:null};var view360_esm_FusionPoseSensor=function(_super){function FusionPoseSensor(){var _this=_super.call(this)||this;return _this.deviceMotion=new view360_esm_DeviceMotion,_this.accelerometer=new mathUtil.Vector3,_this.gyroscope=new mathUtil.Vector3,_this._onDeviceMotionChange=_this._onDeviceMotionChange.bind(_this),_this._onScreenOrientationChange=_this._onScreenOrientationChange.bind(_this),_this.filter=new complementaryFilter(.98),_this.posePredictor=new posePredictor(.04),_this.filterToWorldQ=new mathUtil.Quaternion,_this.isFirefoxAndroid=util$1.isFirefoxAndroid(),_this.isIOS=IS_IOS||IS_SAFARI_ON_DESKTOP,_this.isChromeUsingDegrees=CHROME_VERSION>=66,_this._isEnabled=!1,_this.isIOS?_this.filterToWorldQ.setFromAxisAngle(new mathUtil.Vector3(1,0,0),Math.PI/2):_this.filterToWorldQ.setFromAxisAngle(new mathUtil.Vector3(1,0,0),-Math.PI/2),_this.inverseWorldToScreenQ=new mathUtil.Quaternion,_this.worldToScreenQ=new mathUtil.Quaternion,_this.originalPoseAdjustQ=new mathUtil.Quaternion,_this.originalPoseAdjustQ.setFromAxisAngle(new mathUtil.Vector3(0,0,1),-view360_esm_win.orientation*Math.PI/180),_this._setScreenTransform(),util$1.isLandscapeMode()&&_this.filterToWorldQ.multiply(_this.inverseWorldToScreenQ),_this.resetQ=new mathUtil.Quaternion,_this.deviceMotion.on("devicemotion",_this._onDeviceMotionChange),_this.enable(),_this}view360_esm_extends(FusionPoseSensor,_super);var __proto=FusionPoseSensor.prototype;return __proto.enable=function(){this.isEnabled()||(this.deviceMotion.enable(),this._isEnabled=!0,view360_esm_win.addEventListener("orientationchange",this._onScreenOrientationChange))},__proto.disable=function(){this.isEnabled()&&(this.deviceMotion.disable(),this._isEnabled=!1,view360_esm_win.removeEventListener("orientationchange",this._onScreenOrientationChange))},__proto.isEnabled=function(){return this._isEnabled},__proto.destroy=function(){this.disable(),this.deviceMotion=null},__proto.getOrientation=function(){var orientation,_this=this;if(this.deviceMotion.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||(new mathUtil.Quaternion).setFromAxisAngle(new mathUtil.Vector3(0,1,0),-_this._alpha),orientation=this._deviceOrientationQ,(out=new mathUtil.Quaternion).copy(orientation),out.multiply(this.filterToWorldQ),out.multiply(this.resetQ),out.multiply(this.worldToScreenQ),out.multiplyQuaternions(this.deviceOrientationFixQ,out);var out_=quat_namespaceObject.fromValues(out.x,out.y,out.z,out.w);return quat_namespaceObject.normalize(out_,out_)}if(!(orientation=this.filter.getOrientation()))return null;var out=this._convertFusionToPredicted(orientation);out_=quat_namespaceObject.fromValues(out.x,out.y,out.z,out.w);return quat_namespaceObject.normalize(out_,out_)},__proto._triggerChange=function(){var orientation=this.getOrientation();orientation&&(this._prevOrientation?quat_namespaceObject.equals(this._prevOrientation,orientation)||this.trigger("change",{quaternion:orientation}):this._prevOrientation=orientation)},__proto._convertFusionToPredicted=function(orientation){this.predictedQ=this.posePredictor.getPrediction(orientation,this.gyroscope,this.previousTimestampS);var out=new mathUtil.Quaternion;return out.copy(this.filterToWorldQ),out.multiply(this.resetQ),out.multiply(this.predictedQ),out.multiply(this.worldToScreenQ),out},__proto._onDeviceMotionChange=function(_a){var inputEvent=_a.inputEvent,deviceorientation=inputEvent.deviceorientation,deviceMotion=inputEvent,accGravity=deviceMotion.accelerationIncludingGravity,rotRate=deviceMotion.adjustedRotationRate||deviceMotion.rotationRate,timestampS=deviceMotion.timeStamp/1e3;deviceorientation?(this._alpha||(this._alpha=deviceorientation.alpha),this._deviceOrientationQ=this._deviceOrientationQ||new mathUtil.Quaternion,this._deviceOrientationQ.setFromEulerYXZ(deviceorientation.beta,deviceorientation.alpha,deviceorientation.gamma),this._triggerChange()):(this.isFirefoxAndroid&&(timestampS/=1e3),this.accelerometer.set(-accGravity.x,-accGravity.y,-accGravity.z),this.gyroscope.set(rotRate.alpha,rotRate.beta,rotRate.gamma),(this.isIOS||this.isFirefoxAndroid||this.isChromeUsingDegrees)&&this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addAccelMeasurement(this.accelerometer,timestampS),this.filter.addGyroMeasurement(this.gyroscope,timestampS),this._triggerChange(),this.previousTimestampS=timestampS)},__proto._onScreenOrientationChange=function(){this._setScreenTransform()},__proto._setScreenTransform=function(){this.worldToScreenQ.set(0,0,0,1);var orientation=view360_esm_win.orientation;switch(orientation){case 0:break;case 90:case-90:case 180:this.worldToScreenQ.setFromAxisAngle(new mathUtil.Vector3(0,0,1),orientation/-180*Math.PI)}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},FusionPoseSensor}(component_esm);function getDeltaPitch(prvQ,curQ){return util.getRotationDelta(prvQ,curQ,ROTATE_CONSTANT.PITCH_DELTA)}var latIdx,view360_esm_lngIdx,view360_esm_TiltMotionInput=function(_super){function TiltMotionInput(el,options){void 0===options&&(options={});var _this=_super.call(this)||this;return _this.element=el,_this._prevQuaternion=null,_this._quaternion=null,_this.fusionPoseSensor=null,_this.options=view360_esm_assign({scale:1,threshold:0},options),_this._onPoseChange=_this._onPoseChange.bind(_this),_this}view360_esm_extends(TiltMotionInput,_super);var __proto=TiltMotionInput.prototype;return __proto.mapAxes=function(axes){this.axes=axes},__proto.connect=function(observer){return this.observer?this:(this.observer=observer,this.fusionPoseSensor=new view360_esm_FusionPoseSensor,this.fusionPoseSensor.enable(),this._attachEvent(),this)},__proto.disconnect=function(){return this.observer?(this._dettachEvent(),this.fusionPoseSensor.disable(),this.fusionPoseSensor.destroy(),this.fusionPoseSensor=null,this.observer=null,this):this},__proto.destroy=function(){this.disconnect(),this.element=null,this.options=null,this.axes=null,this._prevQuaternion=null,this._quaternion=null},__proto._onPoseChange=function(event){if(!this._prevQuaternion)return this._prevQuaternion=quat_namespaceObject.clone(event.quaternion),void(this._quaternion=quat_namespaceObject.clone(event.quaternion));var prvQ,curQ,yawDeltaByYaw;quat_namespaceObject.copy(this._prevQuaternion,this._quaternion),quat_namespaceObject.copy(this._quaternion,event.quaternion),this.observer.change(this,event,function view360_esm_toAxis(source,offset){return offset.reduce((function(acc,v,i){return source[i]&&(acc[source[i]]=v),acc}),{})}(this.axes,[(prvQ=this._prevQuaternion,curQ=this._quaternion,yawDeltaByYaw=util.getRotationDelta(prvQ,curQ,ROTATE_CONSTANT.YAW_DELTA_BY_YAW),util.getRotationDelta(prvQ,curQ,ROTATE_CONSTANT.YAW_DELTA_BY_ROLL)*Math.sin(util.extractPitchFromQuat(curQ))+yawDeltaByYaw),getDeltaPitch(this._prevQuaternion,this._quaternion)]))},__proto._attachEvent=function(){this.fusionPoseSensor.on("change",this._onPoseChange)},__proto._dettachEvent=function(){this.fusionPoseSensor.off("change",this._onPoseChange)},TiltMotionInput}(component_esm),screenRotationAngleInst=null,refCount=0,view360_esm_ScreenRotationAngle=function(){function ScreenRotationAngle(){if(refCount++,screenRotationAngleInst)return screenRotationAngleInst;screenRotationAngleInst=this,this._onDeviceOrientation=this._onDeviceOrientation.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._spinR=0,this._screenOrientationAngle=0,view360_esm_win.addEventListener("deviceorientation",this._onDeviceOrientation),view360_esm_win.addEventListener("orientationchange",this._onOrientationChange)}var __proto=ScreenRotationAngle.prototype;return __proto.getRadian=function(){return this._spinR+common_namespaceObject.toRadian(this._screenOrientationAngle)},__proto.unref=function(){--refCount>0||(view360_esm_win.removeEventListener("deviceorientation",this._onDeviceOrientation),view360_esm_win.removeEventListener("orientationchange",this._onOrientationChange),this._spinR=0,this._screenOrientationAngle=0,screenRotationAngleInst=null,refCount=0)},__proto._onDeviceOrientation=function(e){if(null!==e.beta&&null!==e.gamma){var betaR=common_namespaceObject.toRadian(e.beta),gammaR=common_namespaceObject.toRadian(e.gamma);this._spinR=Math.atan2(Math.cos(betaR)*Math.sin(gammaR),Math.sin(betaR))}},__proto._onOrientationChange=function(e){view360_esm_win.screen&&view360_esm_win.screen.orientation&&void 0!==view360_esm_win.screen.orientation.angle?this._screenOrientationAngle=screen.orientation.angle:void 0!==view360_esm_win.orientation&&(this._screenOrientationAngle=view360_esm_win.orientation>=0?view360_esm_win.orientation:360+view360_esm_win.orientation)},ScreenRotationAngle}(),view360_esm_RotationPanInput=function(_super){function RotationPanInput(el,options){void 0===options&&(options={});var _this=_super.call(this,el,options)||this;return _this._useRotation=!1,_this._screenRotationAngle=null,_this.setUseRotation(!(!options||!options.useRotation)),_this._userDirection=axes_esm.DIRECTION_ALL,_this}view360_esm_extends(RotationPanInput,_super);var __proto=RotationPanInput.prototype;return __proto.setUseRotation=function(useRotation){this._useRotation=useRotation,this._screenRotationAngle&&(this._screenRotationAngle.unref(),this._screenRotationAngle=null),this._useRotation&&(this._screenRotationAngle=new view360_esm_ScreenRotationAngle)},__proto.connect=function(observer){return this._userDirection=this._direction,this._useRotation&&this._direction&axes_esm.DIRECTION_ALL&&(this._direction=axes_esm.DIRECTION_HORIZONTAL),_super.prototype.connect.call(this,observer)},__proto.destroy=function(){this._useRotation&&this._screenRotationAngle&&this._screenRotationAngle.unref(),_super.prototype.destroy.call(this)},__proto.getOffset=function(properties,useDirection){if(!1===this._useRotation)return _super.prototype.getOffset.call(this,properties,useDirection);var offset=_super.prototype.getOffset.call(this,properties,[!0,!0]),newOffset=[0,0],theta=this._screenRotationAngle.getRadian(),cosTheta=Math.cos(theta),sinTheta=Math.sin(theta);return newOffset[0]=offset[0]*cosTheta-offset[1]*sinTheta,newOffset[1]=offset[1]*cosTheta+offset[0]*sinTheta,this._userDirection&axes_esm.DIRECTION_HORIZONTAL?this._userDirection&axes_esm.DIRECTION_VERTICAL||(newOffset[1]=0):newOffset[0]=0,newOffset},RotationPanInput}(axes_esm_PanInput),Y_AXIS_VECTOR=vec3_namespaceObject.fromValues(0,1,0),view360_esm_DeviceQuaternion=function(_super){function DeviceQuaternion(){var _this=_super.call(this)||this;return _this._fusionPoseSensor=new view360_esm_FusionPoseSensor,_this._quaternion=quat_namespaceObject.create(),_this._fusionPoseSensor.enable(),_this._fusionPoseSensor.on("change",(function(e){_this._quaternion=e.quaternion,_this.trigger("change",{isTrusted:!0})})),_this}view360_esm_extends(DeviceQuaternion,_super);var __proto=DeviceQuaternion.prototype;return __proto.getCombinedQuaternion=function(yaw){var yawQ=quat_namespaceObject.setAxisAngle(quat_namespaceObject.create(),Y_AXIS_VECTOR,common_namespaceObject.toRadian(-yaw)),conj=quat_namespaceObject.conjugate(quat_namespaceObject.create(),this._quaternion);return quat_namespaceObject.multiply(quat_namespaceObject.create(),conj,yawQ)},__proto.destroy=function(){this.off(),this._fusionPoseSensor&&(this._fusionPoseSensor.off(),this._fusionPoseSensor.destroy(),this._fusionPoseSensor=null)},DeviceQuaternion}(component_esm),DEFAULT_YAW_RANGE=[-180,180],DEFAULT_PITCH_RANGE=[-90,90],CIRCULAR_PITCH_RANGE=[-180,180],view360_esm_YawPitchControl=function(_super){function YawPitchControl(options){var _this=_super.call(this)||this,opt=view360_esm_assign({element:null,yaw:0,pitch:0,fov:65,showPolePoint:!1,useZoom:!0,useKeyboard:!0,gyroMode:GYRO_MODE.YAWPITCH,touchDirection:6,yawRange:DEFAULT_YAW_RANGE,pitchRange:DEFAULT_PITCH_RANGE,fovRange:[30,110],aspectRatio:1},options);return _this._element=opt.element,_this._initialFov=opt.fov,_this._enabled=!1,_this._isAnimating=!1,_this._deviceQuaternion=null,_this._initAxes(opt),_this.option(opt),_this}view360_esm_extends(YawPitchControl,_super);var __proto=YawPitchControl.prototype;return __proto.updatePanScale=function(param){void 0===param&&(param={});var fov=this.axes.get().fov,areaHeight=param.height||parseInt(window.getComputedStyle(this._element).height,10),scale=MC_BIND_SCALE[0]*fov/this._initialFov*320/areaHeight;return this.axesPanInput.options.scale=[scale,scale],this.axes.options.deceleration=.0014*fov/110,this},__proto.option=function(key,newValue){if(!key)return this._getOptions();if(key&&"string"==typeof key&&void 0===newValue)return this._getOptions(key);var newOptions={},changedKeyList=[];if("string"==typeof key)changedKeyList.push(key),newOptions[key]=newValue;else{var options=key;changedKeyList=Object.keys(options),newOptions=view360_esm_assign({},options)}return this._setOptions(this._getValidatedOptions(newOptions)),this._applyOptions(changedKeyList),this},__proto.enable=function(){return this._enabled?this:(this._enabled=!0,this._applyOptions(Object.keys(this.options)),this.updatePanScale(),this)},__proto.disable=function(persistOrientation){return void 0===persistOrientation&&(persistOrientation=!1),this._enabled?(persistOrientation||this._resetOrientation(),this.axes.disconnect(),this._enabled=!1,this):this},__proto.lookAt=function(_a,duration){var yaw=_a.yaw,pitch=_a.pitch,fov=_a.fov,pos=this.axes.get(),y=void 0===yaw?0:yaw-pos.yaw,p=void 0===pitch?0:pitch-pos.pitch,f=void 0===fov?0:fov-pos.fov;this.axes.options.maximumDuration=1/0,this.axes.setBy({yaw:y,pitch:p,fov:f},duration)},__proto.getYawPitch=function(){var yawPitch=this.axes.get();return{yaw:yawPitch.yaw,pitch:yawPitch.pitch}},__proto.getFov=function(){return this.axes.get().fov},__proto.getQuaternion=function(){var pos=this.axes.get();return this._deviceQuaternion.getCombinedQuaternion(pos.yaw)},__proto.shouldRenderWithQuaternion=function(){return this.options.gyroMode===GYRO_MODE.VR},__proto.destroy=function(){this.axes&&this.axes.destroy(),this.axesPanInput&&this.axesPanInput.destroy(),this.axesWheelInput&&this.axesWheelInput.destroy(),this.axesTiltMotionInput&&this.axesTiltMotionInput.destroy(),this.axesPinchInput&&this.axesPinchInput.destroy(),this.axesMoveKeyInput&&this.axesMoveKeyInput.destroy(),this._deviceQuaternion&&this._deviceQuaternion.destroy()},__proto._initAxes=function(opt){var _this=this,yRange=this._updateYawRange(opt.yawRange,opt.fov,opt.aspectRatio),pRange=this._updatePitchRange(opt.pitchRange,opt.fov,opt.showPolePoint),useRotation=opt.gyroMode===GYRO_MODE.VR;this.axesPanInput=new view360_esm_RotationPanInput(this._element,{useRotation:useRotation}),this.axesWheelInput=new WheelInput(this._element,{scale:-4}),this.axesTiltMotionInput=null,this.axesPinchInput=view360_esm_SUPPORT_TOUCH?new axes_esm_PinchInput(this._element,{scale:-1}):null,this.axesMoveKeyInput=new MoveKeyInput(this._element,{scale:[-6,6]}),this.axes=new axes_esm({yaw:{range:yRange,circular:this._isCircular(yRange),bounce:[0,0]},pitch:{range:pRange,circular:this._isCircular(pRange),bounce:[0,0]},fov:{range:opt.fovRange,circular:[!1,!1],bounce:[0,0]}},{deceleration:.0014,maximumDuration:1e3},{yaw:opt.yaw,pitch:opt.pitch,fov:opt.fov}).on({hold:function(evt){_this.axes.options.maximumDuration=1e3,_this.trigger("hold",{isTrusted:evt.isTrusted})},change:function(evt){0!==evt.delta.fov&&(_this._updateControlScale(evt),_this.updatePanScale()),_this._triggerChange(evt)},release:function(evt){_this._triggerChange(evt)},animationEnd:function(evt){_this.trigger("animationEnd",{isTrusted:evt.isTrusted})}})},__proto._getValidatedOptions=function(newOptions){return newOptions.yawRange&&(newOptions.yawRange=this._getValidYawRange(newOptions.yawRange,newOptions.fov,newOptions.aspectRatio)),newOptions.pitchRange&&(newOptions.pitchRange=this._getValidPitchRange(newOptions.pitchRange,newOptions.fov)),newOptions},__proto._getOptions=function(key){var value;return"string"==typeof key?value=this.options[key]:0===arguments.length&&(value=this.options),value},__proto._setOptions=function(options){for(var key in options)this.options[key]=options[key]},__proto._applyOptions=function(keys){var options=this.options,axes=this.axes,isVR=options.gyroMode===GYRO_MODE.VR,isYawPitch=options.gyroMode===GYRO_MODE.YAWPITCH,touchDirection=isVR?2&options.touchDirection:options.touchDirection;if(keys.some((function(key){return"showPolePoint"===key||"fov"===key||"aspectRatio"===key||"yawRange"===key||"pitchRange"===key}))&&(keys.indexOf("fov")>=0&&(axes.setTo({fov:options.fov}),this.updatePanScale()),this._updateControlScale()),keys.some((function(key){return"fovRange"===key}))){var fovRange=options.fovRange,prevFov=axes.get().fov,nextFov=axes.get().fov;vec2_namespaceObject.copy(axes.axis.fov.range,fovRange),nextFov<fovRange[0]?nextFov=fovRange[0]:prevFov>fovRange[1]&&(nextFov=fovRange[1]),prevFov!==nextFov&&(axes.setTo({fov:nextFov},0),this._updateControlScale(),this.updatePanScale())}(keys.some((function(key){return"gyroMode"===key}))&&SUPPORT_DEVICEMOTION&&(this.axesTiltMotionInput&&(this.axes.disconnect(this.axesTiltMotionInput),this.axesTiltMotionInput.destroy(),this.axesTiltMotionInput=null),this._deviceQuaternion&&(this._deviceQuaternion.destroy(),this._deviceQuaternion=null),isVR?this._initDeviceQuaternion():isYawPitch&&(this.axesTiltMotionInput=new view360_esm_TiltMotionInput(this._element),this.axes.connect(["yaw","pitch"],this.axesTiltMotionInput)),this.axesPanInput.setUseRotation(isVR)),keys.some((function(key){return"useKeyboard"===key})))&&(options.useKeyboard?axes.connect(["yaw","pitch"],this.axesMoveKeyInput):axes.disconnect(this.axesMoveKeyInput));if(keys.some((function(key){return"useZoom"===key}))){var useZoom=options.useZoom;axes.disconnect(this.axesWheelInput),useZoom&&axes.connect(["fov"],this.axesWheelInput)}this._togglePinchInputByOption(options.touchDirection,options.useZoom),keys.some((function(key){return"touchDirection"===key}))&&this._enabled&&this._enableTouch(touchDirection)},__proto._togglePinchInputByOption=function(touchDirection,useZoom){this.axesPinchInput&&(this.axes.disconnect(this.axesPinchInput),useZoom&&6===touchDirection&&-1===this.axes._inputs.indexOf(this.axesPinchInput)&&this.axes.connect(["fov"],this.axesPinchInput))},__proto._enableTouch=function(direction){this.axesPanInput&&this.axes.disconnect(this.axesPanInput);var yawEnabled=2&direction?"yaw":null,pitchEnabled=4&direction?"pitch":null;this.axes.connect([yawEnabled,pitchEnabled],this.axesPanInput)},__proto._initDeviceQuaternion=function(){var _this=this;this._deviceQuaternion=new view360_esm_DeviceQuaternion,this._deviceQuaternion.on("change",(function(e){_this._triggerChange(e)}))},__proto._getValidYawRange=function(newYawRange,newFov,newAspectRatio){var ratio=this._adjustAspectRatio(newAspectRatio||this.options.aspectRatio||1),horizontalFov=(newFov||this.axes.get().fov)*ratio;return newYawRange[1]-newYawRange[0]>=horizontalFov?newYawRange:this.options.yawRange||DEFAULT_YAW_RANGE},__proto._getValidPitchRange=function(newPitchRange,newFov){var fov=newFov||this.axes.get().fov;return newPitchRange[1]-newPitchRange[0]>=fov?newPitchRange:this.options.pitchRange||DEFAULT_PITCH_RANGE},__proto._isCircular=function(range){return range[1]-range[0]<360?[!1,!1]:[!0,!0]},__proto._updateControlScale=function(changeEvt){var opt=this.options,fov=this.axes.get().fov,pRange=this._updatePitchRange(opt.pitchRange,fov,opt.showPolePoint),yRange=this._updateYawRange(opt.yawRange,fov,opt.aspectRatio),pos=this.axes.get(),y=pos.yaw,p=pos.pitch;return vec2_namespaceObject.copy(this.axes.axis.yaw.range,yRange),vec2_namespaceObject.copy(this.axes.axis.pitch.range,pRange),this.axes.axis.yaw.circular=this._isCircular(yRange),this.axes.axis.pitch.circular=this._isCircular(pRange),y<yRange[0]?y=yRange[0]:y>yRange[1]&&(y=yRange[1]),p<pRange[0]?p=pRange[0]:p>pRange[1]&&(p=pRange[1]),changeEvt&&changeEvt.set({yaw:y,pitch:p}),this.axes.setTo({yaw:y,pitch:p},0),this},__proto._updatePitchRange=function(pitchRange,fov,showPolePoint){if(this.options.gyroMode===GYRO_MODE.VR)return CIRCULAR_PITCH_RANGE;var verticalAngle=pitchRange[1]-pitchRange[0],halfFov=fov/2;return showPolePoint&&!(verticalAngle<180)?pitchRange.concat():[pitchRange[0]+halfFov,pitchRange[1]-halfFov]},__proto._updateYawRange=function(yawRange,fov,aspectRatio){if(this.options.gyroMode===GYRO_MODE.VR)return DEFAULT_YAW_RANGE;if(yawRange[1]-yawRange[0]>=360)return yawRange.concat();var halfHorizontalFov=util.toDegree(Math.atan2(aspectRatio,1/Math.tan(common_namespaceObject.toRadian(fov/2))));return[yawRange[0]+halfHorizontalFov,yawRange[1]-halfHorizontalFov]},__proto._triggerChange=function(evt){var pos=this.axes.get(),opt=this.options,event={targetElement:opt.element,isTrusted:evt.isTrusted,yaw:pos.yaw,pitch:pos.pitch,fov:pos.fov,quaternion:null};opt.gyroMode===GYRO_MODE.VR&&this._deviceQuaternion&&(event.quaternion=this._deviceQuaternion.getCombinedQuaternion(pos.yaw)),this.trigger("change",event)},__proto._adjustAspectRatio=function(input){for(var inputRange=[.52,.54,.563,.57,.584,.59,.609,.67,.702,.72,.76,.78,.82,.92,.97,1,1.07,1.14,1.19,1.25,1.32,1.38,1.4,1.43,1.53,1.62,1.76,1.77,1.86,1.96,2.26,2.3,2.6,3,5,6],outputRange=[.51,.54,.606,.56,.628,.63,.647,.71,.736,.757,.78,.77,.8,.89,.975,1,1.07,1.1,1.15,1.18,1.22,1.27,1.3,1.33,1.39,1.45,1.54,1.55,1.58,1.62,1.72,1.82,1.92,2,2.24,2.3],rangeIdx=-1,i=0;i<inputRange.length-1;i++)if(inputRange[i]<=input&&inputRange[i+1]>=input){rangeIdx=i;break}if(-1===rangeIdx)return inputRange[0]>input?outputRange[0]:outputRange[outputRange[0].length-1];var inputA=inputRange[rangeIdx],inputB=inputRange[rangeIdx+1],outputA=outputRange[rangeIdx],outputB=outputRange[rangeIdx+1];return this._lerp(outputA,outputB,(input-inputA)/(inputB-inputA))},__proto._lerp=function(a,b,fraction){return a+fraction*(b-a)},__proto._resetOrientation=function(){var opt=this.options;return this.axes.setTo({yaw:opt.yaw,pitch:opt.pitch,fov:opt.fov},0),this},YawPitchControl.VERSION="3.4.3",YawPitchControl.CONTROL_MODE_VR=1,YawPitchControl.CONTROL_MODE_YAWPITCH=2,YawPitchControl.TOUCH_DIRECTION_ALL=6,YawPitchControl.TOUCH_DIRECTION_YAW=2,YawPitchControl.TOUCH_DIRECTION_PITCH=4,YawPitchControl.TOUCH_DIRECTION_NONE=1,YawPitchControl}(component_esm),WEBGL_ERROR_CODE={0:"NO_ERROR",1280:"INVALID_ENUM",1281:"INVALID_VALUE",1282:"INVALID_OPERATION",1285:"OUT_OF_MEMORY",1286:"INVALID_FRAMEBUFFER_OPERATION",37442:"CONTEXT_LOST_WEBGL"},webglAvailability=null,view360_esm_WebGLUtils=function(){function WebGLUtils(){}return WebGLUtils.createShader=function(gl,type,source){var shader=gl.createShader(type);return gl.shaderSource(shader,source),gl.compileShader(shader),gl.getShaderParameter(shader,gl.COMPILE_STATUS)?shader:(console.error(gl.getShaderInfoLog(shader)),null)},WebGLUtils.createProgram=function(gl,vertexShader,fragmentShader){var program=gl.createProgram();return gl.attachShader(program,vertexShader),gl.attachShader(program,fragmentShader),gl.linkProgram(program),gl.deleteShader(vertexShader),gl.deleteShader(fragmentShader),gl.getProgramParameter(program,gl.LINK_STATUS)?program:(gl.deleteProgram(program),null)},WebGLUtils.initBuffer=function(gl,target,data,itemSize,attr){var buffer=gl.createBuffer();return gl.bindBuffer(target,buffer),gl.bufferData(target,data,gl.STATIC_DRAW),buffer&&(buffer.itemSize=itemSize,buffer.numItems=data.length/itemSize),void 0!==attr&&(gl.enableVertexAttribArray(attr),gl.vertexAttribPointer(attr,buffer.itemSize,gl.FLOAT,!1,0,0)),buffer},WebGLUtils.getWebglContext=function(canvas,userContextAttributes){var e_1,_a,context=null,contextAttributes=view360_esm_assign({preserveDrawingBuffer:!1,antialias:!1,xrCompatible:!0},userContextAttributes);function onWebglcontextcreationerror(e){return e.statusMessage}canvas.addEventListener("webglcontextcreationerror",onWebglcontextcreationerror);try{for(var webglIdentifiers_1=view360_esm_values(["webgl","experimental-webgl","webkit-3d","moz-webgl"]),webglIdentifiers_1_1=webglIdentifiers_1.next();!webglIdentifiers_1_1.done;webglIdentifiers_1_1=webglIdentifiers_1.next()){var identifier=webglIdentifiers_1_1.value;try{context=canvas.getContext(identifier,contextAttributes)}catch(t){}if(context)break}}catch(e_1_1){e_1={error:e_1_1}}finally{try{webglIdentifiers_1_1&&!webglIdentifiers_1_1.done&&(_a=webglIdentifiers_1.return)&&_a.call(webglIdentifiers_1)}finally{if(e_1)throw e_1.error}}return canvas.removeEventListener("webglcontextcreationerror",onWebglcontextcreationerror),context},WebGLUtils.createTexture=function(gl,textureTarget){var texture=gl.createTexture();return gl.bindTexture(textureTarget,texture),gl.texParameteri(textureTarget,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.texParameteri(textureTarget,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(textureTarget,gl.TEXTURE_WRAP_S,gl.CLAMP_TO_EDGE),gl.texParameteri(textureTarget,gl.TEXTURE_WRAP_T,gl.CLAMP_TO_EDGE),gl.bindTexture(textureTarget,null),texture},WebGLUtils.isWebGLAvailable=function(){if(null===webglAvailability){var canvas=document.createElement("canvas"),webglContext=WebGLUtils.getWebglContext(canvas);if(webglAvailability=!!webglContext,webglContext){var loseContextExtension=webglContext.getExtension("WEBGL_lose_context");loseContextExtension&&loseContextExtension.loseContext()}}return!!webglAvailability},WebGLUtils.isStableWebGL=function(){var agentInfo=agent_esm(),isStableWebgl=!0;if("android"===agentInfo.os.name){var version=parseFloat(agentInfo.os.version);version<=4.3&&version>=1?isStableWebgl=!1:4.4===version&&"chrome"!==agentInfo.browser.name&&(isStableWebgl=!1)}return isStableWebgl},WebGLUtils.getErrorNameFromWebGLErrorCode=function(code){return code in WEBGL_ERROR_CODE?WEBGL_ERROR_CODE[code]:"UNKNOWN_ERROR"},WebGLUtils.texImage2D=function(gl,target,pixels){try{gl.texImage2D(target,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,pixels)}catch(error){console.error("WebGLUtils.texImage2D error:",error)}},WebGLUtils.getMaxTextureSize=function(gl){return gl.getParameter(gl.MAX_TEXTURE_SIZE)},WebGLUtils}(),view360_esm_agentInfo=agent_esm(),isIE11="ie"===view360_esm_agentInfo.browser.name&&11===view360_esm_agentInfo.browser.majorVersion,EVENTS={ERROR:"error"},Renderer=function(_super){function Renderer(){var _this=_super.call(this)||this;return _this._forceDimension=null,_this._pixelCanvas=null,_this._pixelContext=null,_this}view360_esm_extends(Renderer,_super);var __proto=Renderer.prototype;return __proto.render=function(_a){var gl=_a.gl,shaderProgram=_a.shaderProgram,indexBuffer=_a.indexBuffer,mvMatrix=_a.mvMatrix,pMatrix=_a.pMatrix;gl.uniformMatrix4fv(shaderProgram.pMatrixUniform,!1,pMatrix),gl.uniformMatrix4fv(shaderProgram.mvMatrixUniform,!1,mvMatrix),indexBuffer&&gl.drawElements(gl.TRIANGLES,indexBuffer.numItems,gl.UNSIGNED_SHORT,0)},__proto.getDimension=function(pixelSource){return{width:pixelSource.naturalWidth||pixelSource.videoWidth,height:pixelSource.naturalHeight||pixelSource.videoHeight}},__proto.updateShaderData=function(param){},__proto._initPixelSource=function(image,forceDimension){if(void 0===forceDimension&&(forceDimension=null),isIE11&&image instanceof HTMLVideoElement||forceDimension){var _a=forceDimension||this.getDimension(image),width=_a.width,height=_a.height;this._pixelCanvas=document.createElement("canvas"),this._pixelCanvas.width=width,this._pixelCanvas.height=height,this._pixelContext=this._pixelCanvas.getContext("2d")}this._forceDimension=forceDimension},__proto._getPixelSource=function(image){if(!this._pixelCanvas)return image;var contentDimension=this.getDimension(image),textureDimension=this._forceDimension||contentDimension;return this._pixelCanvas.width!==textureDimension.width&&(this._pixelCanvas.width=textureDimension.width),this._pixelCanvas.height!==textureDimension.height&&(this._pixelCanvas.height=textureDimension.height),this._forceDimension?this._pixelContext.drawImage(image,0,0,contentDimension.width,contentDimension.height,0,0,textureDimension.width,textureDimension.height):this._pixelContext.drawImage(image,0,0),this._pixelCanvas},__proto._extractTileConfig=function(imageConfig){var tileConfig=Array.isArray(imageConfig.tileConfig)?imageConfig.tileConfig:Array.apply(void 0,__spread(Array(6))).map((function(){return imageConfig.tileConfig}));return tileConfig=tileConfig.map((function(config){return view360_esm_assign({flipHorizontal:!1,rotation:0},config)}))},__proto._triggerError=function(error){console.error("Renderer Error:",error),this.trigger(EVENTS.ERROR,{message:"string"==typeof error?error:error.message})},Renderer.EVENTS=EVENTS,Renderer}(component_esm),view360_esm_CubeRenderer=function(_super){function CubeRenderer(){return null!==_super&&_super.apply(this,arguments)||this}view360_esm_extends(CubeRenderer,_super);var __proto=CubeRenderer.prototype;return CubeRenderer.extractOrder=function(imageConfig){return imageConfig.order||"RLUDBF"},__proto.getVertexPositionData=function(){return CubeRenderer._VERTEX_POSITION_DATA=null!==CubeRenderer._VERTEX_POSITION_DATA?CubeRenderer._VERTEX_POSITION_DATA:[1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,1,-1,-1,-1,-1,-1,-1,-1,1,1,-1,1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1],CubeRenderer._VERTEX_POSITION_DATA},__proto.getIndexData=function(){if(CubeRenderer._INDEX_DATA)return CubeRenderer._INDEX_DATA;for(var indexData=[],vertexPositionData=this.getVertexPositionData(),i=0;i<vertexPositionData.length/3;i+=4)indexData.push(i,i+2,i+1,i,i+3,i+2);return CubeRenderer._INDEX_DATA=indexData,indexData},__proto.getTextureCoordData=function(imageConfig){var order=CubeRenderer.extractOrder(imageConfig),base=this.getVertexPositionData(),tileConfig=this._extractTileConfig(imageConfig);return"BFUDRL".split("").map((function(face){return tileConfig[order.indexOf(face)]})).map((function(config,i){for(var rotation=Math.floor(config.rotation/90),ordermap_=config.flipHorizontal?[0,1,2,3]:[1,0,3,2],r=0;r<Math.abs(rotation);r++)config.flipHorizontal&&rotation>0||!config.flipHorizontal&&rotation<0?ordermap_.push(ordermap_.shift()):ordermap_.unshift(ordermap_.pop());for(var tileVertex=base.slice(12*i,12*i+12),tileTemp=[],j=0;j<4;j++)tileTemp[ordermap_[j]]=tileVertex.splice(0,3);return tileTemp})).join().split(",").map((function(v){return parseInt(v,10)}))},__proto.getVertexShaderSource=function(){return"\nattribute vec3 aVertexPosition;\nattribute vec3 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nvarying highp vec3 vVertexDirectionVector;\nvoid main(void) {\n  vVertexDirectionVector = aTextureCoord;\n  gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n}"},__proto.getFragmentShaderSource=function(){return"\nprecision highp float;\nuniform samplerCube uSampler;\nvarying highp vec3 vVertexDirectionVector;\nvoid main(void) {\n  gl_FragColor = textureCube(uSampler, vVertexDirectionVector);\n}"},__proto.updateTexture=function(gl,image,imageConfig){var order=CubeRenderer.extractOrder(imageConfig),orderMap={};order.split("").forEach((function(v,i){orderMap[v]=i}));try{if(image instanceof Array)for(var surfaceIdx=0;surfaceIdx<6;surfaceIdx++){var tileIdx=orderMap["RLUDBF"[surfaceIdx]];view360_esm_WebGLUtils.texImage2D(gl,gl.TEXTURE_CUBE_MAP_POSITIVE_X+surfaceIdx,image[tileIdx])}else{var maxCubeMapTextureSize=this.getMaxCubeMapTextureSize(gl,image);for(surfaceIdx=0;surfaceIdx<6;surfaceIdx++){tileIdx=orderMap["RLUDBF"[surfaceIdx]];var tile=this.extractTileFromImage(image,tileIdx,maxCubeMapTextureSize);view360_esm_WebGLUtils.texImage2D(gl,gl.TEXTURE_CUBE_MAP_POSITIVE_X+surfaceIdx,tile)}}}catch(e){this._triggerError(e)}},__proto.bindTexture=function(gl,texture,image,imageConfig){gl.bindTexture(gl.TEXTURE_CUBE_MAP,texture),this.updateTexture(gl,image,imageConfig)},__proto.getSourceTileSize=function(image){var _a=this.getDimension(image),width=_a.width,height=_a.height,aspectRatio=width/height;return aspectRatio===1/6?width:6===aspectRatio?height:aspectRatio===2/3?width/2:width/3},__proto.extractTileFromImage=function(image,tileIdx,outputTextureSize){var width=this.getDimension(image).width,inputTextureSize=this.getSourceTileSize(image),canvas=document.createElement("canvas");canvas.width=outputTextureSize,canvas.height=outputTextureSize;var context=canvas.getContext("2d"),tilePerRow=width/inputTextureSize,x=inputTextureSize*tileIdx%(inputTextureSize*tilePerRow),y=Math.floor(tileIdx/tilePerRow)*inputTextureSize;return context.drawImage(image,x,y,inputTextureSize,inputTextureSize,0,0,outputTextureSize,outputTextureSize),canvas},__proto.getMaxCubeMapTextureSize=function(gl,image){var agentInfo=agent_esm(),maxCubeMapTextureSize=gl.getParameter(gl.MAX_CUBE_MAP_TEXTURE_SIZE),_imageWidth=this.getSourceTileSize(image);if("ie"===agentInfo.browser.name&&11===agentInfo.browser.majorVersion&&!util.isPowerOfTwo(_imageWidth))for(var i=1;i<maxCubeMapTextureSize;i*=2)if(!(i<_imageWidth)){_imageWidth=i;break}if("ios"===agentInfo.os.name){var majorVersion=agentInfo.os.majorVersion;9===majorVersion&&(_imageWidth=1024),8===majorVersion&&(_imageWidth=512)}return Math.min(maxCubeMapTextureSize,_imageWidth)},CubeRenderer._VERTEX_POSITION_DATA=null,CubeRenderer._INDEX_DATA=null,CubeRenderer}(Renderer),CubeStripRenderer=function(_super){function CubeStripRenderer(){return null!==_super&&_super.apply(this,arguments)||this}view360_esm_extends(CubeStripRenderer,_super);var __proto=CubeStripRenderer.prototype;return __proto.getVertexShaderSource=function(){return"\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nvarying highp vec2 vTextureCoord;\nvoid main(void) {\n  vTextureCoord = aTextureCoord;\n  gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n}"},__proto.getFragmentShaderSource=function(){return"\n#define PI 3.14159265359\nprecision highp float;\nvarying highp vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform bool uIsEAC;\nconst vec2 OPERATE_COORDS_RANGE = vec2(-1.0, 1.0);\nconst vec2 TEXTURE_COORDS_RANGE = vec2(0.0, 1.0);\n// vector type is used for initializing values instead of array.\nconst vec4 TEXTURE_DIVISION_X = vec4(0.0, 1.0 / 3.0, 2.0 / 3.0, 1.0);\nconst vec3 TEXTURE_DIVISION_Y = vec3(0.0, 1.0 / 2.0, 1.0);\nconst float EAC_CONST = 2.0 / PI;\nfloat scale(vec2 domainRange, vec2 targetRange, float val) {\n  float unit = 1.0 / (domainRange[1] - domainRange[0]);\n  return targetRange[0] + (targetRange[1] - targetRange[0]) * (val - domainRange[0]) * unit;\n}\nvoid main(void) {\n  float transformedCoordX;\n  float transformedCoordY;\n\n  if (uIsEAC) {\n    vec2 orgTextureRangeX;\n    vec2 orgTextureRangeY;\n\n    // Apply EAC transform\n    if (vTextureCoord.s >= TEXTURE_DIVISION_X[2]) {\n      orgTextureRangeX = vec2(TEXTURE_DIVISION_X[2], TEXTURE_DIVISION_X[3]);\n    } else if (vTextureCoord.s >= TEXTURE_DIVISION_X[1]) {\n      orgTextureRangeX = vec2(TEXTURE_DIVISION_X[1], TEXTURE_DIVISION_X[2]);\n    } else {\n      orgTextureRangeX = vec2(TEXTURE_DIVISION_X[0], TEXTURE_DIVISION_X[1]);\n    }\n\n    if (vTextureCoord.t >= TEXTURE_DIVISION_Y[1]) {\n      orgTextureRangeY = vec2(TEXTURE_DIVISION_Y[1], TEXTURE_DIVISION_Y[2]);\n    } else {\n      orgTextureRangeY = vec2(TEXTURE_DIVISION_Y[0], TEXTURE_DIVISION_Y[1]);\n    }\n\n    // scaling coors by the coordinates following the range from -1.0 to 1.0.\n    float px = scale(orgTextureRangeX, OPERATE_COORDS_RANGE, vTextureCoord.s);\n    float py = scale(orgTextureRangeY, OPERATE_COORDS_RANGE, vTextureCoord.t);\n\n    float qu = EAC_CONST * atan(px) + 0.5;\n    float qv = EAC_CONST * atan(py) + 0.5;\n\n    // re-scaling coors by original coordinates ranges\n    transformedCoordX = scale(TEXTURE_COORDS_RANGE, orgTextureRangeX, qu);\n    transformedCoordY = scale(TEXTURE_COORDS_RANGE, orgTextureRangeY, qv);\n  } else {\n    // normal cubemap\n    transformedCoordX = vTextureCoord.s;\n    transformedCoordY = vTextureCoord.t;\n  }\n\n  gl_FragColor = texture2D(uSampler, vec2(transformedCoordX, transformedCoordY));\n}"},__proto.getVertexPositionData=function(){return this._vertices||(this._vertices=[1,-1,1,-1,-1,1,-1,1,1,1,1,1,-1,-1,-1,1,-1,-1,1,1,-1,-1,1,-1,-1,1,-1,1,1,-1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,-1,-1,-1,-1,-1,1,-1,-1,1,-1,1,1,1,1,1,1,-1,-1,-1,1,-1,-1,-1,-1,1,-1,-1,1,1]),this._vertices},__proto.getIndexData=function(){var _this=this;return function(){for(var indexData=[],i=0;i<_this._vertices.length/3;i+=4)indexData.push(i,i+1,i+2,i,i+2,i+3);return indexData}()},__proto.getTextureCoordData=function(imageConfig){for(var _this=this,order=imageConfig.order||"RLUDFB",coords=[],r=1;r>=0;r--)for(var c=0;c<3;c++){var coord=[c/3,r/2,(c+1)/3,r/2,(c+1)/3,(r+1)/2,c/3,(r+1)/2];coords.push(coord)}var tileConfigs=this._extractTileConfig(imageConfig);return coords=coords.map((function(coord){return _this._shrinkCoord(coord)})).map((function(coord,i){return _this._transformCoord(coord,tileConfigs[i])})),"BFUDRL".split("").map((function(face){return order.indexOf(face)})).map((function(index){return coords[index]})).reduce((function(acc,val){return acc.concat(val)}),[])},__proto.updateTexture=function(gl,image){view360_esm_WebGLUtils.texImage2D(gl,gl.TEXTURE_2D,this._getPixelSource(image))},__proto.bindTexture=function(gl,texture,image){var _a=this.getDimension(image),width=_a.width,height=_a.height,size=Math.max(width,height),maxSize=view360_esm_WebGLUtils.getMaxTextureSize(gl);size>maxSize?this._triggerError("Image width("+width+") exceeds device limit("+maxSize+"))"):(this._initPixelSource(image),gl.activeTexture(gl.TEXTURE0),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),gl.bindTexture(gl.TEXTURE_2D,texture),this.updateTexture(gl,image))},__proto._transformCoord=function(coord,tileConfig){var newCoord=coord.slice();return tileConfig.flipHorizontal&&(newCoord=this._flipHorizontalCoord(newCoord)),tileConfig.rotation&&(newCoord=this._rotateCoord(newCoord,tileConfig.rotation)),newCoord},__proto._shrinkCoord=function(coord){return[coord[0]+0,coord[1]+0,coord[2]-0,coord[3]+0,coord[4]-0,coord[5]-0,coord[6]+0,coord[7]-0]},__proto._rotateCoord=function(coord,rotationAngle){var moved,shiftCount=Math.floor(rotationAngle/90)%4;if(0===shiftCount)return coord;var rotatedCoord=[];return shiftCount>0?(moved=coord.splice(0,2*shiftCount),rotatedCoord=coord.concat(moved)):rotatedCoord=(moved=coord.splice(2*(4+shiftCount),2*-shiftCount)).concat(coord),rotatedCoord},__proto._flipHorizontalCoord=function(coord){return[coord[2],coord[3],coord[0],coord[1],coord[6],coord[7],coord[4],coord[5]]},CubeStripRenderer}(Renderer),ERROR_TYPE={INVALID_DEVICE:10,NO_WEBGL:11,FAIL_IMAGE_LOAD:12,FAIL_BIND_TEXTURE:13,INVALID_RESOURCE:14,RENDERING_CONTEXT_LOST:15},EVENTS$1={READY:"ready",VIEW_CHANGE:"viewChange",ANIMATION_END:"animationEnd",ERROR:"error"},PROJECTION_TYPE={EQUIRECTANGULAR:"equirectangular",CUBEMAP:"cubemap",CUBESTRIP:"cubestrip",PANORAMA:"panorama",STEREOSCOPIC_EQUI:"stereoequi"},STEREO_FORMAT={TOP_BOTTOM:"3dv",LEFT_RIGHT:"3dh",NONE:""},ANGLE_CORRECTION_FOR_CENTER_ALIGN=-.5*Math.PI,textureCoordData=[],vertexPositionData=[],indexData=[];for(latIdx=0;latIdx<=60;latIdx++){var view360_esm_theta=(latIdx/60-.5)*Math.PI,view360_esm_sinTheta=Math.sin(view360_esm_theta),view360_esm_cosTheta=Math.cos(view360_esm_theta);for(view360_esm_lngIdx=0;view360_esm_lngIdx<=60;view360_esm_lngIdx++){var phi=2*(view360_esm_lngIdx/60-.5)*Math.PI+ANGLE_CORRECTION_FOR_CENTER_ALIGN,sinPhi=Math.sin(phi),view360_esm_x=Math.cos(phi)*view360_esm_cosTheta,view360_esm_y=view360_esm_sinTheta,view360_esm_z=sinPhi*view360_esm_cosTheta,view360_esm_u=view360_esm_lngIdx/60,view360_esm_v=latIdx/60;if(textureCoordData.push(view360_esm_u,view360_esm_v),vertexPositionData.push(2*view360_esm_x,2*view360_esm_y,2*view360_esm_z),60!==view360_esm_lngIdx&&60!==latIdx){var view360_esm_a=61*latIdx+view360_esm_lngIdx,view360_esm_b=view360_esm_a+60+1;indexData.push(view360_esm_a,view360_esm_b,view360_esm_a+1,view360_esm_b,view360_esm_b+1,view360_esm_a+1)}}}var SphereRenderer=function(_super){function SphereRenderer(format){var _this=_super.call(this)||this;return _this._stereoFormat=format,_this}view360_esm_extends(SphereRenderer,_super);var __proto=SphereRenderer.prototype;return __proto.render=function(ctx){var leftEyeScaleOffset,rightEyeScaleOffset,gl=ctx.gl,shaderProgram=ctx.shaderProgram;switch(this._stereoFormat){case STEREO_FORMAT.TOP_BOTTOM:leftEyeScaleOffset=[1,.5,0,0],rightEyeScaleOffset=[1,.5,0,.5];break;case STEREO_FORMAT.LEFT_RIGHT:leftEyeScaleOffset=[.5,1,0,0],rightEyeScaleOffset=[.5,1,.5,0];break;default:leftEyeScaleOffset=[1,1,0,0],rightEyeScaleOffset=[1,1,0,0]}var uTexScaleOffset=gl.getUniformLocation(shaderProgram,"uTexScaleOffset");gl.uniform4fv(uTexScaleOffset,__spread(leftEyeScaleOffset,rightEyeScaleOffset)),_super.prototype.render.call(this,ctx)},__proto.getVertexPositionData=function(){return SphereRenderer._VERTEX_POSITION_DATA},__proto.getIndexData=function(){return SphereRenderer._INDEX_DATA},__proto.getTextureCoordData=function(){return SphereRenderer._TEXTURE_COORD_DATA},__proto.getVertexShaderSource=function(){return"\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nuniform float uEye;\nuniform vec4 uTexScaleOffset[2];\nvarying highp vec2 vTextureCoord;\nvoid main(void) {\n  vec4 scaleOffset = uTexScaleOffset[int(uEye)];\n  vTextureCoord = aTextureCoord.xy * scaleOffset.xy + scaleOffset.zw;\n  gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n}"},__proto.getFragmentShaderSource=function(){return"\nprecision highp float;\nvarying highp vec2 vTextureCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\n  gl_FragColor = texture2D(uSampler, vTextureCoord.st);\n}"},__proto.updateTexture=function(gl,image){view360_esm_WebGLUtils.texImage2D(gl,gl.TEXTURE_2D,this._getPixelSource(image))},__proto.bindTexture=function(gl,texture,image){var _a=this.getDimension(image),width=_a.width,height=_a.height,size=Math.max(width,height),maxSize=view360_esm_WebGLUtils.getMaxTextureSize(gl);size>maxSize?this._triggerError("Image width("+width+") exceeds device limit("+maxSize+"))"):(this._initPixelSource(image),gl.activeTexture(gl.TEXTURE0),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),gl.bindTexture(gl.TEXTURE_2D,texture),this.updateTexture(gl,image))},SphereRenderer._VERTEX_POSITION_DATA=vertexPositionData,SphereRenderer._TEXTURE_COORD_DATA=textureCoordData,SphereRenderer._INDEX_DATA=indexData,SphereRenderer}(Renderer),textureCoordData$1=[],vertexPositionData$1=[],indexData$1=[],view360_esm_CylinderRenderer=function(_super){function CylinderRenderer(){return null!==_super&&_super.apply(this,arguments)||this}view360_esm_extends(CylinderRenderer,_super);var __proto=CylinderRenderer.prototype;return __proto.getVertexPositionData=function(){return CylinderRenderer._VERTEX_POSITION_DATA},__proto.getIndexData=function(){return CylinderRenderer._INDEX_DATA},__proto.getTextureCoordData=function(){return CylinderRenderer._TEXTURE_COORD_DATA},__proto.getVertexShaderSource=function(){return"\nattribute vec3 aVertexPosition;\nattribute vec2 aTextureCoord;\nuniform mat4 uMVMatrix;\nuniform mat4 uPMatrix;\nvarying highp vec2 vTextureCoord;\nvoid main(void) {\n  vTextureCoord = aTextureCoord;\n  gl_Position = uPMatrix * uMVMatrix * vec4(aVertexPosition, 1.0);\n}"},__proto.getFragmentShaderSource=function(){return"\nprecision highp float;\nvarying highp vec2 vTextureCoord;\nuniform sampler2D uSampler;\nvoid main(void) {\n  gl_FragColor = texture2D(uSampler, vec2(vTextureCoord.s, vTextureCoord.t));\n}"},__proto.updateTexture=function(gl,image){view360_esm_WebGLUtils.texImage2D(gl,gl.TEXTURE_2D,this._getPixelSource(image))},__proto.bindTexture=function(gl,texture,image){var resizeDimension,_a=this.getDimension(image),width=_a.width,height=_a.height,size=Math.max(width,height),maxSize=view360_esm_WebGLUtils.getMaxTextureSize(gl);size>maxSize&&(this._triggerError("Image width("+width+") exceeds device texture limit("+maxSize+"))"),resizeDimension=width>height?{width:maxSize,height:maxSize*height/width}:{width:maxSize*width/height,height:maxSize}),this._initPixelSource(image,resizeDimension),gl.activeTexture(gl.TEXTURE0),gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL,!0),gl.bindTexture(gl.TEXTURE_2D,texture),this.updateTexture(gl,image)},__proto.updateShaderData=function(_a){var lngIdx,cylinderMaxRadian,halfCylinderY,rotated,aspectRatio,_b=_a.imageAspectRatio,imageAspectRatio=void 0===_b?6:_b;if(imageAspectRatio<1?(rotated=!0,aspectRatio=1/imageAspectRatio):(rotated=!1,aspectRatio=imageAspectRatio),aspectRatio>=6){var fov=360/aspectRatio;cylinderMaxRadian=2*Math.PI,halfCylinderY=Math.tan(common_namespaceObject.toRadian(fov/2))}else cylinderMaxRadian=aspectRatio,halfCylinderY=.5;textureCoordData$1.length=0,vertexPositionData$1.length=0,indexData$1.length=0;for(var CYLIDER_Y=[-halfCylinderY,halfCylinderY],startAngleForCenterAlign=Math.PI/2+(2*Math.PI-cylinderMaxRadian)/2,yIdx=0,yLength=CYLIDER_Y.length;yIdx<yLength;yIdx++)for(lngIdx=0;lngIdx<=60;lngIdx++){var angle=startAngleForCenterAlign+lngIdx/60*cylinderMaxRadian,x=Math.cos(angle),y=CYLIDER_Y[yIdx],z=Math.sin(angle),u=void 0,v=void 0;if(rotated?(u=1-yIdx,v=lngIdx/60):(u=lngIdx/60,v=yIdx),textureCoordData$1.push(u,v),vertexPositionData$1.push(x,y,z),0===yIdx&&lngIdx<60){var a=lngIdx,b=a+60+1;indexData$1.push(a,b,a+1,b,b+1,a+1)}}},CylinderRenderer._VERTEX_POSITION_DATA=vertexPositionData$1,CylinderRenderer._TEXTURE_COORD_DATA=textureCoordData$1,CylinderRenderer._INDEX_DATA=indexData$1,CylinderRenderer}(Renderer),DEFAULT_LEFT_BOUNDS=[0,0,.5,1],DEFAULT_RIGHT_BOUNDS=[.5,0,.5,1],EYES_LEFT="left",EYES_RIGHT="right",view360_esm_VRManager=function(){function VRManager(){var _this=this;this.destroy=function(){var vrDisplay=_this._vrDisplay;_this.removeEndCallback(_this.destroy),vrDisplay&&vrDisplay.isPresenting&&vrDisplay.exitPresent(),_this._clear()},this._frameData=new window.VRFrameData,this._clear()}var __proto=VRManager.prototype;return Object.defineProperty(__proto,"context",{get:function(){return this._vrDisplay},enumerable:!1,configurable:!0}),__proto.canRender=function(){return Boolean(this._vrDisplay)},__proto.beforeRender=function(gl){gl.bindFramebuffer(gl.FRAMEBUFFER,null)},__proto.afterRender=function(){this._vrDisplay.submitFrame()},__proto.getEyeParams=function(gl){var display=this._vrDisplay,halfWidth=.5*gl.drawingBufferWidth,height=gl.drawingBufferHeight,frameData=this._frameData;display.getFrameData(frameData);var leftMVMatrix=frameData.leftViewMatrix,rightMVMatrix=frameData.rightViewMatrix;return mat4_namespaceObject.rotateY(leftMVMatrix,leftMVMatrix,this._yawOffset),mat4_namespaceObject.rotateY(rightMVMatrix,rightMVMatrix,this._yawOffset),[{viewport:[0,0,halfWidth,height],mvMatrix:leftMVMatrix,pMatrix:frameData.leftProjectionMatrix},{viewport:[halfWidth,0,halfWidth,height],mvMatrix:rightMVMatrix,pMatrix:frameData.rightProjectionMatrix}]},__proto.isPresenting=function(){return Boolean(this._vrDisplay&&this._vrDisplay.isPresenting)},__proto.addEndCallback=function(callback){window.addEventListener("vrdisplaypresentchange",callback)},__proto.removeEndCallback=function(callback){window.removeEventListener("vrdisplaypresentchange",callback)},__proto.requestPresent=function(canvas){var _this=this;return navigator.getVRDisplays().then((function(displays){var vrDisplay=displays.length&&displays[0];return vrDisplay?vrDisplay.capabilities.canPresent?vrDisplay.requestPresent([{source:canvas}]).then((function(){var leftEye=vrDisplay.getEyeParameters(EYES_LEFT),rightEye=vrDisplay.getEyeParameters(EYES_RIGHT);canvas.width=2*Math.max(leftEye.renderWidth,rightEye.renderWidth),canvas.height=Math.max(leftEye.renderHeight,rightEye.renderHeight),_this._setDisplay(vrDisplay)})):src.a.reject(new Error("Display lacking capability to present.")):src.a.reject(new Error("No displays available."))}))},__proto.setYawOffset=function(offset){this._yawOffset=offset},__proto._setDisplay=function(vrDisplay){this._vrDisplay=vrDisplay;var layers=vrDisplay.getLayers();if(layers.length){var layer=layers[0];this._leftBounds=layer.leftBounds,this._rightBounds=layer.rightBounds}this.addEndCallback(this.destroy)},__proto._clear=function(){this._vrDisplay=null,this._leftBounds=DEFAULT_LEFT_BOUNDS,this._rightBounds=DEFAULT_RIGHT_BOUNDS,this._yawOffset=0},VRManager}();function appendSourceElement(video,videoUrl){var videoSrc,videoType;if("object"==typeof videoUrl?(videoSrc=videoUrl.src,videoType=videoUrl.type):"string"==typeof videoUrl&&(videoSrc=videoUrl),!videoSrc)return!1;var sourceElement=document.createElement("source");sourceElement.src=videoSrc,videoType&&(sourceElement.type=videoType),video.appendChild(sourceElement)}var view360_esm_XRManager=function(){function XRManager(options){var _this=this;void 0===options&&(options={}),this.destroy=function(){var xrSession=_this._xrSession;_this.removeEndCallback(_this.destroy),xrSession&&xrSession.end().then((function(){}),(function(){})),_this._clear()},this._clear(),this._options=options}var __proto=XRManager.prototype;return Object.defineProperty(__proto,"context",{get:function(){return this._xrSession},enumerable:!1,configurable:!0}),__proto.canRender=function(frame){var pose=frame.getViewerPose(this._xrRefSpace);return Boolean(pose)},__proto.beforeRender=function(gl,frame){var baseLayer=frame.session.renderState.baseLayer;gl.bindFramebuffer(gl.FRAMEBUFFER,baseLayer.framebuffer)},__proto.afterRender=function(){},__proto.getEyeParams=function(gl,frame){var _this=this,session=frame.session,pose=frame.getViewerPose(this._xrRefSpace);if(!pose)return null;var glLayer=session.renderState.baseLayer;return pose.views.map((function(view){var viewport=glLayer.getViewport(view),mvMatrix=view.transform.inverse.matrix;return IS_SAFARI_ON_DESKTOP&&mat4_namespaceObject.rotateX(mvMatrix,mvMatrix,common_namespaceObject.toRadian(180)),mat4_namespaceObject.rotateY(mvMatrix,mvMatrix,_this._yawOffset),{viewport:[viewport.x,viewport.y,viewport.width,viewport.height],mvMatrix:mvMatrix,pMatrix:view.projectionMatrix}}))},__proto.isPresenting=function(){return this._presenting},__proto.addEndCallback=function(callback){var _a;null===(_a=this._xrSession)||void 0===_a||_a.addEventListener("end",callback)},__proto.removeEndCallback=function(callback){var _a;null===(_a=this._xrSession)||void 0===_a||_a.removeEventListener("end",callback)},__proto.requestPresent=function(canvas,gl){var _this=this,options=function view360_esm_merge(target){for(var srcs=[],_i=1;_i<arguments.length;_i++)srcs[_i-1]=arguments[_i];return srcs.forEach((function(source){Object.keys(source).forEach((function(key){var value=source[key];Array.isArray(target[key])&&Array.isArray(value)?target[key]=__spread(target[key],value):target[key]=value}))})),target}({requiredFeatures:["local"]},this._options),attributes=gl.getContextAttributes();return attributes&&!0!==attributes.xrCompatible&&gl.makeXRCompatible(),navigator.xr.requestSession("immersive-vr",options).then((function(session){var xrLayer=new window.XRWebGLLayer(session,gl);return session.updateRenderState({baseLayer:xrLayer}),session.requestReferenceSpace("local").then((function(refSpace){_this._setSession(session,xrLayer,refSpace)}))}))},__proto.setYawOffset=function(offset){this._yawOffset=offset},__proto._setSession=function(session,xrLayer,refSpace){this._xrSession=session,this._xrLayer=xrLayer,this._xrRefSpace=refSpace,this._presenting=!0,this.addEndCallback(this.destroy)},__proto._clear=function(){this._xrSession=null,this._xrLayer=null,this._xrRefSpace=null,this._presenting=!1,this._yawOffset=0,this._options={}},XRManager}(),WebGLAnimator=function(){function WebGLAnimator(){var _this=this;this._onLoop=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];_this._callback.apply(_this,__spread(args)),_this._rafId=_this._context.requestAnimationFrame(_this._onLoop)},this._onLoopNextTick=function(){for(var args=[],_i=0;_i<arguments.length;_i++)args[_i]=arguments[_i];var before=performance.now();_this._callback.apply(_this,__spread(args));var diff=performance.now()-before;_this._rafTimer>=0&&(clearTimeout(_this._rafTimer),_this._rafTimer=-1),diff<16?_this._rafId=_this._context.requestAnimationFrame(_this._onLoop):_this._rafTimer=window.setTimeout(_this._onLoop,0)},this._callback=null,this._context=window,this._rafId=-1,this._rafTimer=-1}var __proto=WebGLAnimator.prototype;return __proto.setCallback=function(callback){this._callback=callback},__proto.setContext=function(context){this._context=context},__proto.start=function(){var context=this._context,callback=this._callback;context&&callback&&(this._rafId>=0||this._rafTimer>=0||(this._rafId=IS_SAFARI_ON_DESKTOP?context.requestAnimationFrame(this._onLoopNextTick):context.requestAnimationFrame(this._onLoop)))},__proto.stop=function(){this._rafId>=0&&this._context.cancelAnimationFrame(this._rafId),this._rafTimer>=0&&clearTimeout(this._rafTimer),this._rafId=-1,this._rafTimer=-1},WebGLAnimator}(),ImageType=PROJECTION_TYPE,DEVICE_PIXEL_RATIO=devicePixelRatio||1;DEVICE_PIXEL_RATIO>2&&(DEVICE_PIXEL_RATIO=2);var EVENTS$2={BIND_TEXTURE:"bindTexture",IMAGE_LOADED:"imageLoaded",ERROR:"error",RENDERING_CONTEXT_LOST:"renderingContextLost",RENDERING_CONTEXT_RESTORE:"renderingContextRestore"},ERROR_TYPE$1={INVALID_DEVICE:10,NO_WEBGL:11,FAIL_IMAGE_LOAD:12,RENDERER_ERROR:13},view360_esm_PanoImageRenderer=function(_super){function PanoImageRenderer(image,width,height,isVideo,sphericalConfig,renderingContextAttributes){var _this=_super.call(this)||this;return _this.textureCoordBuffer=null,_this.vertexBuffer=null,_this.indexBuffer=null,_this.exitVR=function(){var vr=_this._vr,gl=_this.context,animator=_this._animator;vr&&(vr.removeEndCallback(_this.exitVR),vr.destroy(),_this._vr=null,IS_IOS&&_this._restoreStyle(),_this.updateViewportDimensions(_this.width,_this.height),_this._updateViewport(),gl.bindFramebuffer(gl.FRAMEBUFFER,null),_this._bindBuffers(),_this._shouldForceDraw=!0,animator.stop(),animator.setContext(window),animator.setCallback(_this._render.bind(_this)),animator.start())},_this._renderStereo=function(time,frame){var e_1,_a,vr=_this._vr,gl=_this.context,eyeParams=vr.getEyeParams(gl,frame);if(eyeParams){vr.beforeRender(gl,frame);try{for(var _b=view360_esm_values([0,1]),_c=_b.next();!_c.done;_c=_b.next()){var eyeIndex=_c.value,eyeParam=eyeParams[eyeIndex];_this.mvMatrix=eyeParam.mvMatrix,_this.pMatrix=eyeParam.pMatrix,gl.viewport.apply(gl,__spread(eyeParam.viewport)),gl.uniform1f(_this.shaderProgram.uEye,eyeIndex),_this._bindBuffers(),_this._draw()}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}vr.afterRender()}},_this._onFirstVRFrame=function(time,frame){var vr=_this._vr,gl=_this.context,animator=_this._animator;if(vr.canRender(frame)){var minusZDir=vec3_namespaceObject.fromValues(0,0,-1),eyeParam=vr.getEyeParams(gl,frame)[0],mvMatrix=mat3_namespaceObject.fromMat4(mat3_namespaceObject.create(),eyeParam.mvMatrix),pMatrix=mat3_namespaceObject.fromMat4(mat3_namespaceObject.create(),eyeParam.pMatrix),mvInv=mat3_namespaceObject.invert(mat3_namespaceObject.create(),mvMatrix),pInv=mat3_namespaceObject.invert(mat3_namespaceObject.create(),pMatrix),viewDir=vec3_namespaceObject.transformMat3(vec3_namespaceObject.create(),minusZDir,pInv);vec3_namespaceObject.transformMat3(viewDir,viewDir,mvInv);var yawOffset=util.yawOffsetBetween(viewDir,vec3_namespaceObject.fromValues(0,0,1));0!==yawOffset&&(vr.setYawOffset(yawOffset),animator.setCallback(_this._renderStereo))}},_this.sphericalConfig=sphericalConfig,_this.fieldOfView=sphericalConfig.fieldOfView,_this.width=width,_this.height=height,_this._lastQuaternion=null,_this._lastYaw=null,_this._lastPitch=null,_this._lastFieldOfView=null,_this.pMatrix=mat4_namespaceObject.create(),_this.mvMatrix=mat4_namespaceObject.create(),mat4_namespaceObject.perspective(_this.pMatrix,common_namespaceObject.toRadian(_this.fieldOfView),width/height,.1,100),_this.textureCoordBuffer=null,_this.vertexBuffer=null,_this.indexBuffer=null,_this.canvas=_this._initCanvas(width,height),_this._setDefaultCanvasStyle(),_this._wrapper=null,_this._wrapperOrigStyle=null,_this._renderingContextAttributes=renderingContextAttributes,_this._image=null,_this._imageConfig=null,_this._imageIsReady=!1,_this._shouldForceDraw=!1,_this._keepUpdate=!1,_this._onContentLoad=_this._onContentLoad.bind(_this),_this._onContentError=_this._onContentError.bind(_this),_this._animator=new WebGLAnimator,_this._vr=null,image&&_this.setImage({image:image,imageType:sphericalConfig.imageType,isVideo:isVideo,cubemapConfig:sphericalConfig.cubemapConfig}),_this}view360_esm_extends(PanoImageRenderer,_super);var __proto=PanoImageRenderer.prototype;return __proto.setYawPitchControl=function(yawPitchControl){this._yawPitchControl=yawPitchControl},__proto.getContent=function(){return this._image},__proto.setImage=function(_a){var image=_a.image,imageType=_a.imageType,_b=_a.isVideo,isVideo=void 0!==_b&&_b,cubemapConfig=_a.cubemapConfig;this._imageIsReady=!1,this._isVideo=isVideo,this._imageConfig=view360_esm_assign({order:imageType===ImageType.CUBEMAP?"RLUDBF":"RLUDFB",tileConfig:{flipHorizontal:!1,rotation:0}},cubemapConfig),this._setImageType(imageType),this._contentLoader&&this._contentLoader.destroy(),this._contentLoader=(new imready_esm).on("ready",this._onContentLoad).on("error",this._onContentError),isVideo?(this._image=function toVideoElement(videoCandidate){if(videoCandidate instanceof HTMLVideoElement)return videoCandidate;var video_1=document.createElement("video");return video_1.setAttribute("crossorigin","anonymous"),video_1.setAttribute("webkit-playsinline",""),video_1.setAttribute("playsinline",""),videoCandidate instanceof Array?videoCandidate.forEach((function(v){return appendSourceElement(video_1,v)})):appendSourceElement(video_1,videoCandidate),video_1.querySelectorAll("source").length>0&&video_1.readyState<1&&video_1.load(),video_1}(image),this._contentLoader.check([this._image]),this._keepUpdate=!0):(this._image=function toImageElement(image){var parsedImages=(image instanceof Array?image:[image]).map((function(img){var _img=img;return"string"==typeof img&&((_img=new Image).crossOrigin="anonymous",_img.src=img),_img}));return 1===parsedImages.length?parsedImages[0]:parsedImages}(image),this._contentLoader.check(Array.isArray(this._image)?this._image:[this._image]),this._keepUpdate=!1)},__proto.isImageLoaded=function(){return!!this._image&&this._imageIsReady&&(!this._isVideo||this._image.readyState>=2)},__proto.bindTexture=function(){var _this=this;return new src.a((function(res,rej){var contentLoader=_this._contentLoader;return _this._image?contentLoader?void(contentLoader.isReady()?(_this._bindTexture(),res()):(contentLoader.check(Array.isArray(_this._image)?_this._image:[_this._image]),contentLoader.once("ready",(function(e){e.errorCount>0?rej("Failed to load images."):(_this._bindTexture(),res())})))):rej("ImageLoader is not initialized"):rej("Image is not defined")}))},__proto.attachTo=function(parentElement){this.detach(),parentElement.appendChild(this.canvas),this._wrapper=parentElement},__proto.forceContextLoss=function(){if(this.hasRenderingContext()){var loseContextExtension=this.context.getExtension("WEBGL_lose_context");loseContextExtension&&loseContextExtension.loseContext()}},__proto.detach=function(){this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas)},__proto.destroy=function(){this._contentLoader&&this._contentLoader.destroy(),this._animator.stop(),this.detach(),this.forceContextLoss(),this.off(),this.canvas.removeEventListener("webglcontextlost",this._onWebglcontextlost),this.canvas.removeEventListener("webglcontextrestored",this._onWebglcontextrestored)},__proto.hasRenderingContext=function(){var ctx=this.context;return!(!ctx||ctx.isContextLost()||!ctx.getProgramParameter(this.shaderProgram,ctx.LINK_STATUS))},__proto.updateFieldOfView=function(fieldOfView){this.fieldOfView=fieldOfView,this._updateViewport()},__proto.updateViewportDimensions=function(width,height){var viewPortChanged=!1;this.width=width,this.height=height;var w=width*DEVICE_PIXEL_RATIO,h=height*DEVICE_PIXEL_RATIO;w!==this.canvas.width&&(this.canvas.width=w,viewPortChanged=!0),h!==this.canvas.height&&(this.canvas.height=h,viewPortChanged=!0),viewPortChanged&&(this._updateViewport(),this._shouldForceDraw=!0)},__proto.keepUpdate=function(doUpdate){doUpdate&&!1===this.isImageLoaded()&&(this._shouldForceDraw=!0),this._keepUpdate=doUpdate},__proto.startRender=function(){this._animator.setCallback(this._render.bind(this)),this._animator.start()},__proto.stopRender=function(){this._animator.stop()},__proto.renderWithQuaternion=function(quaternion,fieldOfView){this.isImageLoaded()&&(!1===this._keepUpdate&&this._lastQuaternion&&quat_namespaceObject.exactEquals(this._lastQuaternion,quaternion)&&this.fieldOfView&&this.fieldOfView===fieldOfView&&!1===this._shouldForceDraw||(void 0!==fieldOfView&&fieldOfView!==this.fieldOfView&&this.updateFieldOfView(fieldOfView),this.mvMatrix=mat4_namespaceObject.fromQuat(mat4_namespaceObject.create(),quaternion),this._draw(),this._lastQuaternion=quat_namespaceObject.clone(quaternion),this._shouldForceDraw&&(this._shouldForceDraw=!1)))},__proto.renderWithYawPitch=function(yaw,pitch,fieldOfView){this.isImageLoaded()&&(!1===this._keepUpdate&&null!==this._lastYaw&&this._lastYaw===yaw&&null!==this._lastPitch&&this._lastPitch===pitch&&this.fieldOfView&&this.fieldOfView===fieldOfView&&!1===this._shouldForceDraw||(void 0!==fieldOfView&&fieldOfView!==this.fieldOfView&&this.updateFieldOfView(fieldOfView),mat4_namespaceObject.identity(this.mvMatrix),mat4_namespaceObject.rotateX(this.mvMatrix,this.mvMatrix,-common_namespaceObject.toRadian(pitch)),mat4_namespaceObject.rotateY(this.mvMatrix,this.mvMatrix,-common_namespaceObject.toRadian(yaw)),this._draw(),this._lastYaw=yaw,this._lastPitch=pitch,this._shouldForceDraw&&(this._shouldForceDraw=!1)))},__proto.getProjectionRenderer=function(){return this._renderer},__proto.enterVR=function(options){var vr=this._vr;return WEBXR_SUPPORTED||navigator.getVRDisplays?vr&&vr.isPresenting()?src.a.resolve("VR already enabled."):this._requestPresent(options):src.a.reject("VR is not available on this browser.")},__proto._setImageType=function(imageType){var _this=this;if(imageType&&this._imageType!==imageType){switch(this._imageType=imageType,this._isCubeMap=imageType===ImageType.CUBEMAP,this._renderer&&this._renderer.off(),imageType){case ImageType.CUBEMAP:this._renderer=new view360_esm_CubeRenderer;break;case ImageType.CUBESTRIP:this._renderer=new CubeStripRenderer;break;case ImageType.PANORAMA:this._renderer=new view360_esm_CylinderRenderer;break;case ImageType.STEREOSCOPIC_EQUI:this._renderer=new SphereRenderer(this.sphericalConfig.stereoFormat);break;default:this._renderer=new SphereRenderer(STEREO_FORMAT.NONE)}this._renderer.on(Renderer.EVENTS.ERROR,(function(e){_this.trigger(EVENTS$2.ERROR,{type:ERROR_TYPE$1.RENDERER_ERROR,message:e.message})})),this._initWebGL()}},__proto._initCanvas=function(width,height){var canvas=document.createElement("canvas");return canvas.width=width,canvas.height=height,this._onWebglcontextlost=this._onWebglcontextlost.bind(this),this._onWebglcontextrestored=this._onWebglcontextrestored.bind(this),canvas.addEventListener("webglcontextlost",this._onWebglcontextlost),canvas.addEventListener("webglcontextrestored",this._onWebglcontextrestored),canvas},__proto._setDefaultCanvasStyle=function(){var canvas=this.canvas;canvas.style.bottom="0",canvas.style.left="0",canvas.style.right="0",canvas.style.top="0",canvas.style.margin="auto",canvas.style.maxHeight="100%",canvas.style.maxWidth="100%",canvas.style.outline="none",canvas.style.position="absolute"},__proto._onContentError=function(error){return this._imageIsReady=!1,this._image=null,this.trigger(EVENTS$2.ERROR,{type:ERROR_TYPE$1.FAIL_IMAGE_LOAD,message:"failed to load image"}),!1},__proto._triggerContentLoad=function(){this.trigger(EVENTS$2.IMAGE_LOADED,{content:this._image,isVideo:this._isVideo,projectionType:this._imageType})},__proto._onContentLoad=function(e){e.errorCount>0||(this._imageIsReady=!0,this._triggerContentLoad())},__proto._initShaderProgram=function(){var gl=this.context;this.shaderProgram&&(gl.deleteProgram(this.shaderProgram),this.shaderProgram=null);var renderer=this._renderer,vsSource=renderer.getVertexShaderSource(),fsSource=renderer.getFragmentShaderSource(),vertexShader=view360_esm_WebGLUtils.createShader(gl,gl.VERTEX_SHADER,vsSource),fragmentShader=view360_esm_WebGLUtils.createShader(gl,gl.FRAGMENT_SHADER,fsSource),shaderProgram=view360_esm_WebGLUtils.createProgram(gl,vertexShader,fragmentShader);if(!shaderProgram)throw new Error("Failed to intialize shaders: "+view360_esm_WebGLUtils.getErrorNameFromWebGLErrorCode(gl.getError()));gl.useProgram(shaderProgram),shaderProgram.vertexPositionAttribute=gl.getAttribLocation(shaderProgram,"aVertexPosition"),shaderProgram.pMatrixUniform=gl.getUniformLocation(shaderProgram,"uPMatrix"),shaderProgram.mvMatrixUniform=gl.getUniformLocation(shaderProgram,"uMVMatrix"),shaderProgram.samplerUniform=gl.getUniformLocation(shaderProgram,"uSampler"),shaderProgram.textureCoordAttribute=gl.getAttribLocation(shaderProgram,"aTextureCoord"),shaderProgram.uEye=gl.getUniformLocation(shaderProgram,"uEye"),gl.enableVertexAttribArray(shaderProgram.vertexPositionAttribute),gl.enableVertexAttribArray(shaderProgram.textureCoordAttribute),gl.clear(gl.COLOR_BUFFER_BIT|gl.DEPTH_BUFFER_BIT|gl.STENCIL_BUFFER_BIT),gl.uniform1i(shaderProgram.samplerUniform,0),this.shaderProgram=shaderProgram},__proto._onWebglcontextlost=function(e){e.preventDefault(),this.trigger(EVENTS$2.RENDERING_CONTEXT_LOST)},__proto._onWebglcontextrestored=function(e){this._initWebGL(),this.trigger(EVENTS$2.RENDERING_CONTEXT_RESTORE)},__proto._updateViewport=function(){mat4_namespaceObject.perspective(this.pMatrix,common_namespaceObject.toRadian(this.fieldOfView),this.canvas.width/this.canvas.height,.1,100),this.context.viewport(0,0,this.context.drawingBufferWidth,this.context.drawingBufferHeight)},__proto._initWebGL=function(){var gl;try{this._initRenderingContext(),gl=this.context,this.updateViewportDimensions(this.width,this.height),this._initShaderProgram()}catch(e){return this.trigger(EVENTS$2.ERROR,{type:ERROR_TYPE$1.NO_WEBGL,message:"no webgl support"}),this.destroy(),void console.error(e)}gl.clearColor(0,0,0,0);var textureTarget=this._isCubeMap?gl.TEXTURE_CUBE_MAP:gl.TEXTURE_2D;this.texture&&gl.deleteTexture(this.texture),this.texture=view360_esm_WebGLUtils.createTexture(gl,textureTarget),this._imageType===ImageType.CUBESTRIP&&gl.enable(gl.CULL_FACE)},__proto._initRenderingContext=function(){if(!this.hasRenderingContext()){if(!window.WebGLRenderingContext)throw new Error("WebGLRenderingContext not available.");if(this.context=view360_esm_WebGLUtils.getWebglContext(this.canvas,this._renderingContextAttributes),!this.context)throw new Error("Failed to acquire 3D rendering context")}},__proto._initBuffers=function(){var vertexPositionData=this._renderer.getVertexPositionData(),indexData=this._renderer.getIndexData(),textureCoordData=this._renderer.getTextureCoordData(this._imageConfig),gl=this.context;this.vertexBuffer=view360_esm_WebGLUtils.initBuffer(gl,gl.ARRAY_BUFFER,new Float32Array(vertexPositionData),3,this.shaderProgram.vertexPositionAttribute),this.indexBuffer=view360_esm_WebGLUtils.initBuffer(gl,gl.ELEMENT_ARRAY_BUFFER,new Uint16Array(indexData),1),this.textureCoordBuffer=view360_esm_WebGLUtils.initBuffer(gl,gl.ARRAY_BUFFER,new Float32Array(textureCoordData),this._isCubeMap?3:2,this.shaderProgram.textureCoordAttribute),this._bindBuffers()},__proto._bindTexture=function(){if(this._imageType===ImageType.CUBESTRIP){var _a=this._renderer.getDimension(this._image),width=_a.width,height=_a.height,isEAC=width&&height&&width/height!=1.5?1:0;this.context.uniform1f(this.context.getUniformLocation(this.shaderProgram,"uIsEAC"),isEAC)}else if(this._imageType===ImageType.PANORAMA){var _b=this._renderer.getDimension(this._image),imageAspectRatio=(width=_b.width,height=_b.height,width&&height&&width/height);this._renderer.updateShaderData({imageAspectRatio:imageAspectRatio})}this._initBuffers(),this._renderer.bindTexture(this.context,this.texture,this._image,this._imageConfig),this._shouldForceDraw=!0,this.trigger(EVENTS$2.BIND_TEXTURE)},__proto._updateTexture=function(){this._renderer.updateTexture(this.context,this._image,this._imageConfig)},__proto._render=function(){var yawPitchControl=this._yawPitchControl,fov=yawPitchControl.getFov();if(yawPitchControl.shouldRenderWithQuaternion()){var quaternion=yawPitchControl.getQuaternion();this.renderWithQuaternion(quaternion,fov)}else{var yawPitch=yawPitchControl.getYawPitch();this.renderWithYawPitch(yawPitch.yaw,yawPitch.pitch,fov)}},__proto._bindBuffers=function(){var gl=this.context,program=this.shaderProgram,vertexBuffer=this.vertexBuffer,textureCoordBuffer=this.textureCoordBuffer;gl.bindBuffer(gl.ARRAY_BUFFER,vertexBuffer),gl.enableVertexAttribArray(program.vertexPositionAttribute),gl.vertexAttribPointer(program.vertexPositionAttribute,vertexBuffer.itemSize,gl.FLOAT,!1,0,0),gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER,this.indexBuffer),gl.bindBuffer(gl.ARRAY_BUFFER,textureCoordBuffer),gl.enableVertexAttribArray(program.textureCoordAttribute),gl.vertexAttribPointer(program.textureCoordAttribute,textureCoordBuffer.itemSize,gl.FLOAT,!1,0,0)},__proto._draw=function(){this._isVideo&&this._keepUpdate&&this._updateTexture(),this._renderer.render({gl:this.context,shaderProgram:this.shaderProgram,indexBuffer:this.indexBuffer,mvMatrix:this.mvMatrix,pMatrix:this.pMatrix})},__proto._requestPresent=function(options){var _this=this,gl=this.context,canvas=this.canvas,animator=this._animator;this._vr=WEBXR_SUPPORTED?new view360_esm_XRManager(options):new view360_esm_VRManager;var vr=this._vr;return animator.stop(),new src.a((function(resolve,reject){vr.requestPresent(canvas,gl).then((function(){vr.addEndCallback(_this.exitVR),animator.setContext(vr.context),animator.setCallback(_this._onFirstVRFrame),IS_IOS&&_this._setWrapperFullscreen(),_this._shouldForceDraw=!0,animator.start(),resolve("success")})).catch((function(e){vr.destroy(),_this._vr=null,animator.start(),reject(e)}))}))},__proto._setWrapperFullscreen=function(){var wrapper=this._wrapper;if(wrapper){this._wrapperOrigStyle=wrapper.getAttribute("style");var wrapperStyle=wrapper.style;wrapperStyle.width="100vw",wrapperStyle.height="100vh",wrapperStyle.position="fixed",wrapperStyle.left="0",wrapperStyle.top="0",wrapperStyle.zIndex="9999"}},__proto._restoreStyle=function(){var wrapper=this._wrapper,canvas=this.canvas;wrapper&&(this._wrapperOrigStyle?wrapper.setAttribute("style",this._wrapperOrigStyle):wrapper.removeAttribute("style"),this._wrapperOrigStyle=null,canvas.removeAttribute("style"),this._setDefaultCanvasStyle())},PanoImageRenderer.EVENTS=EVENTS$2,PanoImageRenderer.ERROR_TYPE=ERROR_TYPE$1,PanoImageRenderer}(component_esm),view360_esm_PanoViewer=function(_super){function PanoViewer(container,options){void 0===options&&(options={});var _this=_super.call(this)||this;if(!view360_esm_WebGLUtils.isWebGLAvailable())return setTimeout((function(){_this.trigger(EVENTS$1.ERROR,{type:ERROR_TYPE.NO_WEBGL,message:"no webgl support"})}),0),_this;if(!view360_esm_WebGLUtils.isStableWebGL())return setTimeout((function(){_this.trigger(EVENTS$1.ERROR,{type:ERROR_TYPE.INVALID_DEVICE,message:"blacklisted browser"})}),0),_this;if(options.image&&options.video)return setTimeout((function(){_this.trigger(EVENTS$1.ERROR,{type:ERROR_TYPE.INVALID_RESOURCE,message:"Specifying multi resouces(both image and video) is not valid."})}),0),_this;!function(){var navigator=window.navigator;navigator.xr&&(navigator.xr.isSessionSupported?navigator.xr.isSessionSupported("immersive-vr").then((function(res){WEBXR_SUPPORTED=res})).catch((function(){})):navigator.xr.supportsSession&&navigator.xr.supportsSession("immersive-vr").then((function(res){WEBXR_SUPPORTED=res})).catch((function(){})))}(),_this._container=container,_this._image=options.image||options.video,_this._isVideo=!!options.video,_this._projectionType=options.projectionType||PROJECTION_TYPE.EQUIRECTANGULAR,_this._cubemapConfig=view360_esm_assign({order:_this._projectionType===PROJECTION_TYPE.CUBEMAP?"RLUDBF":"RLUDFB",tileConfig:{flipHorizontal:!1,rotation:0}},options.cubemapConfig),_this._stereoFormat=options.stereoFormat||STEREO_FORMAT.TOP_BOTTOM,_this._width=options.width||parseInt(window.getComputedStyle(container).width,10),_this._height=options.height||parseInt(window.getComputedStyle(container).height,10),_this._yaw=options.yaw||0,_this._pitch=options.pitch||0,_this._fov=options.fov||65,_this._gyroMode=options.gyroMode||GYRO_MODE.YAWPITCH,_this._quaternion=null,_this._aspectRatio=0!==_this._height?_this._width/_this._height:1;var fovRange=options.fovRange||[30,110],touchDirection=PanoViewer._isValidTouchDirection(options.touchDirection)?options.touchDirection:view360_esm_YawPitchControl.TOUCH_DIRECTION_ALL,yawPitchConfig=view360_esm_assign(view360_esm_assign({},options),{element:container,yaw:_this._yaw,pitch:_this._pitch,fov:_this._fov,gyroMode:_this._gyroMode,fovRange:fovRange,aspectRatio:_this._aspectRatio,touchDirection:touchDirection});return _this._isReady=!1,_this._initYawPitchControl(yawPitchConfig),_this._initRenderer(_this._yaw,_this._pitch,_this._fov,_this._projectionType,_this._cubemapConfig),_this}view360_esm_extends(PanoViewer,_super);var __proto=PanoViewer.prototype;return PanoViewer.isSupported=function(){return view360_esm_WebGLUtils.isWebGLAvailable()&&view360_esm_WebGLUtils.isStableWebGL()},PanoViewer.isWebGLAvailable=function(){return view360_esm_WebGLUtils.isWebGLAvailable()},PanoViewer.isGyroSensorAvailable=function(callback){var onDeviceMotionChange;DeviceMotionEvent||!callback?src.a.race([function checkGyro(){return new src.a((function(res,rej){onDeviceMotionChange=function(deviceMotion){var isGyroSensorAvailable=!(null==deviceMotion.rotationRate.alpha);res(isGyroSensorAvailable)},window.addEventListener("devicemotion",onDeviceMotionChange)}))}(),function timeout(){return new src.a((function(res,rej){setTimeout((function(){return res(!1)}),1e3)}))}()]).then((function(isGyroSensorAvailable){window.removeEventListener("devicemotion",onDeviceMotionChange),callback&&callback(isGyroSensorAvailable),PanoViewer.isGyroSensorAvailable=function(fb){return fb&&fb(isGyroSensorAvailable),isGyroSensorAvailable}})):callback(!1)},PanoViewer._isValidTouchDirection=function(direction){return direction===PanoViewer.TOUCH_DIRECTION.NONE||direction===PanoViewer.TOUCH_DIRECTION.YAW||direction===PanoViewer.TOUCH_DIRECTION.PITCH||direction===PanoViewer.TOUCH_DIRECTION.ALL},__proto.getVideo=function(){return this._isVideo?this._photoSphereRenderer.getContent():null},__proto.setVideo=function(video,param){return void 0===param&&(param={}),video&&this.setImage(video,{projectionType:param.projectionType,isVideo:!0,cubemapConfig:param.cubemapConfig,stereoFormat:param.stereoFormat}),this},__proto.getImage=function(){return this._isVideo?null:this._photoSphereRenderer.getContent()},__proto.setImage=function(image,param){void 0===param&&(param={});var cubemapConfig=view360_esm_assign({order:"RLUDBF",tileConfig:{flipHorizontal:!1,rotation:0}},param.cubemapConfig),stereoFormat=param.stereoFormat||STEREO_FORMAT.TOP_BOTTOM,isVideo=!!param.isVideo;return this._image&&this._isVideo!==isVideo?(console.warn("PanoViewer is not currently supporting content type changes. (Image <--\x3e Video)"),this):(image&&(this._image=image,this._isVideo=isVideo,this._projectionType=param.projectionType||PROJECTION_TYPE.EQUIRECTANGULAR,this._cubemapConfig=cubemapConfig,this._stereoFormat=stereoFormat,this._deactivate(),this._initRenderer(this._yaw,this._pitch,this._fov,this._projectionType,this._cubemapConfig)),this)},__proto.keepUpdate=function(doUpdate){return this._photoSphereRenderer.keepUpdate(doUpdate),this},__proto.getProjectionType=function(){return this._projectionType},__proto.enableSensor=function(){return new src.a((function(resolve,reject){DeviceMotionEvent&&"function"==typeof DeviceMotionEvent.requestPermission?DeviceMotionEvent.requestPermission().then((function(permissionState){"granted"===permissionState?resolve():reject(new Error("permission denied"))})).catch((function(e){reject(e)})):resolve()}))},__proto.disableSensor=function(){return this},__proto.enterVR=function(options){var _this=this;return void 0===options&&(options={}),this._isReady?new src.a((function(resolve,reject){_this.enableSensor().then((function(){return _this._photoSphereRenderer.enterVR(options)})).then((function(res){return resolve(res)})).catch((function(e){return reject(e)}))})):src.a.reject(new Error("PanoViewer is not ready to show image."))},__proto.exitVR=function(){return this._photoSphereRenderer.exitVR(),this},__proto.setUseZoom=function(useZoom){return"boolean"==typeof useZoom&&this._yawPitchControl.option("useZoom",useZoom),this},__proto.setUseKeyboard=function(useKeyboard){return this._yawPitchControl.option("useKeyboard",useKeyboard),this},__proto.setGyroMode=function(gyroMode){return this._yawPitchControl.option("gyroMode",gyroMode),this},__proto.setFovRange=function(range){return this._yawPitchControl.option("fovRange",range),this},__proto.getFovRange=function(){return this._yawPitchControl.option("fovRange")},__proto.updateViewportDimensions=function(size){if(void 0===size&&(size={}),!this._isReady)return this;var containerSize;void 0!==size.width&&void 0!==size.height||(containerSize=window.getComputedStyle(this._container));var width=size.width||parseInt(containerSize.width,10),height=size.height||parseInt(containerSize.height,10);return width===this._width&&height===this._height?this:(this._width=width,this._height=height,this._aspectRatio=width/height,this._photoSphereRenderer.updateViewportDimensions(width,height),this._yawPitchControl.option("aspectRatio",this._aspectRatio),this._yawPitchControl.updatePanScale({height:height}),this.lookAt({},0),this)},__proto.getFov=function(){return this._fov},__proto.getYaw=function(){return this._yaw},__proto.getPitch=function(){return this._pitch},__proto.getYawRange=function(){return this._yawPitchControl.option("yawRange")},__proto.getPitchRange=function(){return this._yawPitchControl.option("pitchRange")},__proto.setYawRange=function(yawRange){return this._yawPitchControl.option("yawRange",yawRange),this},__proto.setPitchRange=function(pitchRange){return this._yawPitchControl.option("pitchRange",pitchRange),this},__proto.setShowPolePoint=function(showPolePoint){return this._yawPitchControl.option("showPolePoint",showPolePoint),this},__proto.lookAt=function(orientation,duration){if(void 0===duration&&(duration=0),!this._isReady)return this;var yaw=void 0!==orientation.yaw?orientation.yaw:this._yaw,pitch=void 0!==orientation.pitch?orientation.pitch:this._pitch,pitchRange=this._yawPitchControl.option("pitchRange"),verticalAngleOfImage=pitchRange[1]-pitchRange[0],fov=void 0!==orientation.fov?orientation.fov:this._fov;return verticalAngleOfImage<fov&&(fov=verticalAngleOfImage),this._yawPitchControl.lookAt({yaw:yaw,pitch:pitch,fov:fov},duration),0===duration&&this._photoSphereRenderer.renderWithYawPitch(yaw,pitch,fov),this},__proto.setTouchDirection=function(direction){return PanoViewer._isValidTouchDirection(direction)&&this._yawPitchControl.option("touchDirection",direction),this},__proto.getTouchDirection=function(){return this._yawPitchControl.option("touchDirection")},__proto.destroy=function(){return this._deactivate(),this._yawPitchControl&&(this._yawPitchControl.destroy(),this._yawPitchControl=null),this},__proto._initRenderer=function(yaw,pitch,fov,projectionType,cubemapConfig){var _this=this;this._photoSphereRenderer=new view360_esm_PanoImageRenderer(this._image,this._width,this._height,this._isVideo,{initialYaw:yaw,initialPitch:pitch,fieldOfView:fov,imageType:projectionType,cubemapConfig:cubemapConfig,stereoFormat:this._stereoFormat}),this._photoSphereRenderer.setYawPitchControl(this._yawPitchControl),this._bindRendererHandler(),this._photoSphereRenderer.bindTexture().then((function(){return _this._activate()})).catch((function(){_this.trigger(EVENTS$1.ERROR,{type:ERROR_TYPE.FAIL_BIND_TEXTURE,message:"failed to bind texture"})}))},__proto._updateYawPitchIfNeeded=function(){if(this._projectionType===PanoViewer.ProjectionType.PANORAMA){var image=this._photoSphereRenderer.getContent(),imageAspectRatio=image.naturalWidth/image.naturalHeight,yawSize=void 0,maxFov=void 0;imageAspectRatio<1&&(imageAspectRatio=1/imageAspectRatio),imageAspectRatio<6?(yawSize=util.toDegree(imageAspectRatio),maxFov=2*util.toDegree(Math.atan(.5))):(yawSize=360,maxFov=360/imageAspectRatio);var minFov=this._yawPitchControl.option("fovRange")[0];this._yawPitchControl.option({fov:maxFov,yawRange:[-yawSize/2,yawSize/2],pitchRange:[-maxFov/2,maxFov/2],fovRange:[minFov,maxFov]}),this.lookAt({fov:maxFov})}},__proto._bindRendererHandler=function(){var _this=this;this._photoSphereRenderer.on(view360_esm_PanoImageRenderer.EVENTS.ERROR,(function(e){_this.trigger(EVENTS$1.ERROR,e)})),this._photoSphereRenderer.on(view360_esm_PanoImageRenderer.EVENTS.RENDERING_CONTEXT_LOST,(function(e){_this._deactivate(),_this.trigger(EVENTS$1.ERROR,{type:ERROR_TYPE.RENDERING_CONTEXT_LOST,message:"webgl rendering context lost"})}))},__proto._initYawPitchControl=function(yawPitchConfig){var _this=this;this._yawPitchControl=new view360_esm_YawPitchControl(yawPitchConfig),this._yawPitchControl.on(EVENTS$1.ANIMATION_END,(function(e){_this.trigger(EVENTS$1.ANIMATION_END,e)})),this._yawPitchControl.on("change",(function(e){_this._yaw=e.yaw,_this._pitch=e.pitch,_this._fov=e.fov,_this._quaternion=e.quaternion,_this.trigger(EVENTS$1.VIEW_CHANGE,e)}))},__proto._activate=function(){this._photoSphereRenderer.attachTo(this._container),this._yawPitchControl.enable(),this.updateViewportDimensions(),this._isReady=!0,this._updateYawPitchIfNeeded(),this.trigger(EVENTS$1.READY),this._photoSphereRenderer.startRender()},__proto._deactivate=function(){this._isReady&&(this._photoSphereRenderer.stopRender(),this._yawPitchControl.disable(),this._isReady=!1),this._photoSphereRenderer&&(this._photoSphereRenderer.destroy(),this._photoSphereRenderer=null)},PanoViewer.VERSION="3.4.3",PanoViewer.ERROR_TYPE=ERROR_TYPE,PanoViewer.EVENTS=EVENTS$1,PanoViewer.PROJECTION_TYPE=PROJECTION_TYPE,PanoViewer.GYRO_MODE=GYRO_MODE,PanoViewer.ProjectionType=PROJECTION_TYPE,PanoViewer.STEREO_FORMAT=STEREO_FORMAT,PanoViewer.TOUCH_DIRECTION={NONE:view360_esm_YawPitchControl.TOUCH_DIRECTION_NONE,YAW:view360_esm_YawPitchControl.TOUCH_DIRECTION_YAW,PITCH:view360_esm_YawPitchControl.TOUCH_DIRECTION_PITCH,ALL:view360_esm_YawPitchControl.TOUCH_DIRECTION_ALL},PanoViewer}(component_esm)}}]);
//# sourceMappingURL=5.9423782e4e21ad20fa41.bundle.js.map